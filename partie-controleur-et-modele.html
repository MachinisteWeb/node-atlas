<!DOCTYPE html><html lang="fr-fr"><head>
		<meta charset="utf-8">
		<title>NodeAtlas &#x2014;Le Framework JavaScript Serveur &#xC9;volutif&#x2014;</title>

		<base href="">

		<meta name="geo.placename" content="Annecy, Haute-Savoie, France">
		<meta name="description" content="Cr&#xE9;ez simplement des sites web &#xE9;volutifs en Node.js.">

		<meta name="og:title" content="NodeAtlas &#x2014;Le Framework JavaScript Serveur &#xC9;volutif&#x2014;">
		<meta name="og:description" content="Cr&#xE9;ez simplement des sites web &#xE9;volutifs en Node.js.">
		<meta name="og:url" content="https://node-atlas.js.org">
		<meta name="og:image" content="https://node-atlas.js.org/media/images/min/logo-big.png">
		<meta name="og:locale" content="fr-fr">
		<meta name="og:type" content="website">
		<meta name="og:updated_time" content="1502537093356">

		<meta name="robots" content="index, follow">

		<!--[if IE]><meta name="viewport" content="width=device-width, user-scalable=no" /><![endif]-->
		<!--[if !IE]><!--><meta name="viewport" content="initial-scale=1.0, user-scalable=no"><!--<![endif]-->

		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/default.min.css">

		<!-- Inclusion du fichiers minifié après génération. -->
		
		<link rel="stylesheet" href="stylesheets/common.min.css">

		<!-- Inclusion du fichiers standar pendant le développement. -->
		
	</head>
	<body data-content="content/" data-subpath="" style="background-image: url(&apos;media/images/min/main-background.jpg&apos;);">
		<div class="layout">
			<noscript class="no-js cmpt">
				<div class="no-js--inner">
					<p>Le JavaScript n'est pas activé.</p>
				</div>
			</noscript>
			<div class="background"></div>
			<div class="language cmpt">
				<div class="navigation--lang">
					<a href="/english/index.html" title="International Version"><span class="fa fa-globe"></span>  International Version</a>
				</div>
			</div>
			<header class="header cmpt">
				<div class="header--inner">
					<div class="header--information">
						<div class="header--information--github">
							<a class="header--information--donate" href="https://www.paypal.me/BrunoLesieur/5"><img src="https://img.shields.io/badge/don-%E2%9D%A4-ddddff.svg" alt="Faites un don" data-canonical-src="https://img.shields.io/badge/don-%E2%9D%A4-ddddff.svg"></a>
							<a class="header--information--follow github-button" href="https://github.com/Haeresis" data-count-href="/Haeresis/followers" data-count-api="/users/Haeresis#followers" data-count-aria-label="# followers on GitHub" aria-label="Suivre @Haeresis on GitHub">Suivre</a>
						</div>
						<div class="header--information--npm">
							<a class="header--information--package" href="https://www.npmjs.com/package/node-atlas"><img src="https://badge.fury.io/js/node-atlas.svg" alt="Package NPM" data-canonical-src="https://badge.fury.io/js/node-atlas.svg"></a>
							<a class="header--information--star github-button" href="https://github.com/NodeAtlas/node-atlas" data-icon="octicon-star" data-count-href="/NodeAtlas/node-atlas/stargazers" data-count-api="/repos/NodeAtlas/node-atlas#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star NodeAtlas/node-atlas on GitHub">Star</a>
						</div>
					</div>
					<div class="header--background"></div>
					<div class="header--title">
						<h1>
							<img class="header--title--node" src="media/images/min/ode.png" alt="Node">
							<img class="header--title--atlas" src="media/images/min/tlas.png" alt="Atlas">
							<img class="header--title--trans" src="media/images/min/transparent.png" alt="NodeAtlas">
						</h1>
					</div>
					<div class="header--abstract">
						<p>Le Framework JavaScript Serveur &#xC9;volutif</p>
					</div>
					<div class="header--main">
						<ul>
							<li>
								<div class="header--main--first">
									<h2><span>Mise en place</span> <strong>Simple</strong></h2>
									<p>Au point avec <strong>HTML &amp; CSS</strong> ?<br><strong>D&#xE9;butant</strong> en JavaScript ?</p>
									<p class="small">R&#xE9;alisez rapidement des sites vitrines multilingues sans effort avec l&apos;utilisation de routes, vues ou variations.</p>
								</div>
							</li>
							<li>
								<div class="header--main--second">
									<h2><span>Site vivant et</span> <strong>&#xC9;volutif</strong></h2>
									<p><strong>Expert</strong> en JavaScript client ?<br>Pr&#xEA;t &#xE0; embrasser <strong>Node.js</strong> ?</p>
									<p class="small">Am&#xE9;liorer progressivement votre base &#xE0; mesure de vos besoins en utilisant des contr&#xF4;leurs, mod&#xE8;les ou modules.</p>
								</div>
							</li>
							<li>
								<div class="header--main--third">
									<h2><span>Partie Cliente</span> <strong>Agnostique</strong></h2>
									<p>D&#xE9;j&#xE0; vos habitudes <strong>Front-end</strong> ?<br>Habitu&#xE9;(e) du <strong>Data Binding</strong> ?</p>
									<p class="small">Du l&#xE9;ger Vanilla au simple jQuery en passant par Vue, Angular ou React : utiliser vos biblioth&#xE8;ques clientes favorites !</p>
								</div>
							</li>
						</ul>
					</div>
				</div>
			</header>
<div class="popup cmpt">
	<aside class="popup--inner">
		<div class="popup--versus"><del class="close">Fermer</del><span class="fa fa-bolt" aria-hidden="true"></span><ins class="versus">Versus</ins></div>
		<div class="popup--nodeatlas"></div>
		<div class="popup--challenger"></div>
	</aside>
</div>
			<aside class="download cmpt">
				<div class="download--inner">
					<div class="download--install">
						<div class="download--cli is-active">
							<h2>Utilisation CLI</h2>
							<div class="download--cli--inner">
								<div class="download--cli--step1">
									<h3>Installer NodeAtlas</h3>
									<pre>$ npm install -g node-atlas</pre>
								</div>
								<div class="download--cli--step2">
									<h3>Cr&#xE9;er un site test</h3>
									<pre>$ node-atlas --create</pre>
								</div>
								<div class="download--cli--step3">
									<h3>Lancer le site</h3>
									<pre>$ node-atlas --browse</pre>
								</div>
							</div>
						</div>
						<div class="download--api">
							<h2>Utilisation API</h2>
							<div class="download--api--inner">
								<div class="download--api--step1">
									<h3>Installer NodeAtlas</h3>
									<pre>$ npm install node-atlas</pre>
								</div>
								<div class="download--api--step2">
									<h3>Cr&#xE9;er un script</h3>
									<pre><span>server.js</span>var NA = require(&quot;node-atlas&quot;),
    website = NA();
website.init({
    &quot;create&quot;: &quot;hello-world&quot;
}).created(function () {
    website.run({
        &quot;browse&quot;: true
    });
}).start();</pre>
								</div>
								<div class="download--api--step3">
									<h3>Lancer le site</h3>
									<pre>$ node server.js</pre>
								</div>
							</div>
						</div>
					</div>
					<div class="download--clone">
						<div class="download--version">
							<h2>T&#xE9;l&#xE9;charger</h2>
							<div class="download--version--inner">
								<div class="download--version--step1">
									<h3>v2.0.0-beta48</h3>
									<p class="download--clone--last"><a class="button" href="https://github.com/NodeAtlas/node-atlas/archive/master.zip" target="_blank">Derni&#xE8;re version</a></p>
									<p class="aside"><a href="https://github.com/NodeAtlas/node-atlas/releases">Versions stables</a></p>
								</div>
								<div class="download--version--step2">
									<h3>Cloner</h3>
									<p><input type="text" name="clone" data-instruction="Copier dans le presse-papier: Ctrl+C, Entrer" class="download--clone--text" value="https://github.com/NodeAtlas/node-atlas.git"><button><span class="fa fa-clipboard" aria-hidden="true"></span></button></p>
								</div>
							</div>
						</div>
					</div>
					<div class="download--battle">
						<div class="download--slide">
							<h2>Batailles Versus</h2>
							<div class="download--slide--inner">
								<div class="download--slide--step1">
									<img src="media/images/battles/node-atlas.png" alt="NodeAtlas API">
								</div>
								<div class="download--slide--step2">
									VS
								</div>
								<div class="download--slide--step3">
									<img src="media/images/battles/expressjs.png" alt="Concurrent">
								</div>
								<div class="download--slide--step4">
									<span class="fa fa-refresh" aria-hidden="true">
								</span></div>
							</div>
						</div>
					</div>
					<div class="download--info">
						<div class="download--tuto is-active">
							<h2>Tutoriaux</h2>
							<div class="download--tuto--inner">
								<div class="download--tuto--step1">
									<a href="avant-propos.html#avant-propos"><span>D&#xE9;couvrir</span> <i class="fa fa-book" aria-hidden="true"></i> le guide complet pas &#xE0; pas</a>
								</div>
								<div class="download--tuto--step2">
									<span>ou</span>
								</div>
								<div class="download--tuto--step3">
									<div class="download--tuto--step3--first">
										<a href="https://blog.lesieur.name/des-sites-web-nodejs-pour-les-debutants-en-javascript-avec-nodeatlas/"><span>Cr&#xE9;er</span> <i class="fa fa-html5" aria-hidden="true"></i> des sites web multilingues</a>
									</div>
									<div class="download--tuto--step3--second">
										<a href="https://blog.lesieur.name/creer-et-maintenir-des-maquettes-html-avec-node-atlas/"><span>Maintenir</span> <i class="fa fa-copy" aria-hidden="true"></i> des maquettes HTML sans serveur</a>
									</div>
									<div class="download--tuto--step3--third">
										<a href="https://github.com/NodeAtlas"><span>D&#xE9;velopper</span> <i class="fa fa-database" aria-hidden="true"></i> des applications web temps r&#xE9;el</a>
									</div>
								</div>
							</div>
						</div>
						<div class="download--about">
							<h2>&#xC0; propos</h2>
							<div class="download--about--inner">
								<div class="download--about--step1">
									NodeAtlas est un Framework JavaScript MVC(2) c&#xF4;t&#xE9; serveur vous permettant de cr&#xE9;er des sites &#xE9;volutifs, SEO-compliant et W3C-compliant. C&apos;est-&#xE0;-dire qu&apos;il permet de faire tourner des pages multilingues indexables ou de cr&#xE9;er des maquettes HTML et passant la validation W3C uniquement avec des vues avec modifications &#xE0; chaud mais &#xE9;galement de cr&#xE9;er de gros sites orient&#xE9;s composants et/ou orient&#xE9;s services en respectant les nouveaux standards !
								</div>
							</div>
						</div>
					</div>
				</div>
			</aside>
			<nav class="navigation cmpt">
				<div class="navigation--outer">
					<div class="navigation--start"><button class="button">Commencer</button></div>
					<div class="navigation--documentation"><button class="button">Documentation</button></div>
				</div>
				<div class="navigation--inner">
					<div class="navigation--lang">
						<a href="/english/index.html" title="International Version"><span class="fa fa-globe"></span>  International Version</a>
					</div>
					<div class="navigation--home">
						<img class="navigation--home--logo" src="media/images/logo.png" alt="Guide &lt;span&gt;NodeAtlas&lt;/span&gt;" width="80px"> <a class="navigation--home--back" href="index.html" title="Guide &lt;span&gt;NodeAtlas&lt;/span&gt;">Guide <span>NodeAtlas</span></a>
					</div>
					<div class="navigation--menu">
						<div class="navigation--menu--toggle">
							<span class="top"></span>
							<span class="middle"></span>
							<span class="bottom"></span>
						</div>
						<div class="navigation--menu--list">
							<div class="navigation--menu--list--inner">
								<h2>Menu</h2>
								<ul>
									
									<li>
										<a href="avant-propos.html" title="Pr&#xE9;sentation">Pr&#xE9;sentation</a> 
										
										<i class="fa fa-chevron-down" aria-hidden="true"></i>
										<ul>
											
											<li>
												<a href="installation.html" title="Installation">Installation</a>
											</li>
											
											<li>
												<a href="commencer-avec-nodeatlas.html" title="D&#xE9;marrage rapide">D&#xE9;marrage rapide</a>
											</li>
											
										</ul>
										
									</li>
									
									<li>
										<a href="partie-vue-et-template.html" title="Vue et Template">Vue et Template</a> 
										
									</li>
									
									<li>
										<a href="partie-controleur-et-modele.html" title="Contr&#xF4;leur et Mod&#xE8;le">Contr&#xF4;leur et Mod&#xE8;le</a> 
										
									</li>
									
									<li>
										<a href="pour-aller-plus-loin.html" title="Route et Plus">Route et Plus</a> 
										
										<i class="fa fa-chevron-down" aria-hidden="true"></i>
										<ul>
											
											<li>
												<a href="anatomie-du-webconfig.html" title="Webconfig">Webconfig</a>
											</li>
											
											<li>
												<a href="api-nodeatlas-comme-module-npm.html" title="API">API</a>
											</li>
											
											<li>
												<a href="cli-commandes-de-lancement.html" title="CLI">CLI</a>
											</li>
											
											<li>
												<a href="nodeatlas-comme-simple-serveur-web.html" title="Simple Serveur">Simple Serveur</a>
											</li>
											
											<li>
												<a href="environnement-de-developpement.html" title="D&#xE9;veloppement">D&#xE9;veloppement</a>
											</li>
											
											<li>
												<a href="environnement-de-production.html" title="Production">Production</a>
											</li>
											
										</ul>
										
									</li>
									
									<li>
										<a href="plus-sur-nodeatlas.html" title="Et les autres ?">Et les autres ?</a> 
										
									</li>
									
								</ul>
							</div>
						</div>
					</div>
				</div>
			</nav>
			<div class="content cmpt">
				<div class="content--outer" data-name="Menu"></div>
				<div class="content--inner">
					<h2 id="partie-controleur-et-modele">Partie Contr&#xF4;leur et mod&#xE8;le</h2><p>NodeAtlas ne se contente pas uniquement de faciliter la g&#xE9;n&#xE9;ration de page web en fonction de variable dans les fichiers de variation. NodeAtlas vous permet &#xE9;galement d&apos;int&#xE9;ragir avec le contenu des fichiers variations ou avec le DOM g&#xE9;n&#xE9;r&#xE9; en fonction ;</p><ul>
<li>des param&#xE8;tres dans la partie query de l&apos;URL (GET),</li>
<li>des param&#xE8;tres dans le body de la requ&#xEA;te (POST)</li>
</ul><p>mais &#xE9;galement ;</p><ul>
<li>de vous connecter &#xE0; des bases de donn&#xE9;es,</li>
<li>de maintenir des sessions,</li>
<li>de faire des &#xE9;changes websockets et</li>
<li>de faire bien plus encore !</li>
</ul><h3 id="cycle-de-vie-et-points-d-ancrage">Cycle de vie et Points d&apos;ancrage</h3><p>Le cycle de vie de NodeAtlas est le suivant. D&apos;abord, les ressources se chargent, le serveur d&#xE9;marre, les routes s&apos;initialisent et tout est op&#xE9;rationnel. Puis, &#xE0; chaque requ&#xEA;te HTTP entrante, une r&#xE9;ponse est g&#xE9;n&#xE9;r&#xE9;e. Vous pouvez intervenir gr&#xE2;ce &#xE0; diff&#xE9;rents points d&apos;ancrage pendant le d&#xE9;marrage, et pendant la cr&#xE9;ation d&apos;une page.</p><p>Voici &#xE0; quoi peut ressembler un <code>webconfig.json</code> permettant d&apos;atteindre tous les points d&apos;ancrage du cycle de vie d&apos;une page.</p><pre><code class="lang-json">{
    &quot;controllersRelativePath&quot;: &quot;controllers&quot;,
    &quot;controller&quot;: &quot;common.js&quot;,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;,
            &quot;controller&quot;: &quot;index.json&quot;
        }
    }
}
</code></pre><p><em>Note : Si</em> <code>controllersRelativePath</code> <em>n&apos;est pas pr&#xE9;sent dans &#xAB; webconfig.json &#xBB;, par d&#xE9;faut le dossier des contr&#xF4;leurs est bien</em> <code>controllers</code>. <code>controllersRelativePath</code> <em>est donc utile seulement pour changer le nom/chemin du r&#xE9;pertoire.</em></p><p>et voici le d&#xE9;tail des endroits ou vous pouvez intervenir pendant :</p><p><em>Le lancement du serveur</em></p><pre><code>&#x250C;&#x2500;[Chargement des modules Node.js]
&#x250A;
&#x251C;&#x2500;[Chargement des variables d&apos;initialisation]
&#x250A;
&#x251C;&#x2500;[Chargement des modules npm]
&#x250A;
&#x251C;&#x2500;[Prise en compte des commandes et de la langue du CLI]
&#x250A;
&#x251C;&#x2500;[Prise en compte des options de l&apos;API]
&#x250A;
&#x2514;&#x2500;[Chargement de la langue du CLI]
  &#x250A;
  &#x251C;&#x2500;[Chargement des variables globales]
  &#x250A;
  &#x251C;&#x2500;[Prise en compte des instructions du webconfig]
  &#x250A;
  &#x2514;&#x2500;[Chargement du contr&#xF4;leur commun]
    &#x250A;  _________________________________________
    &#x251C;&#x2500;{Point d&apos;ancrage : &lt;controller&gt;.setModules}
    &#x250A;  &#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;
    &#x251C;&#x2500;[Initialisation du serveur]
    &#x250A;  __________________________________________
    &#x251C;&#x2500;{Point d&apos;ancrage : &lt;controller&gt;.setSessions}
    &#x250A;  &#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;
    &#x251C;&#x2500;[Initialisation des sessions]
    &#x250A;
    &#x251C;&#x2500;[Initialisation des sockets]
    &#x250A; &#x250A;  _________________________________________
    &#x250A; &#x251C;&#x2500;{Point d&apos;ancrage : &lt;controller&gt;.setSockets}_______
    &#x250A; &#x2514;&#x2500;{Point d&apos;ancrage : routes[&lt;controller&gt;].setSockets}
    &#x250A;    &#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;
    &#x250A;  ________________________________________________
    &#x251C;&#x2500;{Point d&apos;ancrage : &lt;controller&gt;.setConfigurations}
    &#x250A;  &#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;
    &#x2514;&#x2500;[D&#xE9;marrage du serveur]
      &#x250A;
      &#x251C;&#x2500;[Initialisation du moteur de template]
      &#x250A;  ________________________________________
      &#x251C;&#x2500;{Point d&apos;ancrage : &lt;controller&gt;.setRoutes}
      &#x250A;  &#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;
      &#x2514;&#x2500;[Initialisation des routes]
        &#x250A;
        &#x221E;
</code></pre><p><em>Le traitement des requ&#xEA;tes de chaque route</em></p><pre><code>&#x221E;
&#x250A;
&#x2514;&#x2500;[Traitement d&apos;une requ&#xEA;te]
  &#x250A;
  &#x2514;&#x2500;[Chargement du contr&#xF4;leur sp&#xE9;cifique]
    &#x250A;  _______________________________________________
    &#x251C;&#x2500;{Point d&apos;ancrage : &lt;controller&gt;.changeVariations}_______
    &#x251C;&#x2500;{Point d&apos;ancrage : routes[&lt;controller&gt;].changeVariations}
    &#x250A;  &#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;
    &#x2514;&#x2500;[Compilation du moteur de template]
      &#x250A;  ________________________________________
      &#x251C;&#x2500;{Point d&apos;ancrage : &lt;controller&gt;.changeDom}_______
      &#x251C;&#x2500;{Point d&apos;ancrage : routes[&lt;controller&gt;].changeDom}
      &#x250A;  &#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;&#x203E;
      &#x2514;&#x2500;[Envoi de la r&#xE9;ponse]
        &#x250A;
        &#x221E;
</code></pre><h4 id="changevariations">changeVariations</h4><p>Pour intercepter les variations, vous pouvez soit utiliser le contr&#xF4;leur commun pour tout le site et/ou &#xE9;galement le contr&#xF4;leur par page.</p><p><code>changeVariations(next, locals, request, response)</code> est une fonction a <code>exports</code> et fournissant :</p><ul>
<li>L&apos;objet <code>NA</code> en tant que <code>this</code>.</li>
<li>En premier param&#xE8;tre la fonction de retour <code>next()</code>.</li>
<li>En deuxi&#xE8;me param&#xE8;tre l&apos;objet <code>locals</code> contenant entre autre la variation <code>locals.common</code> pour acc&#xE9;der aux variations communes et la variation <code>locals.specific</code> pour acc&#xE9;der aux variations sp&#xE9;cifiques.</li>
<li>En troisi&#xE8;me param&#xE8;tre l&apos;objet <code>request</code> qui va &#xEA;tre faites.</li>
<li>En quatri&#xE8;me param&#xE8;tre l&apos;objet <code>response</code> faites pour cette page.</li>
</ul><p>Voici un exemple utilisant les deux points d&apos;entr&#xE9;e, d&apos;abord la commune &#xE0; plusieurs pages, puis celle de chaque page :</p><pre><code class="lang-json">{
    &quot;urlRelativeSubPath&quot;: &quot;example&quot;,
    &quot;controller&quot;: &quot;common.js&quot;,
    &quot;variation&quot;: &quot;common.json&quot;,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;,
            &quot;variation&quot;: &quot;index.json&quot;,
            &quot;controller&quot;: &quot;index.js&quot;
        }
    }
}
</code></pre><p>avec cet ensemble de fichier :</p><pre><code>&#x251C;&#x2500; variations/
&#x2502;  &#x251C;&#x2500; common.json
&#x2502;  &#x2514;&#x2500; index.json
&#x251C;&#x2500; controllers/
&#x2502;  &#x251C;&#x2500; common.js
&#x2502;  &#x2514;&#x2500; index.js
&#x251C;&#x2500; views/
&#x2502;  &#x251C;&#x2500; partials/
&#x2502;  &#x2502;  &#x251C;&#x2500; head.htm
&#x2502;  &#x2502;  &#x2514;&#x2500; foot.htm
&#x2502;  &#x2514;&#x2500; index.htm
&#x2514;&#x2500; webconfig.json
</code></pre><p>En demandant la page <code>http://localhost/example/?title=Haeresis</code> en POST avec une variable <code>example=Ceci+est+un+test</code> dans le corps de requ&#xEA;te, les fichiers suivants (entre autre) seront utilis&#xE9;s :</p><p><em>variations/common.json</em></p><pre><code class="lang-json">{
    &quot;titleWebsite&quot;: &quot;Titre du site&quot;
}
</code></pre><p><em>variations/index.json</em></p><pre><code class="lang-json">{
    &quot;titlePage&quot;: &quot;Bienvenue&quot;,
    &quot;content&quot;: &quot;&lt;p&gt;C&apos;est la page d&apos;accueil.&lt;/p&gt;&quot;
}
</code></pre><p><em>views/index.htm</em></p><pre><code class="lang-html">    &lt;?- include(&quot;partials/head.htm&quot;) ?&gt;

    &lt;div class=&quot;title&quot;&gt;&lt;?- common.titleWebsite ?&gt;&lt;/div&gt;

    &lt;div&gt;
        &lt;h1&gt;&lt;?- specific.titlePage ?&gt;&lt;/h1&gt;
        &lt;?- specific.content ?&gt;
    &lt;/div&gt;

    &lt;?- include(&quot;partials/foot.htm&quot;) ?&gt;
</code></pre><p><em>controllers/common.js</em></p><pre><code class="lang-js">// On intervient avant que les variables soient inject&#xE9;es dans le syst&#xE8;me de template.
// Ce code sera ex&#xE9;cut&#xE9; pour toute request HTTP, toute page confondue.
exports.changeVariations = function (next, locals, request, response) {

    // Ici on modifie les variables de locals.

    console.log(locals.common.titleWebsite); // &quot;Titre du site&quot;
    console.log(locals.specific.titlePage); // &quot;Bienvenue&quot;
    console.log(locals.specific.content); // &quot;C&apos;est la page d&apos;accueil.&quot;

    console.log(&quot;urlRootPath&quot;, locals.urlRootPath); // &quot;http://localhost&quot;
    console.log(&quot;urlSubPath&quot;, locals.urlSubPath); // &quot;/example&quot;
    console.log(&quot;urlBasePath&quot;, locals.urlBasePath); // &quot;http://localhost/example&quot;
    console.log(&quot;urlFilePath&quot;, locals.urlFilePath); // &quot;/&quot;
    console.log(&quot;urlQueryPath&quot;, locals.urlQueryPath); // &quot;?title=Haeresis&quot;
    console.log(&quot;urlPath&quot;, locals.urlPath); // &quot;http://localhost/example/?title=Haeresis&quot;

    if (request.query[&quot;title&quot;]) {
        locals.specific.titlePage = locals.specific.titlePage + &quot; &quot; + request.query.title;
    }
    if (request.body[&quot;example&quot;]) {
        locals.specific.content = request.body.example;
    }

    console.log(locals.common.titleWebsite); // &quot;Titre du site&quot;
    console.log(locals.specific.titlePage); // &quot;Bienvenue Haeresis&quot;
    console.log(locals.specific.content); // &quot;Ceci est un test&quot;

    // On passe &#xE0; la suite modifications.
    next();
};
</code></pre><p><em>controllers/index.js</em></p><pre><code class="lang-js">// On intervient avant que les variables soient inject&#xE9;es dans le syst&#xE8;me de template.
// Ce code sera ex&#xE9;cut&#xE9; uniquement lors de la demande de la page &#xAB; / &#xBB;.
exports.changeVariations = function (next, locals, request, response) {

    // Ici on modifie les variables de locals.

    console.log(locals.common.titleWebsite); // &quot;Titre du site&quot;
    console.log(locals.specific.titlePage); // &quot;Bienvenue Haeresis&quot;
    console.log(locals.specific.content); // &quot;Ceci est un test&quot;

    locals.common.titleWebsite = &quot;C&apos;est l&apos;accueil, c&apos;est tout.&quot;;
    locals.specific.content = &quot;C&apos;est l&apos;accueil, c&apos;est tout.&quot;;

    console.log(locals.common.titleWebsite); // &quot;C&apos;est l&apos;accueil, c&apos;est tout.&quot;
    console.log(locals.specific.titlePage); // &quot;Bienvenue Haeresis&quot;
    console.log(locals.specific.content); // &quot;C&apos;est l&apos;accueil, c&apos;est tout.&quot;

    // On passe &#xE0; la suite.
    next();
};
</code></pre><p>ce qui produit la sortie suivante :</p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot; /&gt;
        &lt;title&gt;C&apos;est l&apos;accueil, c&apos;est tout.&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div class=&quot;title&quot;&gt;C&apos;est l&apos;accueil, c&apos;est tout.&lt;/div&gt;
        &lt;div&gt;
            &lt;h1&gt;Bienvenue Haeresis&lt;/h1&gt;
            C&apos;est l&apos;accueil, c&apos;est tout.
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p>Si vous d&#xE9;cidez de d&#xE9;sabonner la variation sp&#xE9;cifique avec le webconfig suivant :</p><pre><code class="lang-json">{
    &quot;controller&quot;: &quot;common.js&quot;,
    &quot;variation&quot;: &quot;common.json&quot;,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;,
            &quot;variation&quot;: &quot;index.json&quot;
        }
    }
}
</code></pre><p>alors la sortie sera :</p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot; /&gt;
        &lt;title&gt;Titre du site&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div class=&quot;title&quot;&gt;Titre du site&lt;/div&gt;
        &lt;div&gt;
            &lt;h1&gt;Bienvenue Haeresis&lt;/h1&gt;
            Ceci est un test
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><h4 id="changedom">changeDom</h4><p>Pour intercepter le DOM avant qu&apos;il ne soit renvoy&#xE9;, vous pouvez soit utiliser le contr&#xF4;leur commun pour tout le site et/ou &#xE9;galement le contr&#xF4;leur par page.</p><p><code>changeDom(next, locals, request, response)</code> est une fonction a <code>exports</code> et fournissant :</p><ul>
<li>L&apos;objet <code>NA</code> en tant que <code>this</code>.</li>
<li>En premier param&#xE8;tre la fonction de retour <code>next([$])</code> acceptant optionellement en premier param&#xE8;tre la function <code>$</code> utilis&#xE9;e pour manipuler le DOM Virtuel.</li>
<li>En deuxi&#xE8;me param&#xE8;tre l&apos;objet <code>locals</code> contenant entre autre la string <code>locals.dom</code> contenant la r&#xE9;ponse ou la function <code>locals.virtualDom()</code> g&#xE9;n&#xE9;rant un Dom Virtuel.</li>
<li>En troisi&#xE8;me param&#xE8;tre l&apos;objet <code>request</code> qui va &#xEA;tre faites.</li>
<li>En quatri&#xE8;me param&#xE8;tre l&apos;objet <code>response</code> faites pour cette page.</li>
</ul><p>Voici un exemple utilisant les deux points d&apos;entr&#xE9;e, d&apos;abord la commune &#xE0; plusieurs pages, puis celle de chaque page :</p><pre><code class="lang-json">{
    &quot;controller&quot;: &quot;common.js&quot;,
    &quot;variation&quot;: &quot;common.json&quot;,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;,
            &quot;variation&quot;: &quot;index.json&quot;,
            &quot;controller&quot;: &quot;index.js&quot;
        }
    }
}
</code></pre><p>avec cet ensemble de fichier :</p><pre><code>&#x251C;&#x2500; variations/
&#x2502;  &#x251C;&#x2500; common.json
&#x2502;  &#x2514;&#x2500; index.json
&#x251C;&#x2500; controllers/
&#x2502;  &#x251C;&#x2500; common.js
&#x2502;  &#x2514;&#x2500; index.js
&#x251C;&#x2500; views/
&#x2502;  &#x2514;&#x2500; index.htm
&#x2514;&#x2500; webconfig.json
</code></pre><p>En demandant la page <code>http://localhost/</code> les fichiers suivants (entre autre) seront utilis&#xE9;s :</p><p><em>variations/common.json</em></p><pre><code class="lang-json">{
    &quot;titleWebsite&quot;: &quot;Titre du site&quot;
}
</code></pre><p><em>variations/index.json</em></p><pre><code class="lang-json">{
    &quot;titlePage&quot;: &quot;Bienvenue&quot;,
    &quot;content&quot;: &quot;&lt;p&gt;C&apos;est la page d&apos;accueil.&lt;/p&gt;&quot;
}
</code></pre><p><em>views/index.htm</em></p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot; /&gt;
        &lt;title&gt;&lt;?- common.titleWebsite ?&gt;&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div class=&quot;title&quot;&gt;&lt;?- common.titleWebsite ?&gt;&lt;/div&gt;
        &lt;div&gt;
            &lt;h1&gt;&lt;?- specific.titlePage ?&gt;&lt;/h1&gt;
            &lt;?- specific.content ?&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p><em>controllers/common.js</em></p><pre><code class="lang-js">// On intervient avant que le DOM ne soit renvoy&#xE9; au Client.
// Ce code sera ex&#xE9;cut&#xE9; uniquement lors de la demande de la page &#xAB; / &#xBB;.
exports.changeDom = function (next, locals, request, response) {
    var $ = locals.virtualDom(); // Transformer la cha&#xEE;ne HTML en DOM Virtuel.

    // Apr&#xE8;s tous les h1 de la sortie HTML &#xAB; dom &#xBB;,
    $(&quot;h1&quot;).each(function () {
        var $this = $(this);

        // ...on cr&#xE9;&#xE9; une div,
        $this.after(
            // ... on injecte le contenu du h1 dans la div,
            $(&quot;&lt;div&gt;&quot;).html($this.html())
        );
        // ...et supprime le h1.
        $this.remove();
    });

    // On retourne les modifications pour qu&apos;elles redeviennet une cha&#xEE;ne HTML.
    next($);
};
</code></pre><p><em>controllers/index.js</em></p><pre><code class="lang-js">// On intervient avant que le DOM ne soit renvoy&#xE9; au Client.
// Ce code sera ex&#xE9;cut&#xE9; uniquement lors de la demande de la page &#xAB; / &#xBB;.
exports.changeDom = function (next, locals, request, response) {
    var NA = this,
        cheerio = NA.modules.cheerio, // R&#xE9;cup&#xE9;ration de jsdom pour parcourir le DOM avec jQuery.
        $ = cheerio.load(locals.dom, { decodeEntities: false }); // On charge les donn&#xE9;es pour les manipuler comme un DOM.

    // On modifie tous les contenu des noeuds avec la classe `.title`,
    $(&quot;.title&quot;).text(&quot;Modification de Contenu&quot;);

    // On recr&#xE9;e une nouvelle sortie HTML avec nos modifications.
    locals.dom = $.html();

    // On passe &#xE0; la suite.
    next();
};
</code></pre><p>ce qui produit la sortie suivante :</p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot;&gt;
        &lt;title&gt;Titre du site&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div class=&quot;title&quot;&gt;Modification de Contenu&lt;/div&gt;
        &lt;div&gt;
            &lt;div&gt;Bienvenue&lt;/div&gt;
            &lt;p&gt;C&apos;est la page d&apos;accueil.&lt;/p&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><h4 id="setsockets">setSockets</h4><p>Pour maintenir une connexion temps r&#xE9;el entre votre partie Cliente et Serveur &#xE0; travers toutes les pages ouvertes sur tous les navigateurs de tous les ordinateurs sur le web, vous aller pouvoir d&#xE9;finir vos websockets ici <a href="partie-controleur-et-modele.html#echange-client-serveur-en-temps-reel-avec-websockets">Plus de d&#xE9;tail dans la partie Socket.IO</a>.</p><p><code>setSockets()</code> est une fonction a <code>exports</code> et fournissant :</p><ul>
<li>L&apos;objet <code>NA</code> en tant que <code>this</code>.</li>
</ul><p>Voici un exemple utilisant les deux points d&apos;entr&#xE9;e, d&apos;abord la commune &#xE0; plusieurs pages, puis celle de chaque page :</p><pre><code class="lang-json">{
    &quot;socketClientFile&quot;: &quot;/node-atlas/socket.io.js&quot;,
    &quot;socketServerOptions&quot;: { transports: [&apos;polling&apos;, &apos;websocket&apos;] },
    &quot;controller&quot;: &quot;common.js&quot;,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;,
            &quot;controller&quot;: &quot;index.js&quot;
        }
    }
}
</code></pre><p>avec cet ensemble de fichier :</p><pre><code>&#x251C;&#x2500; assets/
&#x2502;  &#x2514;&#x2500; javascripts/
&#x2502;     &#x2514;&#x2500; index.js
&#x251C;&#x2500; controllers/
&#x2502;  &#x251C;&#x2500; common.js
&#x2502;  &#x251C;&#x2500; index.js
&#x2502;  &#x2514;&#x2500; test.js
&#x251C;&#x2500; views/
&#x2502;  &#x2514;&#x2500; index.htm
&#x2514;&#x2500; webconfig.json
</code></pre><p>En demandant la page <code>http://localhost/</code> les fichiers suivants (entre autre) seront utilis&#xE9;s :</p><p><em>views/index.htm</em></p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot; /&gt;
        &lt;title&gt;Exemple Websocket&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div class=&quot;layout&quot;&gt;
            &lt;div class=&quot;content&quot;&gt;&lt;/div&gt;
            &lt;div class=&quot;field&quot;&gt;Tape du texte : &lt;input class=&quot;input&quot; type=&quot;text&quot;&gt;&lt;/div&gt;
        &lt;/div&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;socket.io/socket.io.js&quot;&gt;&lt;/script&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;node-atlas/socket.io.js&quot;&gt;&lt;/script&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;javascripts/test.js&quot;&gt;&lt;/script&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;javascripts/index.js&quot;&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p><em>Note : Si</em> <code>socketClientFile</code> <em>et</em> <code>socketServerOptions</code> <em>ne sont pas pr&#xE9;sent dans <code>webconfig.json</code>, par d&#xE9;faut le fichier client et les options serveurs pour configurer les sockets sont bien</em> <code>/node-atlas/socket.io.js</code> <em>et</em> <code>{ transports: [&apos;polling&apos;, &apos;websocket&apos;] }</code>. <em>Il sont donc utiles seulement pour changer le chemin du fichier ou les transports des sockets permis. Si vous mettez <code>socketClientFile</code> &#xE0; <code>false</code>, le fichier client ne sera pas accessible.</em></p><p><em>assets/javascripts/test.js</em></p><pre><code class="lang-js">(function (expose, factory) {
    if (typeof module !== &apos;undefined&apos; &amp;&amp; module.exports) {
        module.exports = factory;
    } else {
        expose.Test = factory;
    }
}(this, function () {
    if (NA.isClient) {
        console.log(&quot;Client&quot;);
    } else {
        console.log(&quot;Serveur&quot;);
    }
}));
</code></pre><p><em>controllers/common.js</em></p><pre><code class="lang-js">// On r&#xE9;f&#xE9;rence les actions de r&#xE9;ponse et d&apos;envoi globaux c&#xF4;t&#xE9; serveur.
// Ce code sera ex&#xE9;cut&#xE9; pour toute entr&#xE9;e Websocket entrante.
exports.setSockets = function () {
    var NA = this,
        io = NA.io;

    io.on(&apos;connection&apos;, function (socket) {
        console.log(&quot;Un onglet est ouvert.&quot;);
        socket.on(&apos;disconnect&apos;, function () {
            console.log(&quot;Un onglet est ferm&#xE9;.&quot;);
        });
    });
};
</code></pre><p><em>controllers/index.js</em></p><pre><code class="lang-js">// On r&#xE9;f&#xE9;rence les actions de r&#xE9;ponse et d&apos;envoi globaux c&#xF4;t&#xE9; serveur.
// Ce code sera ex&#xE9;cut&#xE9; pour toute entr&#xE9;e Websocket entrante.
exports.setSockets = function () {
    var NA = this,
        path = NA.modules.path,
        io = NA.io;

    require(path.join(NA.serverPath, NA.webconfig.assetsRelativePath, &quot;javascripts/test.js&quot;))(); // display `Serveur`

    // Attendre un lien valide entre client et serveur
    io.sockets.on(&quot;connection&quot;, function (socket) {

        // Quelqu&apos;un nous informe que le texte &#xE0; chang&#xE9;.
        socket.on(&quot;update-text&quot;, function (data) {

            // On informe les autres que le texte &#xE0; chang&#xE9;.
            io.sockets.emit(&quot;update-text&quot;, data);
        });
    });
};
</code></pre><p><em>assets/javascripts/index.js</em></p><pre><code class="lang-js">var content = document.getElementsByClassName(&quot;content&quot;)[0],
    input = document.getElementsByClassName(&quot;input&quot;)[0];

Test(); // display `Client`

// On alerte les autres de nos modifications.
input.addEventListener(&quot;keyup&quot;, function () {
    content.innerHTML = input.value;
    NA.socket.emit(&quot;update-text&quot;, {
        text: input.value
    });
});

// On r&#xE9;cup&#xE8;re les modifications des autres.
NA.socket.on(&quot;update-text&quot;, function (data) {
    content.innerHTML = data.text;
    input.value = data.text;
});
</code></pre><p>Vous pourrez, en ouvrant divers navigateurs, et divers onglet, constat&#xE9; que tout est bien mis &#xE0; jour chez tout le monde. Chaque nouvel ongle ouvert affiche sur le serveur le message de connexion, et chaque onglet ferm&#xE9;, le message de deconnexion sur la console serveur.</p><p><em>Note : Vous pouvez changer le fichier <code>node-atlas/socket.io.js</code> par un fichier fournis par vous-m&#xEA;me pour changer la variable <code>optionsSocket</code>. Vous pouvez aussi changer la valeur de <code>NA.optionsSocket</code> c&#xF4;t&#xE9; client (avant l&apos;insertion de <code>node-atlas/socket.io.js</code>) avec un objet d&apos;options personnalis&#xE9;es.</em></p><h4 id="setmodules">setModules</h4><p>Pour charger d&apos;autres modules qui ne sont pas fournis avec NodeAtlas vous pouvez utiliser le contr&#xF4;leur commun pour tout le site afin de les charger une seule fois et de les rendres disponible dans tous vos contr&#xF4;leurs.</p><p><code>setModules()</code> est une fonction a <code>exports</code> et fournissant :</p><ul>
<li>L&apos;objet <code>NA</code> en tant que <code>this</code>.</li>
</ul><p>Voici un exemple utilisant un module externe &#xE0; NodeAtlas :</p><pre><code class="lang-json">{
    &quot;controller&quot;: &quot;common.js&quot;,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;,
            &quot;controller&quot;: &quot;index.js&quot;
        }
    }
}
</code></pre><p>avec cet ensemble de fichier :</p><pre><code>&#x251C;&#x2500; controllers/
&#x2502;  &#x251C;&#x2500; common.js
&#x2502;  &#x2514;&#x2500; index.js
&#x251C;&#x2500; views/
&#x2502;  &#x2514;&#x2500; index.htm
&#x2514;&#x2500; webconfig.json
</code></pre><p>En demandant la page <code>http://localhost/</code> les fichiers suivants (entre autre) seront utilis&#xE9;s :</p><p><em>views/index.htm</em></p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot; /&gt;
        &lt;title&gt;Test Module&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div class=&quot;title&quot;&gt;Test Module&lt;/div&gt;
        &lt;div&gt;
            &lt;h1&gt;Test Module&lt;/h1&gt;
            &lt;?- example ?&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p><em>controllers/common.js</em></p><pre><code class="lang-js">// On intervient avant que la phase de chargement des modules ne soit achev&#xE9;e.
// Ce code sera ex&#xE9;cut&#xE9; au lancement de NodeAtlas.
exports.setModules = function () {
    // R&#xE9;cup&#xE9;rer l&apos;instance &#xAB; NodeAtlas &#xBB; du moteur.
    var NA = this;

    // Associations de chaque module pour y avoir acc&#xE8;s partout.
    NA.modules.marked = require(&apos;marked&apos;);
};
</code></pre><p><em>controllers/index.js</em></p><pre><code class="lang-js">// On intervient avant que les variables soient inject&#xE9;es dans le syst&#xE8;me de template.
// Ce code sera ex&#xE9;cut&#xE9; uniquement lors de la demande de la page &#xAB; / &#xBB;.
exports.changeVariations = function (next, locals) {
    // Utiliser &#xAB; NodeAtlas &#xBB; depuis le moteur.
    var NA = this,
        marked = NA.modules.marked;

    locals.example = marked(&quot;J&apos;utilise __markdown__.&quot;);

    // On passe &#xE0; la suite.
    next();
};
</code></pre><p>ce qui produit la sortie suivante :</p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot; /&gt;
        &lt;title&gt;Test Module&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div class=&quot;title&quot;&gt;Test Module&lt;/div&gt;
        &lt;div&gt;
            &lt;h1&gt;Test Module&lt;/h1&gt;
            &lt;p&gt;I am using &lt;strong&gt;markdown&lt;/strong&gt;.&lt;/p&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><h4 id="setconfigurations">setConfigurations</h4><p>Pour configurer le serveur web de NodeAtlas (<a href="http://expressjs.com/">ExpressJs</a>) vous pouvez utiliser le contr&#xF4;leur commun pour tout le site afin faire vos modifications avant le d&#xE9;marrage du serveur.</p><p><code>setConfigurations(next)</code> est une fonction a <code>exports</code> et fournissant :</p><ul>
<li>L&apos;objet <code>NA</code> en tant que <code>this</code>.</li>
<li>En premier param&#xE8;tre la fonction de retour <code>next()</code>.</li>
</ul><p>Voici un exemple utilisant un middleware pour <a href="http://expressjs.com/">ExpressJs</a> :</p><pre><code class="lang-json">{
    &quot;controller&quot;: &quot;common.js&quot;,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;,
            &quot;controller&quot;: &quot;index.js&quot;
        }
    }
}
</code></pre><p>avec cet ensemble de fichier :</p><pre><code>&#x251C;&#x2500; controllers/
&#x2502;  &#x251C;&#x2500; common.js
&#x2502;  &#x2514;&#x2500; index.js
&#x251C;&#x2500; views/
&#x2502;  &#x2514;&#x2500; index.htm
&#x2514;&#x2500; webconfig.json
</code></pre><p>En demandant la page <code>http://localhost/</code> les fichiers suivants (entre autre) seront utilis&#xE9;s :</p><p><em>views/index.htm</em></p><pre><code class="lang-html">&lt;?- content ?&gt;
</code></pre><p><em>controllers/common.js</em></p><pre><code class="lang-js">// On intervient au niveau du serveur avant que celui-ci ne soit d&#xE9;marr&#xE9;.
// Ce code sera ex&#xE9;cut&#xE9; au lancement de NodeAtlas.
exports.setConfigurations = function (next) {
    // R&#xE9;cup&#xE9;rer l&apos;instance &#xAB; NodeAtlas &#xBB; du moteur.
    var NA = this;

    // Middleware utilis&#xE9; lors de chaque requ&#xEA;te.
    NA.express.use(function (request, response, next) {
        response.setHeader(&quot;X-Frame-Options&quot;, &quot;ALLOW-FROM http://www.lesieur.name/&quot;);
        next();
    });

    // On r&#xE9;-injecte les modifications.
    next();
};
</code></pre><p><em>controllers/index.js</em></p><pre><code class="lang-js">// On intervient avant que les variables soient inject&#xE9;es dans le moteur de template.
// Ce code sera ex&#xE9;cut&#xE9; uniquement lors de la demande de la page &#xAB; / &#xBB;.
exports.changeVariations = function (next, locals) {

    // On pr&#xE9;pare le fichier pour un affichage JSON.
    locals.routeParameters.headers = {
        &quot;Content-Type&quot;: &quot;application/json; charset=utf-8&quot;
    };
    locals.content = JSON.stringify(locals, null, &quot;    &quot;);

    // On passe &#xE0; la suite.
    next();
};
</code></pre><p>ce qui produit la sortie suivante :</p><pre><code class="lang-html">{
    &quot;urlRootPath&quot;: &quot;http://localhost&quot;,
    &quot;urlSubPath&quot;: &quot;&quot;,
    &quot;urlBasePath&quot;: &quot;http://localhost&quot;,
    &quot;urlFilePath&quot;: &quot;/&quot;,
    &quot;urlQueryPath&quot;: &quot;&quot;,
    &quot;urlPath&quot;: &quot;http://localhost/&quot;,
    &quot;params&quot;: {},
    &quot;query&quot;: {},
    &quot;body&quot;: {},
    &quot;routeParameters&quot;: { /* ... */ },
    &quot;route&quot;: &quot;/&quot;,
    &quot;webconfig&quot;: { /* ... */ }
}
</code></pre><h4 id="setsessions">setSessions</h4><p>Pour configurer les sessions client-serveur de NodeAtlas vous pouvez utiliser le contr&#xF4;leur commun pour tout le site afin de d&#xE9;finir vos sessions avant le d&#xE9;marrage du serveur. Voici un exemple de management de Session avec <a href="http://redis.io/">Redis</a>.</p><p><code>setSessions(next)</code> est une fonction a <code>exports</code> et fournissant :</p><ul>
<li>L&apos;objet <code>NA</code> en tant que <code>this</code>.</li>
<li>En premier param&#xE8;tre la fonction de retour <code>next()</code>.</li>
</ul><p>Voici l&apos;ensemble de fichier suivant :</p><pre><code>&#x251C;&#x2500; controllers/
&#x2502;  &#x2514;&#x2500; common.js
&#x251C;&#x2500; views/
&#x2502;  &#x2514;&#x2500; index.htm
&#x251C;&#x2500; variations/
&#x2502;  &#x251C;&#x2500; common.json
&#x2502;  &#x2514;&#x2500; index.json
&#x2514;&#x2500; webconfig.json
</code></pre><p>Avec le <code>webconfig.json</code> :</p><pre><code class="lang-json">{
    &quot;controller&quot;: &quot;common.js&quot;,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;
        }
    }
}
</code></pre><p>et avec le fichier &#xAB; common.js &#xBB; contenant par exemple :</p><pre><code class="lang-js">// On intervient avant que la phase de chargement des modules ne soit achev&#xE9;e.
// Ce code sera ex&#xE9;cut&#xE9; au lancement de NodeAtlas.
exports.setModules = function () {
    // R&#xE9;cup&#xE9;rer l&apos;instance &#xAB; NodeAtlas &#xBB; du moteur.
    var NA = this;

    // Associations de chaque module pour y avoir acc&#xE8;s partout.
    NA.modules.RedisStore = require(&apos;connect-redis&apos;);
};

// On intervient au niveau du serveur pendant la configuration des sessions.
// Ce code sera ex&#xE9;cut&#xE9; au lancement de NodeAtlas.
exports.setSessions = function (next) {
    var NA = this,
        session = NA.modules.session,
        RedisStore = NA.modules.RedisStore(session);

    // On remplace la session par default.
    NA.sessionStore = new RedisStore();

    // On redonne la main &#xE0; NodeAtlas pour la suite.
    next();
};
</code></pre><h4 id="setroutes">setRoutes</h4><p>Pour configurer les routes de NodeAtlas dynamiquement vous pouvez utiliser le contr&#xF4;leur commun pour tout le site afin de les charger une seule fois et de les rendres disponible dans tous vos contr&#xF4;leurs.</p><p><code>setRoutes(next)</code> est une fonction a <code>exports</code> et fournissant :</p><ul>
<li>L&apos;objet <code>NA</code> en tant que <code>this</code>.</li>
<li>En premier param&#xE8;tre la fonction de retour <code>next()</code>.</li>
</ul><p>Voici l&apos;ensemble de fichier suivant :</p><pre><code>&#x251C;&#x2500; controllers/
&#x2502;  &#x2514;&#x2500; common.js
&#x251C;&#x2500; views/
&#x2502;  &#x251C;&#x2500; content.htm
&#x2502;  &#x2514;&#x2500; index.htm
&#x251C;&#x2500; variations/
&#x2502;  &#x2514;&#x2500; common.json
&#x2514;&#x2500; webconfig.json
</code></pre><p>Avec le <code>webconfig.json</code> :</p><pre><code class="lang-json">{
    &quot;controller&quot;: &quot;common.js&quot;,
    &quot;variation&quot;: &quot;common.json&quot;,
    &quot;routes&quot;: {
        &quot;/index.html&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;
        }
    }
}
</code></pre><p>et avec le fichier &#xAB; common.js &#xBB; contenant par exemple :</p><pre><code class="lang-json">// On intervient au niveau des routes pendant qu&apos;elles sont ajout&#xE9;es.
// Ce code sera ex&#xE9;cut&#xE9; au lancement de NodeAtlas.
exports.setRoutes = function (next) {

    // On r&#xE9;cup&#xE8;re l&apos;instance de NodeAtlas en cours.
    var NA = this,

        // Et nous r&#xE9;cup&#xE9;rons les routes en provenance du webconfig...
        route = NA.webconfig.routes;

    // ...pour ajouter la route &quot;/content.html&quot; &#xE0; la liste de nos routes.
    route[&quot;/content.html&quot;] = {
        &quot;view&quot;: &quot;content.htm&quot;
    };

    // On redonne la main &#xE0; NodeAtlas pour la suite.
    next();
};
</code></pre><h3 id="echange-client-serveur-en-temps-reel-avec-websockets">&#xC9;change client-serveur en temps r&#xE9;el avec websockets</h3><p>Afin de conserver une liaison ouverte entre la partie Cliente et la partie Serveur de vos applications, NodeAtlas utilise <a href="http://socket.io/">Socket.IO</a> dont vous trouverez plus de d&#xE9;tail sur le site officiel.</p><p>Gr&#xE2;ce &#xE0; cela, vous pourrez changer des informations en temps r&#xE9;el sur votre page, mais &#xE9;galement sur toutes les autres pages ouvertes &#xE0; travers tous les autres navigateurs.</p><p>Avec l&apos;ensemble de fichier suivant :</p><pre><code>&#x251C;&#x2500; assets/
&#x2502;  &#x2514;&#x2500; javascripts/
&#x2502;     &#x2514;&#x2500; index.js
&#x251C;&#x2500; controllers/
&#x2502;  &#x2514;&#x2500; index.js
&#x251C;&#x2500; variations/
&#x2502;  &#x251C;&#x2500; common.json
&#x2502;  &#x2514;&#x2500; index.json
&#x251C;&#x2500; views/
&#x2502;  &#x251C;&#x2500; partials/
&#x2502;  &#x2502;  &#x2514;&#x2500; index.htm
&#x2502;  &#x2514;&#x2500; index.htm
&#x2514;&#x2500; webconfig.json
</code></pre><p>Contenant le <code>webconfig.json</code> suivant :</p><pre><code class="lang-json">{
    &quot;variation&quot;: &quot;common.json&quot;,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;,
            &quot;variation&quot;: &quot;index.json&quot;,
            &quot;controller&quot;: &quot;index.js&quot;
        }
    }
}
</code></pre><p>et contenant les fichiers de template suivant :</p><p><em>views/partials/index.htm</em></p><pre><code class="lang-html">        &lt;div class=&quot;title&quot;&gt;&lt;?- common.titleWebsite ?&gt;&lt;/div&gt;
        &lt;div&gt;
            &lt;h1&gt;&lt;?- specific.titlePage ?&gt;&lt;/h1&gt;
            &lt;?- specific.content ?&gt;
            &lt;div&gt;&lt;?- new Date() ?&gt;&lt;/div&gt;
        &lt;/div&gt;
        &lt;button&gt;Update&lt;/button&gt;
</code></pre><p><em>Note : Chaque clique sur <code>button</code> raffraichira le contenu de <code>views/partials/index.htm</code>.</em></p><p><em>views/index.htm</em></p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot; /&gt;
        &lt;title&gt;&lt;?- common.titleWebsite ?&gt;&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div class=&quot;layout&quot;&gt;
            &lt;?- include(&apos;partials/index.htm&apos;) ?&gt;
        &lt;/div&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;socket.io/socket.io.js&quot;&gt;&lt;/script&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;node-atlas/socket.io.js&quot;&gt;&lt;/script&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;javascripts/index.js&quot;&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p><em>Note : On construit ici la page d&apos;accueil <code>/</code>.</em></p><p>ainsi que les fichiers de variations suivant :</p><p><em>variations/common.json</em></p><pre><code class="lang-json">{
    &quot;titleWebsite&quot;: &quot;Exemple Socket.IO&quot;
}
</code></pre><p><em>variations/index.json</em></p><pre><code class="lang-json">{
    &quot;titlePage&quot;: &quot;Date&quot;,
    &quot;content&quot;: &quot;&lt;p&gt;La date actuelle est :&lt;/p&gt;&quot;
}
</code></pre><p>Jusque l&#xE0;, rien d&apos;inhabituel et tout fonctionnerait sans partie contr&#xF4;leur. Mais nous allons mettre en place la communication via Socket.IO c&#xF4;t&#xE9; Serveur puis c&#xF4;t&#xE9; Client.</p><p>C&#xF4;t&#xE9; serveur, nous utiliserons le contr&#xF4;leur commun suivant :</p><p><em>controllers/index.js</em></p><pre><code class="lang-js">// Int&#xE9;gralit&#xE9; des actions Websocket possible avec `setSockets`.
exports.setSockets = function () {
    var NA = this,
        io = NA.io;

    // D&#xE8;s qu&apos;on a un lien valide entre le client et notre serveur...
    io.sockets.on(&quot;connection&quot;, function (socket) {

        // ...rester &#xE0; l&apos;&#xE9;coute de la demande &#xAB; create-article-button &#xBB;...
        socket.on(&quot;server-render&quot;, function (data) {
            var sessionID = socket.request.sessionID,
                session = socket.request.session,
                locals = {};

            // On r&#xE9;cup&#xE8;re les variations sp&#xE9;cifiques dans la bonne langue.
            locals = NA.specific(&quot;index.json&quot;, data.lang, locals);

            // On r&#xE9;cup&#xE8;re les variations communes dans la bonne langue.
            locals = NA.common(data.lang, locals);

            // On r&#xE9;cup&#xE8;re le fragment HTML depuis le dossier `viewsRelativePath` et on applique les variations.
            data.render = NA.view(&quot;partials/index.htm&quot;, locals);

            // Et on r&#xE9;pond &#xE0; tous les clients avec un jeu de donn&#xE9;e dans data.
            io.sockets.emit(&quot;server-render&quot;, data);
        });
    });
};
</code></pre><p>Quand au c&#xF4;t&#xE9; client, nous utiliserons les fichiers suivant :</p><p><em>assets/javascripts/index.js</em></p><pre><code class="lang-js">var html = document.getElementsByTagName(&quot;html&quot;)[0],
    layout = document.getElementsByClassName(&quot;layout&quot;)[0];

// On associe sur le bouton l&apos;action de communiquer avec le serveur en cliquant dessus.
function setServerRender() {
    var button = document.getElementsByTagName(&quot;button&quot;)[0];
    button.addEventListener(&quot;click&quot;, function () {
        NA.socket.emit(&quot;server-render&quot;, {
            lang: html.getAttribute(&quot;lang&quot;)
        });
    });
}

// On affecte l&apos;action au bouton.
setServerRender();

// Quand le serveur r&#xE9;pond apr&#xE8;s notre demande aupr&#xE8;s de lui...
NA.socket.on(&quot;server-render&quot;, function (data) {

    // ...on met &#xE0; jour le contenu...
    layout.innerHTML = data.render;

    // ...et r&#xE9;-affectons l&apos;action au bouton du nouveau contenu.
    setServerRender();
});
</code></pre><p>Lancer votre projet et rendez-vous &#xE0; l&apos;adresse <code>http://localhost/</code> dans deux onglets diff&#xE9;rent, voir m&#xEA;me, dans deux navigateurs diff&#xE9;rent. Vous constaterez alors qu&apos;&#xE0; chaque clique sur &#xAB; Update &#xBB;, la page se remettra &#xE0; jour (comme le montre la date courante) sur tous les onglets ouvert.</p><p>Gr&#xE2;ce &#xE0; <code>NA.specific</code>, <code>NA.common</code> et <code>NA.view</code>, il est possible de g&#xE9;n&#xE9;rer une nouvelle compilation d&apos;une vue et d&apos;une variation commune et sp&#xE9;cifique.</p><p>Si <code>data.lang</code> dans notre exemple est de type <code>undefined</code>, alors les fichiers seront cherch&#xE9;s &#xE0; la racine. Si <code>locals</code> est de type <code>undefined</code> alors un objet contenant uniquement le scope demand&#xE9; sera renvoy&#xE9;.</p><p>Note : pour permettre &#xE0; <code>view</code> d&apos;utiliser le moteur Pug au lieu de celui d&apos;EJS, il faut mettre la valeur <code>locals.pug</code> &#xE0; <code>true</code> avant d&apos;utiliser <code>NA.common</code> et <code>NA.specific</code>.</p><h3 id="utiliser-une-base-de-donnees-mysql-sql">Utiliser une base de donn&#xE9;es MySQL (SQL)</h3><p>Nous allons voir &#xE0; pr&#xE9;sent comment utiliser des informations venant d&apos;une base de donn&#xE9;es. Pour cela nous allons utiliser le module npm <code>mysql</code>. Il va &#xE9;galement nous falloir <a href="https://dev.mysql.com/downloads/installer/">installer un serveur MySQL</a>.</p><p>Donc, depuis le dossier du <code>webconfig.json</code>, utilisez :</p><pre><code class="lang-bash">npm install mysql
</code></pre><h4 id="base-de-donn-es-mysql">Base de donn&#xE9;es MySQL</h4><p>Tout d&apos;abord, nous allons alimenter la base de donn&#xE9;es avec la base <code>demo</code> :</p><pre><code class="lang-sql">CREATE DATABASE demo;
</code></pre><p>et la s&#xE9;lectionner :</p><pre><code class="lang-sql">USE demo
</code></pre><p>puis cr&#xE9;er la table <code>user</code> :</p><pre><code class="lang-sql">CREATE TABLE user
(
    id INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
    lastname VARCHAR(100),
    firstname VARCHAR(100),
    email VARCHAR(255),
    birthdate DATE,
    gender TINYINT(1),
    country VARCHAR(255),
    town VARCHAR(255),
    zipcode VARCHAR(5),
    address VARCHAR(255)
);
</code></pre><p>et la remplir avec un jeu de donn&#xE9;es :</p><pre><code class="lang-sql">INSERT INTO user (
    lastname,
    firstname,
    email,
    birthdate,
    gender,
    country,
    town,
    zipcode,
    address
) VALUES (
    &quot;Elric&quot;,
    &quot;Edward&quot;,
    &quot;edward.elric@fma.br&quot;,
    &quot;2006/01/01&quot;,
    true,
    &quot;Amestris&quot;,
    &quot;Resembool&quot;,
    00000,
    &quot;The Elric&apos;s house&quot;
);
INSERT INTO user (
    lastname,
    firstname,
    email,
    birthdate,
    gender,
    country,
    town,
    zipcode,
    address
) VALUES (
    &quot;Elric&quot;,
    &quot;Alphonse&quot;,
    &quot;alphonse.elric@fma.br&quot;,
    &quot;2008/01/01&quot;,
    true,
    &quot;Amestris&quot;,
    &quot;Resembool&quot;,
    00000,
    &quot;The Elric&apos;s house&quot;
);
</code></pre><h4 id="fichiers-nodeatlas">Fichiers NodeAtlas</h4><p>Voyons &#xE0; pr&#xE9;sent l&apos;architecture de site que nous allons arbitrairement cr&#xE9;er pour pr&#xE9;senter notre exemple :</p><pre><code>&#x251C;&#x2500; controllers/
&#x2502;  &#x251C;&#x2500; common.js
&#x2502;  &#x2514;&#x2500; index.js
&#x251C;&#x2500; models/
&#x2502;  &#x251C;&#x2500; objects/
&#x2502;  &#x2502;  &#x2514;&#x2500; user.js
&#x2502;  &#x2514;&#x2500; connectors/
&#x2502;     &#x2514;&#x2500; user.js
&#x251C;&#x2500; views/
&#x2502;  &#x2514;&#x2500; index.htm
&#x251C;&#x2500; variations/
&#x2502;  &#x251C;&#x2500; common.json
&#x2502;  &#x2514;&#x2500; index.json
&#x2514;&#x2500; webconfig.json
</code></pre><p>Nous allons utiliser le <code>webconfig.json</code> suivant avec une variable custom <code>_mysqlConfig</code> qui contiendra toutes les informations pour se connecter &#xE0; la base de donn&#xE9;es :</p><pre><code class="lang-json">{
    &quot;controller&quot;: &quot;common.js&quot;,
    &quot;variation&quot;: &quot;common.json&quot;,
    &quot;statics&quot;: {
        &quot;/models&quot;: &quot;models/objects&quot;
    },
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;,
            &quot;variation&quot;: &quot;index.json&quot;,
            &quot;controller&quot;: &quot;index.js&quot;
        }
    },
    &quot;_mysqlConfig&quot;: {
        &quot;host&quot;: &quot;localhost&quot;,
        &quot;user&quot;: &quot;root&quot;,
        &quot;password&quot;: &quot;root&quot;,
        &quot;database&quot;: &quot;demo&quot;
    }
}
</code></pre><p>Nous allons ensuite nous connecter &#xE0; la base de donn&#xE9;es avec le contr&#xF4;leur globale <code>controllers/common.js</code> :</p><pre><code class="lang-json">exports.setModules = function () {
    var NA = this;

    // Import du module `mysql`.
    NA.modules.mysql = require(&apos;mysql&apos;);

    // Cr&#xE9;ation de la collection de mod&#xE8;le...
    NA.models = {};
    // ...et r&#xE9;cup&#xE9;ration du mod&#xE8;le User avec acc&#xE8;s &#xE0; Mysql.
    NA.models.User = require(&apos;../models/connectors/user.js&apos;);
};

exports.setConfigurations = function (next) {
    var NA = this,
        path = NA.modules.path,
        mysql = NA.modules.mysql;

    // Cr&#xE9;er un pool de connexion &#xE0; MySQL.
    NA.mySql = mysql.createPool(NA.webconfig._mysqlConfig);

    next();
};
</code></pre><p>Et afficher les r&#xE9;sultats via le contr&#xF4;leur sp&#xE9;cifique <code>controllers/index.js</code> :</p><pre><code class="lang-json">exports.changeVariations = function (next, locals) {
    var NA = this,
        user = new NA.models.User(),
        user2 = new NA.models.User(),
        user3 = new NA.models.User(),
        user4 = new NA.models.User();

    NA.mySql.getConnection(function(err, connection) {
        if (err) {
            throw err;
        }

        // Exemple de lecture.
        user
        .setConnection(connection)
        .lastname(&quot;Elric&quot;)
        .read(function (allUsers) {
            locals.user = user;
            locals.users = allUsers;

            // Exemple de cr&#xE9;ation.
            user2
            .setConnection(connection)
            .firstname(&quot;Winry&quot;)
            .lastname(&quot;Rockbell&quot;)
            .email(&quot;winry.rockbell@fma.br&quot;)
            .gender(true)
            .create(function (infos) {
                locals.insertId = infos.insertId;
                locals.user2 = user2;

                // Exemple de modification.
                user3
                .gender(false)
                .birthdate(&quot;2008-01-01&quot;)
                .country(&quot;Amestris&quot;)
                .town(&quot;Resembool&quot;)
                .zipcode(&quot;99999&quot;)
                .address(&quot;The Rockbell&apos;s house&quot;);

                user2.update(user3, function (infos) {
                    locals.affectedRows = infos.affectedRows;
                    locals.user2 = user2;

                    // Exemple de suppression.
                    user4
                    .setConnection(connection)
                    .gender(false)
                    .delete(function (infos) {
                        locals.deletedRows = infos.affectedRows;
                        next();
                    });
                });
            });
        });
    });
};
</code></pre><p>en utilisant le mod&#xE8;le <code>user</code> via le fichier de connexion &#xE0; la base de donn&#xE9;es <code>models/connectors/user.js</code> :</p><pre><code class="lang-json">var user = require(&apos;../objects/user.js&apos;);

function User(connection) {
    var privates = {},
        publics = this;

    user.call(publics);

    privates.connection = connection;

    publics.setConnection = function (connection) {
        privates.connection = connection;
        return publics;
    };

    publics.read = function (callback) {
        var select = `SELECT
                    id,
                    lastname,
                    firstname,
                    email,
                    birthdate,
                    gender,
                    country,
                    town,
                    zipcode,
                    address
                FROM user`,
            where = &quot;&quot;;

        if (publics.id()) { where += &apos; &amp;&amp; `id` = &apos; + publics.id(); }
        if (publics.lastname()) { where += &apos; &amp;&amp; `lastname` = &quot;&apos; + publics.lastname() + &apos;&quot;&apos;; }
        if (publics.firstname()) { where += &apos; &amp;&amp; `firstname` = &quot;&apos; + publics.firstname() + &apos;&quot;&apos;; }
        if (publics.email()) { where += &apos; &amp;&amp; `email` = &quot;&apos; + publics.email() + &apos;&quot;&apos;; }
        if (publics.birthdate()) { where += &apos; &amp;&amp; `birthdate` = &quot;&apos; + publics.birthdate() + &apos;&quot;&apos;; }
        if (typeof publics.gender() === &quot;boolean&quot;) { where += &apos; &amp;&amp; `gender` = &apos; + (publics.gender() ? 1 : 0); }
        if (publics.country()) { where += &apos; &amp;&amp; `country` = &quot;&apos; + publics.country() + &apos;&quot;&apos;; }
        if (publics.town()) { where += &apos; &amp;&amp; `town` = &quot;&apos; + publics.town() + &apos;&quot;&apos;; }
        if (publics.zipcode()) { where += &apos; &amp;&amp; `zipcode` = &quot;&apos; + publics.zipcode() + &apos;&quot;&apos;; }
        if (publics.address()) { where += &apos; &amp;&amp; `address` = &quot;&apos; + publics.address() + &apos;&quot;&apos;; }

        where = where.replace(&quot;&amp;&amp;&quot;, &quot;WHERE&quot;);

        privates.connection.query(select + where, function (err, rows) {
            var users = [],
                user;

            if (err) {
                throw err;
            }

            if (rows[0]) {
                publics.id(rows[0].id);
                publics.lastname(rows[0].lastname);
                publics.firstname(rows[0].firstname);
                publics.email(rows[0].email);
                publics.birthdate(rows[0].birthdate);
                publics.gender((rows[0].gender) ? true : false);
                publics.country(rows[0].country);
                publics.town(rows[0].town);
                publics.zipcode(rows[0].zipcode);
                publics.address(rows[0].address);
            }

            for (var i = 0; i &lt; rows.length; i++) {
                user = new User();
                user.id(rows[i].id);
                user.lastname(rows[i].lastname);
                user.firstname(rows[i].firstname);
                user.email(rows[i].email);
                user.birthdate(rows[i].birthdate);
                user.gender((rows[i].gender) ? true : false);
                user.country(rows[i].country);
                user.town(rows[i].town);
                user.zipcode(rows[i].zipcode);
                user.address(rows[i].address);
                users.push(user);
            }

            if (callback) {
                callback(users);
            }
        });

        return publics;
    };

    publics.create = function (callback) {
        var insert = &quot;INSERT INTO user (&quot;,
            values = &quot;) VALUES (&quot;;

        if (publics.id()) {
            insert += &quot;`id`, &quot;;
            values += publics.id() + &apos;, &apos;;
        }
        if (publics.lastname()) {
            insert += &quot;`lastname`, &quot;;
            values += &apos;&quot;&apos; + publics.lastname() + &apos;&quot;, &apos;;
        }
        if (publics.firstname()) {
            insert += &quot;`firstname`, &quot;;
            values += &apos;&quot;&apos; + publics.firstname() + &apos;&quot;, &apos;;
        }
        if (publics.email()) {
            insert += &quot;`email`, &quot;;
            values += &apos;&quot;&apos; + publics.email() + &apos;&quot;, &apos;;
        }
        if (publics.birthdate()) {
            insert += &quot;`birthdate`, &quot;;
            values += &apos;&quot;&apos; + publics.birthdate() + &apos;&quot;, &apos;;
        }
        if (typeof publics.gender() === &quot;boolean&quot;) {
            insert += &quot;`gender`, &quot;;
            values += (publics.gender() ? 1 : 0) + &apos;, &apos;;
        }
        if (publics.country()) {
            insert += &quot;`country`, &quot;;
            values += &apos;&quot;&apos; + publics.country() + &apos;&quot;, &apos;;
        }
        if (publics.town()) {
            insert += &quot;`town`, &quot;;
            values += &apos;&quot;&apos; + publics.town() + &apos;&quot;, &apos;;
        }
        if (publics.zipcode()) {
            insert += &quot;`zipcode`, &quot;;
            values += &apos;&quot;&apos; + publics.zipcode() + &apos;&quot;, &apos;;
        }
        if (publics.address()) {
            insert += &quot;`address`, &quot;;
            values += &apos;&quot;&apos; + publics.address() + &apos;&quot;, &apos;;
        }

        insert = insert.replace(/, $/g, &quot;&quot;);
        values = values.replace(/, $/g, &quot;)&quot;);

        privates.connection.query(insert + values, function (err, infos) {
            if (err) {
                throw err;
            }

            publics.id(infos.insertId);

            if (callback) {
                callback(infos);
            }
        });

        return publics;
    };

    publics.update = function (user, callback) {
        var update = &quot;UPDATE user SET&quot;,
            where = &quot;&quot;;

        if (user.id()) { update += &apos;`id` = &apos; + user.id() + &apos;, &apos;; }
        if (user.lastname()) { update += &apos;`lastname` = &quot;&apos; + user.lastname() + &apos;&quot;, &apos;; }
        if (user.firstname()) { update += &apos;`firstname` = &quot;&apos; + user.firstname() + &apos;&quot;, &apos;; }
        if (user.email()) { update += &apos;`email` = &quot;&apos; + user.email() + &apos;&quot;, &apos;; }
        if (user.birthdate()) { update += &apos;`birthdate` = &quot;&apos; + user.birthdate() + &apos;&quot;, &apos;; }
        if (typeof user.gender() === &quot;boolean&quot;) { update += &apos;`gender` = &apos; + (user.gender() ? 1 : 0) + &apos;, &apos;; }
        if (user.country()) { update += &apos;`country` = &quot;&apos; + user.country() + &apos;&quot;, &apos;; }
        if (user.town()) { update += &apos;`town` = &quot;&apos; + user.town() + &apos;&quot;, &apos;; }
        if (user.zipcode()) { update += &apos;`zipcode` = &quot;&apos; + user.zipcode() + &apos;&quot;, &apos;; }
        if (user.address()) { update += &apos;`address` = &quot;&apos; + user.address() + &apos;&quot;, &apos;; }

        update = update.replace(/, $/g, &quot;&quot;);

        if (publics.id()) { where += &apos; &amp;&amp; `id` = &apos; + publics.id(); }
        if (publics.lastname()) { where += &apos; &amp;&amp; `lastname` = &quot;&apos; + publics.lastname() + &apos;&quot;&apos;; }
        if (publics.firstname()) { where += &apos; &amp;&amp; `firstname` = &quot;&apos; + publics.firstname() + &apos;&quot;&apos;; }
        if (publics.email()) { where += &apos; &amp;&amp; `email` = &quot;&apos; + publics.email() + &apos;&quot;&apos;; }
        if (publics.birthdate()) { where += &apos; &amp;&amp; `birthdate` = &quot;&apos; + publics.birthdate() + &apos;&quot;&apos;; }
        if (typeof publics.gender() === &quot;boolean&quot;) { where += &apos; &amp;&amp; `gender` = &apos; + (publics.gender() ? 1 : 0); }
        if (publics.country()) { where += &apos; &amp;&amp; `country` = &quot;&apos; + publics.country() + &apos;&quot;&apos;; }
        if (publics.town()) { where += &apos; &amp;&amp; `town` = &quot;&apos; + publics.town() + &apos;&quot;&apos;; }
        if (publics.zipcode()) { where += &apos; &amp;&amp; `zipcode` = &quot;&apos; + publics.zipcode() + &apos;&quot;&apos;; }
        if (publics.address()) { where += &apos; &amp;&amp; `address` = &quot;&apos; + publics.address() + &apos;&quot;&apos;; }

        where = where.replace(&quot;&amp;&amp;&quot;, &quot;WHERE&quot;);

        privates.connection.query(update + where, function (err, infos) {
            if (err) {
                throw err;
            }

            if (user.id()) { publics.id(user.id()); }
            if (user.lastname()) { publics.lastname(user.lastname()); }
            if (user.firstname()) { publics.firstname(user.firstname()); }
            if (user.email()) { publics.email(user.email()); }
            if (user.birthdate()) { publics.birthdate(user.birthdate()); }
            if (typeof publics.gender() === &quot;boolean&quot;) { publics.gender(user.gender()); }
            if (user.country()) { publics.country(user.country()); }
            if (user.town()) { publics.town(user.town()); }
            if (user.zipcode()) { publics.zipcode(user.zipcode()); }
            if (user.address()) { publics.address(user.address()); }

            if (callback) {
                callback(infos);
            }
        });

        return publics;
    };

    publics.delete = function (callback) {
        var del = &quot;DELETE FROM user&quot;,
            where = &quot;&quot;;

        if (publics.id()) { where += &apos; &amp;&amp; `id` = &apos; + publics.id(); }
        if (publics.lastname()) { where += &apos; &amp;&amp; `lastname` = &quot;&apos; + publics.lastname() + &apos;&quot;&apos;; }
        if (publics.firstname()) { where += &apos; &amp;&amp; `firstname` = &quot;&apos; + publics.firstname() + &apos;&quot;&apos;; }
        if (publics.email()) { where += &apos; &amp;&amp; `email` = &quot;&apos; + publics.email() + &apos;&quot;&apos;; }
        if (publics.birthdate()) { where += &apos; &amp;&amp; `birthdate` = &quot;&apos; + publics.birthdate() + &apos;&quot;&apos;; }
        if (typeof publics.gender() === &quot;boolean&quot;) { where += &apos; &amp;&amp; `gender` = &apos; + (publics.gender() ? 1 : 0); }
        if (publics.country()) { where += &apos; &amp;&amp; `country` = &quot;&apos; + publics.country() + &apos;&quot;&apos;; }
        if (publics.town()) { where += &apos; &amp;&amp; `town` = &quot;&apos; + publics.town() + &apos;&quot;&apos;; }
        if (publics.zipcode()) { where += &apos; &amp;&amp; `zipcode` = &quot;&apos; + publics.zipcode() + &apos;&quot;&apos;; }
        if (publics.address()) { where += &apos; &amp;&amp; `address` = &quot;&apos; + publics.address() + &apos;&quot;&apos;; }

        where = where.replace(&quot;&amp;&amp;&quot;, &quot;WHERE&quot;);

        privates.connection.query(del + where, function (err, infos) {
            if (err) {
                throw err;
            }

            if (publics.id()) { publics.id(undefined); }
            if (publics.lastname()) { publics.lastname(undefined); }
            if (publics.firstname()) { publics.firstname(undefined); }
            if (publics.email()) { publics.email(undefined); }
            if (publics.birthdate()) { publics.birthdate(undefined); }
            if (typeof publics.gender() === &quot;boolean&quot;) { publics.gender(undefined); }
            if (publics.country()) { publics.country(undefined); }
            if (publics.town()) { publics.town(undefined); }
            if (publics.zipcode()) { publics.zipcode(undefined); }
            if (publics.address()) { publics.address(undefined); }

            if (callback) {
                callback(infos);
            }
        });

        return publics;
    };
}

User.prototype = Object.create(user.prototype);
User.prototype.constructor = User;

module.exports = User;
</code></pre><p>bas&#xE9; sur une classe <code>user</code> partag&#xE9;e entre la partie cliente et serveur <code>models/objects/user.js</code> :</p><pre><code class="lang-js">(function (expose, factory) {
    if (typeof module !== &apos;undefined&apos; &amp;&amp; module.exports) {
        module.exports = factory;
    } else {
        expose.User = factory;
    }
}(this, function User() {
    var privates = {},
        publics = this;

    publics.id = function (id) {
        if (typeof id === &apos;undefined&apos;) {
            return privates.id;
        } else {
            privates.id = id;
            return publics;
        }
    };

    publics.lastname = function (lastname) {
        if (typeof lastname === &apos;undefined&apos;) {
            return privates.lastname;
        } else {
            privates.lastname = lastname;
            return publics;
        }
    };

    publics.firstname = function (firstname) {
        if (typeof firstname === &apos;undefined&apos;) {
            return privates.firstname;
        } else {
            privates.firstname = firstname;
            return publics;
        }
    };

    publics.email = function (email) {
        if (typeof email === &apos;undefined&apos;) {
            return privates.email;
        } else {
            privates.email = email;
            return publics;
        }
    };

    publics.birthdate = function (birthdate) {
        if (typeof birthdate === &apos;undefined&apos;) {
            return privates.birthdate;
        } else {
            privates.birthdate = birthdate;
            return publics;
        }
    };

    publics.gender = function (gender) {
        if (typeof gender === &apos;undefined&apos;) {
            return privates.gender;
        } else {
            privates.gender = gender;
            return publics;
        }
    };

    publics.country = function (country) {
        if (typeof country === &apos;undefined&apos;) {
            return privates.country;
        } else {
            privates.country = country;
            return publics;
        }
    };

    publics.town = function (town) {
        if (typeof town === &apos;undefined&apos;) {
            return privates.town;
        } else {
            privates.town = town;
            return publics;
        }
    };

    publics.zipcode = function (zipcode) {
        if (typeof zipcode === &apos;undefined&apos;) {
            return privates.zipcode;
        } else {
            privates.zipcode = zipcode;
            return publics;
        }
    };

    publics.address = function (address) {
        if (typeof address === &apos;undefined&apos;) {
            return privates.address;
        } else {
            privates.address = address;
            return publics;
        }
    };
}));
</code></pre><p>Avec les fichiers suivant pour afficher la page :</p><p><em>views/index.htm</em></p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot; /&gt;
        &lt;title&gt;&lt;?- common.titleWebsite ?&gt;&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div class=&quot;title&quot;&gt;&lt;?- common.titleWebsite ?&gt;&lt;/div&gt;
        &lt;div&gt;
            &lt;h1&gt;&lt;?- specific.titlePage ?&gt;&lt;/h1&gt;
            &lt;div class=&quot;first&quot;&gt;
                &lt;?- specific.content ?&gt;
                &lt;ul&gt;
                    &lt;li&gt;Id: &lt;strong&gt;&lt;?- user.id() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Lastname: &lt;strong&gt;&lt;?- user.lastname() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Firstname: &lt;strong&gt;&lt;?- user.firstname() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Email: &lt;strong&gt;&lt;?- user.email() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Birthdate: &lt;strong&gt;&lt;?- user.birthdate() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Gender: &lt;strong&gt;&lt;?- user.gender() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Country: &lt;strong&gt;&lt;?- user.country() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Town: &lt;strong&gt;&lt;?- user.town() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Zipcode: &lt;strong&gt;&lt;?- user.zipcode() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Address: &lt;strong&gt;&lt;?- user.address() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                &lt;/ul&gt;
            &lt;/div&gt;
            &lt;div class=&quot;all&quot;&gt;
                &lt;?- specific.contents ?&gt;
                &lt;? for (var i = 0; i &lt; users.length; i++) { ?&gt;
                &lt;ul&gt;
                    &lt;li&gt;Id: &lt;strong&gt;&lt;?- users[i].id() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Lastname: &lt;strong&gt;&lt;?- users[i].lastname() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Firstname: &lt;strong&gt;&lt;?- users[i].firstname() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Email: &lt;strong&gt;&lt;?- users[i].email() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Birthdate: &lt;strong&gt;&lt;?- users[i].birthdate() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Gender: &lt;strong&gt;&lt;?- users[i].gender() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Country: &lt;strong&gt;&lt;?- users[i].country() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Town: &lt;strong&gt;&lt;?- users[i].town() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Zipcode: &lt;strong&gt;&lt;?- users[i].zipcode() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Address: &lt;strong&gt;&lt;?- users[i].address() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                &lt;/ul&gt;
                &lt;? } ?&gt;
            &lt;/div&gt;
            &lt;div class=&quot;last&quot;&gt;
                &lt;?- specific.contentInsert ?&gt;
                &lt;p&gt;insertId: &lt;?- insertId ?&gt;&lt;/p&gt;
                &lt;p&gt;numberUpdate: &lt;?- affectedRows ?&gt;&lt;/p&gt;
                &lt;ul&gt;
                    &lt;li&gt;Id: &lt;strong&gt;&lt;?- user2.id() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Lastname: &lt;strong&gt;&lt;?- user2.lastname() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Firstname: &lt;strong&gt;&lt;?- user2.firstname() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Email: &lt;strong&gt;&lt;?- user2.email() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Birthdate: &lt;strong&gt;&lt;?- user2.birthdate() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Gender: &lt;strong&gt;&lt;?- user2.gender() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Country: &lt;strong&gt;&lt;?- user2.country() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Town: &lt;strong&gt;&lt;?- user2.town() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Zipcode: &lt;strong&gt;&lt;?- user2.zipcode() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Address: &lt;strong&gt;&lt;?- user2.address() ?&gt;&lt;/strong&gt;&lt;/li&gt;
                &lt;/ul&gt;
                &lt;p&gt;numberDelete: &lt;?- deletedRows ?&gt;&lt;/p&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p><em>variations/common.json</em></p><pre><code class="lang-json">{
    &quot;titleWebsite&quot;: &quot;Exemple MySql&quot;,
    &quot;male&quot;: &quot;Homme&quot;,
    &quot;female&quot;: &quot;Femme&quot;
}
</code></pre><p><em>variations/index.json</em></p><pre><code class="lang-json">{
    &quot;titlePage&quot;: &quot;Table User&quot;,
    &quot;content&quot;: &quot;&lt;p&gt;D&#xE9;tail de la premi&#xE8;re entr&#xE9;e.&lt;/p&gt;&quot;,
    &quot;contents&quot;: &quot;&lt;p&gt;D&#xE9;tail de toutes les entr&#xE9;es.&lt;/p&gt;&quot;,
    &quot;contentInsert&quot;: &quot;&lt;p&gt;D&#xE9;tail de l&apos;utilisateur ajout&#xE9; puis modifi&#xE9;.&lt;/p&gt;&quot;
}
</code></pre><p>Vous obtiendrez la sortie suivante :</p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot; /&gt;
        &lt;title&gt;MySql Exemple&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div class=&quot;title&quot;&gt;MySql Exemple&lt;/div&gt;
        &lt;div&gt;
            &lt;h1&gt;Table User&lt;/h1&gt;
            &lt;div class=&quot;first&quot;&gt;
                &lt;p&gt;D&#xE9;tail de la premi&#xE8;re entr&#xE9;e.&lt;/p&gt;
                &lt;ul&gt;
                    &lt;li&gt;Id: &lt;strong&gt;1&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Lastname: &lt;strong&gt;Elric&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Firstname: &lt;strong&gt;Edward&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Email: &lt;strong&gt;edward.elric@fma.br&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Birthdate: &lt;strong&gt;Sun Jan 01 2006 00:00:00 GMT+0100 (Paris, Madrid)&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Gender: &lt;strong&gt;true&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Country: &lt;strong&gt;Amestris&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Town: &lt;strong&gt;Resembool&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Zipcode: &lt;strong&gt;0&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Address: &lt;strong&gt;The Elric&apos;s house&lt;/strong&gt;&lt;/li&gt;
                &lt;/ul&gt;
            &lt;/div&gt;
            &lt;div class=&quot;all&quot;&gt;
                &lt;p&gt;D&#xE9;tail de toutes les entr&#xE9;es.&lt;/p&gt;
                &lt;ul&gt;
                    &lt;li&gt;Id: &lt;strong&gt;1&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Lastname: &lt;strong&gt;Elric&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Firstname: &lt;strong&gt;Edward&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Email: &lt;strong&gt;edward.elric@fma.br&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Birthdate: &lt;strong&gt;Sun Jan 01 2006 00:00:00 GMT+0100 (Paris, Madrid)&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Gender: &lt;strong&gt;true&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Country: &lt;strong&gt;Amestris&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Town: &lt;strong&gt;Resembool&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Zipcode: &lt;strong&gt;0&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Address: &lt;strong&gt;The Elric&apos;s house&lt;/strong&gt;&lt;/li&gt;
                &lt;/ul&gt;
                &lt;ul&gt;
                    &lt;li&gt;Id: &lt;strong&gt;2&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Lastname: &lt;strong&gt;Elric&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Firstname: &lt;strong&gt;Alphonse&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Email: &lt;strong&gt;alphonse.elric@fma.br&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Birthdate: &lt;strong&gt;Tue Jan 01 2008 00:00:00 GMT+0100 (Paris, Madrid)&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Gender: &lt;strong&gt;true&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Country: &lt;strong&gt;Amestris&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Town: &lt;strong&gt;Resembool&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Zipcode: &lt;strong&gt;0&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Address: &lt;strong&gt;The Elric&apos;s house&lt;/strong&gt;&lt;/li&gt;
                &lt;/ul&gt;
            &lt;/div&gt;
            &lt;div class=&quot;last&quot;&gt;
                &lt;p&gt;D&#xE9;tail de l&apos;utilisateur ajout&#xE9; puis modifi&#xE9;.&lt;/p&gt;
                &lt;p&gt;insertId: 3&lt;/p&gt;
                &lt;p&gt;numberUpdate: 1&lt;/p&gt;
                &lt;ul&gt;
                    &lt;li&gt;Id: &lt;strong&gt;3&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Lastname: &lt;strong&gt;Rockbell&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Firstname: &lt;strong&gt;Winry&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Email: &lt;strong&gt;winry.rockbell@fma.br&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Birthdate: &lt;strong&gt;2008-01-01&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Gender: &lt;strong&gt;false&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Country: &lt;strong&gt;Amestris&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Town: &lt;strong&gt;Resembool&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Zipcode: &lt;strong&gt;99999&lt;/strong&gt;&lt;/li&gt;
                    &lt;li&gt;Address: &lt;strong&gt;The Rockbell&apos;s house&lt;/strong&gt;&lt;/li&gt;
                &lt;/ul&gt;
                &lt;p&gt;numberDelete: 1&lt;/p&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><h3 id="utiliser-une-base-de-donnees-mongodb-nosql">Utiliser une base de donn&#xE9;es MongoDB (NoSQL)</h3><p>Nous allons voir &#xE0; pr&#xE9;sent comment utiliser des informations venant d&apos;une base de donn&#xE9;es non sql. Pour cela nous allons utiliser le module npm <code>mongoose</code>. Il va &#xE9;galement nous falloir <a href="https://www.mongodb.com/">installer un serveur MongoDB</a>.</p><p>Donc, depuis le dossier du <code>webconfig.json</code>, utilisez :</p><pre><code class="lang-bash">npm install mongoose
</code></pre><h4 id="base-de-donn-es-mongodb">Base de donn&#xE9;es MongoDB</h4><p>Tout d&apos;abord, nous allons alimenter la base de donn&#xE9;es avec la base <code>demo</code> et la s&#xE9;lectionner :</p><pre><code>use demo
</code></pre><p>puis cr&#xE9;er la collection <code>user</code> :</p><pre><code>db.createCollection(&quot;user&quot;)
</code></pre><p>et la remplir avec un document :</p><pre><code>db.user.insert({
    email: &quot;john.doe@unknown.com&quot;,
    identity: {
        lastname: &quot;Doe&quot;,
        firstname: &quot;John&quot;,
        gender: true,
        birthdate : new Date(&quot;1970/01/01&quot;)
    },
    location: {
        country: &quot;Unknown&quot;,
        town: &quot;Unknown&quot;,
        zipcode: &quot;00000&quot;,
        address: &quot;42 unknown&quot;
    }
})
</code></pre><h4 id="fichiers-nodeatlas">Fichiers NodeAtlas</h4><p>Avec le jeu de fichier suivant :</p><pre><code>&#x251C;&#x2500; controllers/
&#x2502;  &#x251C;&#x2500; common.js
&#x2502;  &#x2514;&#x2500; index.js
&#x251C;&#x2500; models/
&#x2502;  &#x2514;&#x2500; user.js
&#x251C;&#x2500; views/
&#x2502;  &#x2514;&#x2500; index.htm
&#x251C;&#x2500; variations/
&#x2502;  &#x251C;&#x2500; common.json
&#x2502;  &#x2514;&#x2500; index.json
&#x2514;&#x2500; webconfig.json
</code></pre><p>Nous allons utiliser le <code>webconfig.json</code> suivant avec une variable custom <code>_mongodbConfig</code> qui contiendra toutes les informations pour se connecter &#xE0; la base de donn&#xE9;es :</p><pre><code class="lang-json">{
    &quot;controller&quot;: &quot;common.js&quot;,
    &quot;variation&quot;: &quot;common.json&quot;,
    &quot;statics&quot;: {
        &quot;/models&quot;: &quot;models&quot;
    },
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;,
            &quot;variation&quot;: &quot;index.json&quot;,
            &quot;controller&quot;: &quot;index.js&quot;
        }
    },
    &quot;_mongodbConfig&quot;: {
        &quot;host&quot;: &quot;localhost&quot;,
        &quot;port&quot;: &quot;27017&quot;,
        &quot;database&quot;: &quot;demo&quot;
    }
}
</code></pre><p>Avec les fichiers suivant pour afficher la page :</p><p><em>views/index.htm</em></p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;&lt;?- languageCode ?&gt;&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot; /&gt;
        &lt;title&gt;&lt;?- common.titleWebsite ?&gt;&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div class=&quot;title&quot;&gt;&lt;?- common.titleWebsite ?&gt;&lt;/div&gt;
        &lt;div&gt;
            &lt;h1&gt;&lt;?- specific.titlePage ?&gt;&lt;/h1&gt;
            &lt;?- specific.content ?&gt;
            &lt;ul&gt;
                &lt;li&gt;Id: &lt;strong&gt;&lt;?- id ?&gt;&lt;/strong&gt;&lt;/li&gt;
                &lt;li&gt;Lastname: &lt;strong&gt;&lt;?- lastname ?&gt;&lt;/strong&gt;&lt;/li&gt;
                &lt;li&gt;Firstname: &lt;strong&gt;&lt;?- firstname ?&gt;&lt;/strong&gt;&lt;/li&gt;
                &lt;li&gt;Email: &lt;strong&gt;&lt;?- email ?&gt;&lt;/strong&gt;&lt;/li&gt;
                &lt;li&gt;Birthdate: &lt;strong&gt;&lt;?- birthdate ?&gt;&lt;/strong&gt;&lt;/li&gt;
                &lt;li&gt;Gender: &lt;strong&gt;&lt;?- gender ?&gt;&lt;/strong&gt;&lt;/li&gt;
                &lt;li&gt;Country: &lt;strong&gt;&lt;?- country ?&gt;&lt;/strong&gt;&lt;/li&gt;
                &lt;li&gt;Town: &lt;strong&gt;&lt;?- town ?&gt;&lt;/strong&gt;&lt;/li&gt;
                &lt;li&gt;Zipcode: &lt;strong&gt;&lt;?- zipcode ?&gt;&lt;/strong&gt;&lt;/li&gt;
                &lt;li&gt;Address: &lt;strong&gt;&lt;?- address ?&gt;&lt;/strong&gt;&lt;/li&gt;
            &lt;/ul&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p><em>variations/common.json</em></p><pre><code class="lang-json">{
    &quot;titleWebsite&quot;: &quot;MongoDB Exemple&quot;,
    &quot;male&quot;: &quot;Homme&quot;,
    &quot;female&quot;: &quot;Femme&quot;
}
</code></pre><p><em>variations/index.json</em></p><pre><code class="lang-json">{
    &quot;titlePage&quot;: &quot;Collection User&quot;,
    &quot;content&quot;: &quot;&lt;p&gt;D&#xE9;tail du document `{ \&quot;identity.firstname\&quot;: \&quot;John\&quot; }`.&lt;/p&gt;&quot;
}
</code></pre><p>Enfin nous allons nous connecter &#xE0; la base de donn&#xE9;es avec le contr&#xF4;leur globale <code>controllers/common.js</code> :</p><pre><code class="lang-js">exports.setModules = function () {
    var NA = this,
        path = NA.modules.path;

    NA.modules.mongoose = require(&apos;mongoose&apos;);
    NA.models = {};
    NA.models.User = require(&apos;../models/user.js&apos;);
};

exports.setConfigurations = function (next) {
    var NA = this,
        mongoose = NA.modules.mongoose,
        config = NA.webconfig._mongodbConfig;

    mongoose.Promise = global.Promise;
    mongoose.model(&quot;user&quot;, NA.models.User, &quot;user&quot;);
    mongoose.connect(&quot;mongodb://&quot; + config.host + &quot;:&quot; + config.port + &quot;/&quot; + config.database, function (error) {
        next();
    });
};
</code></pre><p>Et afficher les r&#xE9;sultats via le contr&#xF4;leur sp&#xE9;cifique <code>controllers/index.js</code> :</p><pre><code class="lang-js">exports.changeVariations = function (next, locals) {
    var NA = this,
        mongoose = NA.modules.mongoose,
        User = mongoose.model(&apos;user&apos;);

    User
    .findOne({ &quot;identity.firstname&quot;: &quot;John&quot; })
    .exec(function (err, user) {

        locals.id = user._id;
        locals.lastname = user.identity.lastname;
        locals.firstname = user.identity.firstname;
        locals.birthdate = user.identity.birthdate;
        locals.email = user.email;
        locals.gender = (user.identity.gender) ? locals.common.male : locals.common.female;
        locals.country = user.location.country;
        locals.town = user.location.town;
        locals.zipcode = user.location.zipcode;
        locals.address = user.location.address;

        next();
    });
};
</code></pre><p>en utilisant sur une classe <code>user</code> partag&#xE9;e entre la partie cliente et la partie serveur <code>models/user.js</code> :</p><pre><code class="lang-js">var mongoose;
if (typeof module !== &apos;undefined&apos; &amp;&amp; module.exports) {
     mongoose = require(&apos;mongoose&apos;);
}

(function (expose, factory) {
    if (mongoose) {
        module.exports = factory;
    } else {
        expose.User = factory;
    }
}(this, new mongoose.Schema({
    _id: mongoose.Schema.Types.ObjectId,
    email: { type : String, match: /^\S+@\S+$/ },
    identity: {
        lastname: String,
        firstname: String,
        gender: Boolean,
        birthdate : { type : Date, default : Date.now }
    },
    location: {
        country: String,
        town: String,
        zipcode: String,
        address: String
    }
})));
</code></pre><p>Vous obtiendrez la sortie suivante :</p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot; /&gt;
        &lt;title&gt;Exemple MongoDB&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div class=&quot;title&quot;&gt;Exemple MongoDB&lt;/div&gt;
        &lt;div&gt;
            &lt;h1&gt;Collection User&lt;/h1&gt;
            &lt;p&gt;D&#xE9;tail de l&apos;entr&#xE9;e `{ &quot;identity.firstname&quot;: &quot;John&quot; }`.&lt;/p&gt;
            &lt;ul&gt;
                &lt;li&gt;Id: &lt;strong&gt;5804d4d530788ee2e52ea1c7&lt;/strong&gt;&lt;/li&gt;
                &lt;li&gt;Lastname: &lt;strong&gt;Doe&lt;/strong&gt;&lt;/li&gt;
                &lt;li&gt;Firstname: &lt;strong&gt;John&lt;/strong&gt;&lt;/li&gt;
                &lt;li&gt;Email: &lt;strong&gt;john.doe@unknown.com&lt;/strong&gt;&lt;/li&gt;
                &lt;li&gt;Birthdate: &lt;strong&gt;Mon Jan 01 1970 00:00:00 GMT+0200 (Paris, Madrid (heure d&#x2019;&#xE9;t&#xE9;))&lt;/strong&gt;&lt;/li&gt;
                &lt;li&gt;Gender: &lt;strong&gt;Homme&lt;/strong&gt;&lt;/li&gt;
                &lt;li&gt;Country: &lt;strong&gt;Unknown&lt;/strong&gt;&lt;/li&gt;
                &lt;li&gt;Town: &lt;strong&gt;Unknown&lt;/strong&gt;&lt;/li&gt;
                &lt;li&gt;Zipcode: &lt;strong&gt;00000&lt;/strong&gt;&lt;/li&gt;
                &lt;li&gt;Address: &lt;strong&gt;42 unknown&lt;/strong&gt;&lt;/li&gt;
            &lt;/ul&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><h3 id="utiliser-des-middlewares-depuis-express">Utiliser des middlewares depuis Express</h3><p>NodeAtlas repose en partie sur le module npm <a href="http://expressjs.com/">Express.js</a>. Vous pouvez acc&#xE9;der &#xE0; l&apos;objet Express d&apos;une instance NodeAtlas par l&apos;interm&#xE9;diaire de <code>NA#express</code>. Cela vous permet d&apos;ajouter des middlewares Express de la m&#xEA;me mani&#xE8;re que vous l&apos;auriez fait avec Express seul.</p><p>En ce qui concerne la pr&#xE9;-configuration d&apos;Express avec un webconfig vide, elle est faites ainsi :</p><pre><code class="lang-js">NA.express.set(&quot;strict routing&quot;, true);
/* ... */
NA.express.set(&quot;x-powered-by&quot;, false);
/* ... */
/* Activation de gzip, deflate et cie. */
NA.express.use(compress());
/* ... */
/* Parse le type d&apos;encryption &quot;x-www-form-urlencoded&quot;. */
NA.express.use(bodyParser.urlencoded({ extended: true }));
/* ... */
/* Parse le type d&apos;encryption &quot;application/json&quot;. */
NA.express.use(bodyParser.json());
/* ... */
/* Parse les cookies. */
NA.express.use(cookieParser());
/* ... */
/* G&#xE9;re les cookies de session. */
NA.express.use(session(optionSession));
/* ... */
/* G&#xE9;re de dossier `assets/` et son acc&#xE8;s depuis le domain root ou un sous-dossier. */
NA.express.use(NA.webconfig.urlRelativeSubPath, express.static(path.join(NA.serverPath, NA.webconfig.assetsRelativePath), staticOptions));
</code></pre><p>Vous pouvez vous m&#xEA;me ajouter des middlewares de plusieurs mani&#xE8;re.</p><h4 id="avec-setconfigurations-">Avec <code>setConfigurations</code></h4><p>Vous pouvez obtenir l&apos;objet <code>NA#express</code> pr&#xE8;s &#xE0; accueillir des middlewares ici dans le point d&apos;ancrage <code>setConfigurations</code>. Cela ajoutera les m&#xE9;canismes &#xE0; toutes les routes de votre site.</p><pre><code class="lang-js">exports.setConfigurations = function (next) {
    var NA = this;

    // Middleware fait main.
    NA.express.use(function (request, response, next) {
        response.setHeader(&quot;X-Frame-Options&quot;, &quot;ALLOW-FROM http://www.lesieur.name/&quot;);
        next();
    });

    // Middleware ajoutant diverse ent&#xEA;te http de s&#xE9;curisation.
    NA.express.use(require(&quot;helmet&quot;)());

    next();
};
</code></pre><h4 id="avec-le-param-tre-middlewares-des-routes">Avec le param&#xE8;tre <code>middlewares</code> des Routes</h4><p>Il est &#xE9;galement possible de d&#xE9;livrer ses middlewares uniquement pour une seule route. Dans ce cas vous pouvez utilisez le param&#xE8;tre <code>middlewares</code> comme suit :</p><p><strong>webconfig.json</strong></p><pre><code class="lang-js">{
    &quot;middlewaresRelativePath&quot;: &quot;middlewares&quot;,
    &quot;routes&quot;: {
        &quot;/upload-file&quot;: {
            &quot;view&quot;: &quot;upload.htm&quot;,
            &quot;controller&quot;: &quot;upload.js&quot;,
            &quot;middlewares&quot;: &quot;upload.js&quot;
        }
    }
    &quot;_jwt&quot;: {
        secret: &quot;AUTH_CLIENT_SECRET&quot;,
        audience: &quot;AUTH_CLIENT_ID&quot;
    }
}
</code></pre><p>et utiliser le fichier suivant pour autoriser l&apos;envoi de donn&#xE9;e POST encrypt&#xE9; en &quot;multipart/data-form&quot; uniquement si vous &#xEA;tes authentifi&#xE9; par un token JSON :</p><p><strong>middlewares/upload.js</strong></p><pre><code class="lang-js">var multer  = require(&quot;multer&quot;),
    jwt = require(&quot;express-jwt&quot;);

module.exports = function () {
    var NA = this,
        path = NA.modules.path,
        upload = multer({ dest: path.join(NA.serverPath, &quot;uploads&quot;) });

    return [
        jwt({
            secret: NA.webconfig._jwt.secret,
            audience: NA.webconfig._jwt.audience
        }),
        upload.single(&quot;avatar&quot;),
    ];
};
</code></pre><p><em>Note : Si</em> <code>middlewaresRelativePath</code> <em>n&apos;est pas pr&#xE9;sent dans &#xAB; webconfig.json &#xBB;, par d&#xE9;faut le dossier des contr&#xF4;leurs est bien</em> <code>middlewares</code>. <code>middlewaresRelativePath</code> <em>est donc utile seulement pour changer le nom/chemin du r&#xE9;pertoire.</em></p><h4 id="avec-le-param-tre-middlewares-en-global">Avec le param&#xE8;tre <code>middlewares</code> en Global</h4><p>Il est &#xE9;galement possible d&apos;utiliser ce syst&#xE8;me pour toutes les routes, ainsi le webconfig se pr&#xE9;senterait plut&#xF4;t ainsi :</p><p><strong>webconfig.json</strong></p><pre><code class="lang-js">{
    &quot;middlewares&quot;: &quot;is-authenticated.js&quot;
    &quot;routes&quot;: {
        &quot;/upload-file&quot;: {
            &quot;view&quot;: &quot;upload.htm&quot;,
            &quot;controller&quot;: &quot;upload.js&quot;
        }
    }
    &quot;_jwt&quot;: {
        secret: &quot;AUTH_CLIENT_SECRET&quot;,
        audience: &quot;AUTH_CLIENT_ID&quot;
    }
}
</code></pre><p>Avec le fichier :</p><p><strong>middlewares/is-authenticated.js</strong></p><pre><code class="lang-js">var jwt = require(&quot;express-jwt&quot;);

module.exports = function () {
    var NA = this;

    return [
        jwt({
            secret: NA.webconfig._jwt.secret,
            audience: NA.webconfig._jwt.audience
        })
    ];
};
</code></pre><h4 id="tableau-de-middlewares-">Tableau de <code>middlewares</code></h4><p>Vous pouvez &#xE9;galement fournir un tableau vers une liste de fichier de middleware Express que ce soit pour chaque route ou en global :</p><p><strong>webconfig.json</strong></p><pre><code class="lang-js">{
    &quot;routes&quot;: {
        &quot;/upload-file&quot;: {
            &quot;view&quot;: &quot;upload.htm&quot;,
            &quot;controller&quot;: &quot;upload.js&quot;,
            &quot;middlewares&quot;: [&quot;is-authenticated.js&quot;, &quot;redirect.js&quot;]
        }
    }
    &quot;_jwt&quot;: {
        secret: &quot;AUTH_CLIENT_SECRET&quot;,
        audience: &quot;AUTH_CLIENT_ID&quot;
    }
}
</code></pre><p>Avec l&apos;utilisation de l&apos;objet NA :</p><p><strong>middlewares/is-authenticated.js</strong></p><pre><code class="lang-js">var jwt = require(&quot;express-jwt&quot;);

module.exports = function () {
    var NA = this;

    return [jwt({
        secret: NA.webconfig._jwt.secret,
        audience: NA.webconfig._jwt.audience
    })];
};
</code></pre><p>o&#xF9; sans :</p><p><strong>middlewares/redirect.js</strong></p><pre><code class="lang-js">module.exports = function (request, response, next) {

    response.redirect(&apos;https://go.to.visitor.page/&apos;);

    next();
};
</code></pre><h3 id="creer-une-application-isomorphique">Cr&#xE9;er une application isomorphique</h3><p>Une application isomorphique est une application dont le code JavaScript est en grande partie le m&#xEA;me qu&apos;il soit ex&#xE9;cut&#xE9; c&#xF4;t&#xE9; client ou ex&#xE9;cut&#xE9; c&#xF4;t&#xE9; serveur. NodeAtlas propose un exemple d&apos;application isomorphique dans son template d&#xE9;di&#xE9; &#xE0; <a href="https://fr.vuejs.org/">Vue.js</a>.</p><p>Pour tester cela il vous suffit :</p><p>de cr&#xE9;er un dossier de test</p><pre><code class="lang-bash">mkdir hello-vue
cd hello-vue
</code></pre><p>d&apos;y placer les fichier de <code>hello-vue</code></p><pre><code class="lang-bash">node-atlas --create hello-vue
</code></pre><p>d&apos;installer les d&#xE9;pendances</p><pre><code class="lang-bash">npm install
</code></pre><p>et de lancer le site en fran&#xE7;ais</p><pre><code class="lang-bash">node-atlas --browse
</code></pre><p>ou en version internationale</p><pre><code class="lang-bash">node-atlas --browse --webconfig webconfig.en-us.json
</code></pre><p>Vous trouverrez tout ce qu&apos;il faut pour appr&#xE9;hender la partie serveur du <code>constrollers/common.js</code> sur <a href="https://ssr.vuejs.org/">https://ssr.vuejs.org/</a> et seul la partie cliente du <code>assets/javascripts/common.js</code> sur <a href="https://vuejs.org/">https://vuejs.org/</a>.</p><div><div class="before">
							<a href="partie-vue-et-template.html">&#x25C4; Partie vue et template</a>
						</div><div class="after">
							<a href="pour-aller-plus-loin.html">Pour aller plus loin &#x25BA;</a>
						</div></div>
				</div>
			</div>
		</div>
		<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>
		
		<script id="channel" data-channel="NodeAtlas/Aide" data-label="Chat d&apos;Aide" src="javascripts/common.min.js"></script>
		
		<script src="https://buttons.github.io/buttons.js"></script>
	
</body></html>