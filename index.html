<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>NodeAtlas by Haeresis</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>NodeAtlas</h1>
        <p>NodeAtlas is a MVC2 Javascript Framework Front-end-oriented, SEO and W3C compliant.</p>

        <p class="view"><a href="https://github.com/Haeresis/NodeAtlas">View the Project on GitHub <small>Haeresis/NodeAtlas</small></a></p>


        <ul>
          <li><a href="https://github.com/Haeresis/NodeAtlas/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/Haeresis/NodeAtlas/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/Haeresis/NodeAtlas">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="node-atlas" class="anchor" href="#node-atlas" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>node-atlas</h1>

<p><a href="https://www.paypal.me/BrunoLesieur/5"><img src="https://img.shields.io/badge/donate-%3C3-ddddff.svg" alt="Donate"></a> <a href="https://travis-ci.org/Haeresis/NodeAtlas/"><img src="https://travis-ci.org/Haeresis/NodeAtlas.svg" alt="Travis CI"></a> <a href="https://github.com/Haeresis/NodeAtlas"><img src="https://img.shields.io/badge/version-1.2-brightgreen.svg" alt="Version 1.2"></a> <a href="https://www.npmjs.com/package/node-atlas"><img src="https://badge.fury.io/js/node-atlas.svg" alt="Package NPM"></a> <a href="https://nodejs.org/en/"><img src="https://img.shields.io/badge/nodejs-0.10%2C_5.10-brightgreen.svg" alt="Node.js"></a> <a href="http://docs.sonarqube.org/display/PLUG/JavaScript+Plugin"><img src="https://img.shields.io/badge/debt_ratio-0%25-brightgreen.svg" alt="Technical Debt Ratio"></a> <a href="https://gemnasium.com/Haeresis/NodeAtlas"><img src="https://gemnasium.com/Haeresis/NodeAtlas.svg" alt="Dependency Status"></a></p>

<p><strong>Vous êtes français ? Le README <a href="https://github.com/Haeresis/NodeAtlas">derrière ce lien</a> vous sera peut-être plus agréable.</strong></p>

<h2>
<a id="overview" class="anchor" href="#overview" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Overview</h2>

<h3>
<a id="for-what-" class="anchor" href="#for-what-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>For What ?</h3>

<p>NodeAtlas is a JavaScript Framework as an <a href="https://www.npmjs.com/package/node-atlas">npm module</a> (<a href="https://www.npmjs.com/package/node-atlas">node-atlas</a>) and designed to run on all <a href="https://nodejs.org/en/">Node.js</a> verision. NodeAtlas allows you to :</p>

<ul>
<li><p>Create, maintain and document a set of assets HTML/CSS/JavaScript as user interfaces to provide solid Guidelines for the realization of website or webapp (i.e. for brands).</p></li>
<li><p>Create and maintain and run internationalized wesites without use a single JavaScript file. That's it's perfect for beginners or for develop presentational website with high performance quickly.</p></li>
<li><p>Develop Node.js internationalized websites or scalable <a href="https://nodejs.org/en/">Node.js</a> applications running of all sizes with server-based source code for high performance, indexability and W3C compliancy.</p></li>
</ul>

<h3>
<a id="why-nodeatlas" class="anchor" href="#why-nodeatlas" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Why NodeAtlas</h3>

<p>NodeAtlas is designed to create scalable websites and to allow Front-end and Back-end developers to embrace <a href="https://nodejs.org/en/">Node.js</a>.</p>

<p>Starting with a single HTML page,</p>

<ul>
<li>then internationalize it,</li>
<li>then create other pages,</li>
<li>then minify/obfuscate/optimized your sources,</li>
<li>then use Less (or Stylus soon),</li>
<li>then use files for drive back-end part with code,</li>
<li>then connect you to <a href="https://www.mysql.fr/">MySQL</a>, <a href="https://www.mongodb.org/">MongoDB</a>, <a href="https://www.elastic.co/">ElasticSearch</a>...,</li>
<li>then use <a href="http://socket.io/">Socket.io</a> for real time,</li>
<li>then be component-based with <a href="https://github.com/Haeresis/ComponentAtlas">ComponentAtlas</a>
</li>
<li>then let your customer edit website itself with <a href="https://github.com/Haeresis/EditAtlas">EditAtlas</a>
</li>
<li>then create plugins,</li>
<li>then...</li>
</ul>

<h3>
<a id="and-what-about-others-javascript-frameworks-" class="anchor" href="#and-what-about-others-javascript-frameworks-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>And what about others JavaScript Frameworks ?</h3>

<p>In opposition to others JavaScript Frameworks like AngularJS 2 or Aurelia.io, NodeAtlas run server-side and provide some real url. Websites are indexale and W3C compliant that means each page are construct by HTTP response and after by websocket mechanisms. So, NodeAtlas is not an alternative to others Front-end JavaScript Frameworks that only use <a href="https://nodejs.org/en/">Node.js</a> for use after <a href="https://www.npmjs.com/">npm</a>, <a href="http://jspm.io/">jspm</a> or <a href="http://gulpjs.com/">gulp</a>. And that means NodeAtlas is a substituant to PHP, JAVA or C# server-side. In the same way as <a href="https://www.meteor.com/">Meteor.js</a>, NodeAtlas allow you to set your working environment and you have not need of <a href="http://gulpjs.com/">gulp</a> but to oposition of <a href="https://www.meteor.com/">Meteor.js</a>, the <code>NA</code> object is not provided client-side. It's your responsability to spread server-side mechanism to front.</p>

<h3>
<a id="examples-of-websites-with-nodeatlas" class="anchor" href="#examples-of-websites-with-nodeatlas" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Examples of websites with NodeAtlas</h3>

<p>This is a list of repository you could analyse to understand NodeAtlas:</p>

<ul>
<li>
<a href="https://github.com/Haeresis/ResumeAtlas/">Generation and HTML template maintenance</a>.</li>
<li>
<a href="https://github.com/Haeresis/ResumeAtlas/">HTML website maintenance (no Back-end)</a>.</li>
<li>
<a href="https://github.com/Haeresis/BookAtlas/">Node.js website with Websocket and PopState</a>.</li>
<li>
<a href="https://github.com/Haeresis/BlogAtlas/">Node.js website with MongoDB database and Redis</a>.</li>
<li>
<a href="https://github.com/Haeresis/EditAtlas/">Node.js example of content filling in real time without Back-office</a>.</li>
<li>
<a href="https://github.com/Haeresis/SimpleAtlas/">Simple web server for a file</a>.</li>
<li>
<a href="https://github.com/Haeresis/LessAtlas/">CSS-driven usage with Less preprocessor with CSS Framework</a>.</li>
<li>
<a href="https://github.com/Haeresis/ComponentAtlas/">Plugin to boost standard capabilities</a>.</li>
</ul>

<h3>
<a id="table-of-contents" class="anchor" href="#table-of-contents" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Table of Contents</h3>

<ul>
<li>
<a href="#overview">Overview</a>

<ul>
<li><a href="#examples-of-websites-with-nodeatlas">Examples of websites with NodeAtlas</a></li>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#documentation">Documentation</a></li>
<li><a href="#contributing">Contributing</a></li>
</ul>
</li>
<li><a href="#installation">Installation</a></li>
<li>
<a href="#start-with-nodeatlas">Start with NodeAtlas</a>

<ul>
<li><a href="#fileset">Fileset</a></li>
<li><a href="#minimum-requirements">Minimum Requirements</a></li>
<li><a href="#run-the-site-with-nodeatlas">Run the site with NodeAtlas</a></li>
</ul>
</li>
<li>
<a href="#different-configurations-of-webconfig.json">Different configurations of webconfig.json</a>

<ul>
<li><a href="#more-one-page">More one page</a></li>
<li><a href="#template-shortcut">Template shortcut</a></li>
<li><a href="#host-images-fonts-css-js-etc">Host images, fonts, CSS, JS, etc.</a></li>
<li><a href="#manage-inclusions-to-avoid-redundancy-code">Manage inclusions to avoid redundancy code</a></li>
<li><a href="#manage-variations-within-the-same-template">Manage variations within the same template</a></li>
<li><a href="#manage-multilingual">Manage Multilingual</a></li>
<li><a href="#nodeatlas-use-to-generate-html-assets">NodeAtlas use to generate HTML assets</a></li>
<li><a href="#use-nodeatlas-to-run-a-website-back-end-part">Use NodeAtlas to run a website (Back-end Part)</a></li>
<li><a href="#generate-partial-page-with-ajaxwebsocket">Generate partial page with AJAX/Websocket</a></li>
<li><a href="#change-the-url-parameters">Change the url parameters</a></li>
<li><a href="#create-your-own-webconfig-variables">Create your own webconfig variables</a></li>
<li><a href="#manage-routing-url-rewriting">Manage routing (URL Rewriting)</a></li>
<li><a href="#manage-a-page-not-found">Manage a page not found</a></li>
<li><a href="#manage-redirects">Manage redirects</a></li>
<li><a href="#run-website-with-https">Run Website with HTTPs</a></li>
<li><a href="#minify-cssjs">Minify CSS/JS</a></li>
<li><a href="#css-generation-with-less">CSS generation with Less</a></li>
<li><a href="#optimize-images-files">Optimize Images files</a></li>
<li><a href="#css-inline-injection-for-manage-email-assets">CSS Inline Injection for Manage Email Assets</a></li>
<li><a href="#allowdisallow-getpost-requests">Allow/Disallow GET/POST requests</a></li>
<li><a href="#change-settings-of-sessions">Change settings of Sessions</a></li>
<li><a href="#external-storage-sessions">External Storage Sessions</a></li>
<li><a href="#Changing-the-template-engine-brackets--">Changing the template engine brackets &lt;% %&gt;</a></li>
<li><a href="#change-the-url-hostname-and-listening-port">Change the url hostname and listening port</a></li>
<li><a href="#generate-urls-dynamically">Generate urls dynamically</a></li>
</ul>
</li>
<li>
<a href="#cli--running-commands">CLI / Running commands</a>

<ul>
<li><a href="#--directory-">--directory</a></li>
<li><a href="#--webconfig-">--webconfig</a></li>
<li><a href="#--browse-subpath">--browse</a></li>
<li><a href="#--httpport-">--httpPort</a></li>
<li><a href="#--generate">--generate</a></li>
</ul>
</li>
<li><a href="#api--nodeatlas-as-npm-module">API / NodeAtlas as npm module</a></li>
<li><a href="#nodeatlas-as-a-simple-web-server">NodeAtlas as a simple web server</a></li>
<li>
<a href="#running-nodeatlas-on-online-server">Running NodeAtlas on online server</a>

<ul>
<li><a href="#in-a-windows-server-environment-with-iisnode">In a Windows Server environment with iisnode</a></li>
<li><a href="#in-a-unix-environment-with-forever">In a Unix environment with forever</a></li>
<li><a href="#in-a-unix-environment-with-nginx">In a Unix environment with Nginx</a></li>
<li><a href="#proxy">Proxy</a></li>
</ul>
</li>
<li><a href="#a-propos-de-l-architecture-de-nodeatlas">About architecture NodeAtlas</a></li>
</ul>

<h3>
<a id="documentation" class="anchor" href="#documentation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Documentation</h3>

<p>In addition to this README, you also have access to,</p>

<ul>
<li>
<a href="https://www.npmjs.com/package/node-atlas">tl;dr</a> and,</li>
<li>
<a href="http://haeresis.github.io/NodeAtlas/doc/index.html">details of functions in the NA object</a>.</li>
</ul>

<h3>
<a id="contributing" class="anchor" href="#contributing" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Contributing</h3>

<p>If you would like to contribute with:</p>

<ul>
<li>Code enhancements and fixes,</li>
<li>French correct spelling mistake or</li>
<li>Decent english translation</li>
</ul>

<p>Please do the following:</p>

<ol>
<li>Fork the NodeAtlas repository.</li>
<li>Hack on a separate topic branch created from the latest master.</li>
<li>Commit and push the topic branch.</li>
<li>Make a pull request.</li>
<li>Be patient. ;-)</li>
</ol>

<p>Please note that modications should follow these coding guidelines:</p>

<ul>
<li>Pass Sonarqube JS with 0% Technical Debt Ratio.</li>
</ul>

<p>Thank you for helping out!</p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h2>

<p><em>Before install NodeAtlas, install <a href="https://nodejs.org/en/">Node.js</a> and <a href="https://www.python.org/download/releases/2.7/">Python 2.7</a> as pre-require.</em></p>

<p>There are several ways to install NodeAtlas:</p>

<ul>
<li>
<p>Download NodeAtlas from the official repository <a href="https://haeresis.github.com/NodeAtlas">NodeAtlas</a>.</p>

<p><em>Once downloaded, unzip <strong>NodeAtlas</strong> in the folder that will suit you.</em></p>

<p><strong>Start at least once NodeAtlas with the command line <code>\&gt; node &lt;/path/to/&gt;node-atlas/node-atlas.js</code>, to install the <em>node_modules</em>.</strong></p>
</li>
<li>
<p><code>npm install node-atlas</code> (recommended for <a href="#api--nodeatlas-as-npm-module">use as a module</a> in a project).</p>

<p><em>This will install <strong>NodeAtlas</strong> in the <code>node_modules/node-atlas</code> directory of the execution of the command.</em></p>
</li>
<li>
<p><code>npm install -g node-atlas</code> (recommended for <a href="#api--nodeatlas-as-npm-module">use as a module</a> in large amount of project or for <a href="#cli--running-commands">a command line utilisation</a>).</p>

<p><em>This will install <strong>NodeAtlas</strong> in the global <code>node_modules/node-atlas</code>.</em></p>
</li>
<li>
<p>Clone the directory from <a href="https://github.com/Haeresis/NodeAtlas/">GitHub</a> (recommended for).</p>

<p><em>This will install <strong>NodeAtlas</strong> in cloning home folder.</em></p>

<p><strong>Start at least once NodeAtlas the with the command line <code>\&gt; node &lt;/path/to/&gt;node-atlas/node-atlas.js</code>, to install the <em>node_modules</em>.</strong></p>
</li>
</ul>

<h2>
<a id="start-with-nodeatlas" class="anchor" href="#start-with-nodeatlas" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Start with NodeAtlas</h2>

<h3>
<a id="fileset" class="anchor" href="#fileset" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Fileset</h3>

<p>After installing NodeAtlas somewhere on your machine, you create a set of files representing a site anywhere else like structure below.</p>

<pre><code>site-hello-world/
— templates/
—— index.htm
— webconfig.json
</code></pre>

<p>Here is the "/site-hello-world/templates/index.htm" file:</p>

<div class="highlight highlight-text-html-basic"><pre>&lt;!DOCTYPE html&gt;
&lt;<span class="pl-ent">html</span> <span class="pl-e">lang</span>=<span class="pl-s"><span class="pl-pds">"</span>fr-fr<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">head</span>&gt;
        &lt;<span class="pl-ent">meta</span> <span class="pl-e">charset</span>=<span class="pl-s"><span class="pl-pds">"</span>utf-8<span class="pl-pds">"</span></span> /&gt;
        &lt;<span class="pl-ent">title</span>&gt;Hello world&lt;/<span class="pl-ent">title</span>&gt;
    &lt;/<span class="pl-ent">head</span>&gt;
    &lt;<span class="pl-ent">body</span>&gt;
        &lt;<span class="pl-ent">div</span>&gt;This is a Hello World!&lt;/<span class="pl-ent">div</span>&gt;
    &lt;/<span class="pl-ent">body</span>&gt;
&lt;/<span class="pl-ent">html</span>&gt;</pre></div>

<p>and following, the "/site-hello-world/webconfig.json" file.</p>

<h3>
<a id="minimum-requirements" class="anchor" href="#minimum-requirements" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Minimum Requirements</h3>

<p>You can turn a simple page with minimal configuration "webconfig.json" below</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>equivalent to</p>

<div class="highlight highlight-source-js"><pre>{ <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> { <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span> } }</pre></div>

<h3>
<a id="run-the-site-with-nodeatlas" class="anchor" href="#run-the-site-with-nodeatlas" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Run the site with NodeAtlas</h3>

<h4>
<a id="with-a-command-line" class="anchor" href="#with-a-command-line" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>With a command line</h4>

<p>Position yourself with the prompt console in the folder "/Site-hello-world/" and run the following command.</p>

<pre><code>\&gt; node &lt;/path/to/&gt;node-atlas/node-atlas.js
</code></pre>

<p>In your first run, NodeAtlas install all the "node_modules" necessary for running (if you downloaded out of npm).</p>

<p>Rerun.</p>

<pre><code>\&gt; node &lt;/path/to/&gt;node-atlas/node-atlas.js
</code></pre>

<p>You will have access to your "Hello World" to the page: <em>http://localhost/</em> in a browser.</p>

<h4>
<a id="with-an-executable-on-your-os" class="anchor" href="#with-an-executable-on-your-os" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>With an executable on your OS</h4>

<p><strong>If you have installed NodeAtlas with <code>npm install -g node-atlas</code></strong> you can also use the <code>nodeatlas</code> command. <code>nodeatlas</code> is a shortcut for <code>node &lt;/path/to/&gt;node-atlas/node-atlas.js</code>.</p>

<p>Position yourself with the prompt console in the folder « /site-hello-world/ » and run the following command.</p>

<pre><code>\&gt; nodeatlas
</code></pre>

<p><em>Note : *if the <code>nodeatlas</code> command do not work on unix OS after installation, it's probably because of right problem. If you are root, the command <code>chown -R root:root /usr/local/bin/</code> before re-execuse <code>npm install -g node-atlas</code> command will fix issue, else, use the command <code>sudo npm install -g node-atlas</code>.</em></p>

<h4>
<a id="via-a-javascript-file" class="anchor" href="#via-a-javascript-file" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Via a JavaScript file</h4>

<p>You can also use NodeAtlas as a npm module.</p>

<p><em>server.js</em></p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> nodeAtlas <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">"</span>node-atlas<span class="pl-pds">"</span></span>);

<span class="pl-en">nodeAtlas</span>().<span class="pl-en">run</span>();</pre></div>

<pre><code>\&gt; node server.js
</code></pre>

<h2>
<a id="different-configurations-of-webconfigjson" class="anchor" href="#different-configurations-of-webconfigjson" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Different configurations of webconfig.json</h2>

<h3>
<a id="more-one-page" class="anchor" href="#more-one-page" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>More one page</h3>

<p>Below is a sample configuration.</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>templatesRelativePath<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>templates<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/member.html<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>member.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>postSupport<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">false</span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/member-without-extension/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>member.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>getSupport<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">false</span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>about.html<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>about.htm<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/error.html<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>error.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>statusCode<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">404</span>,
            <span class="pl-s"><span class="pl-pds">"</span>mimeType<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>text/plain<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>To run this set of file:</p>

<pre><code>templates/
— index.htm
— member.htm
— error.htm
webconfig.json
</code></pre>

<p>with the addresses:</p>

<ul>
<li>
<em>http://localhost/</em> (responds to the root)</li>
<li>
<em>http://localhost/member.html</em> (will not respond if is POST requested)</li>
<li>
<em>http://localhost/member-without-extension/</em> (will not respond if is GET requested)</li>
<li>
<em>http://localhost/error.html</em> (return of the plain-text content (without markup) with a 404)</li>
</ul>

<p><em>Note : If</em> <strong><em>templatesRelativePath</em></strong> <em>is not present in "webconfig.js", template folder is</em> <strong><em>templates</em></strong>. <strong><em>templatesRelativePath</em></strong> <em>is useful only to change the name/path of directory.</em></p>

<h3>
<a id="template-shortcut" class="anchor" href="#template-shortcut" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Template shortcut</h3>

<p>The configuration below is equivalent to the configuration section just above</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>templatesRelativePath<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>templates<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>/member.html<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>member.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>postSupport<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">false</span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/member-without-extension/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>member.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>getSupport<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">false</span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>about.html<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>about.htm<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>/error.html<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>error.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>statusCode<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">404</span>,
            <span class="pl-s"><span class="pl-pds">"</span>mimeType<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>text/plain<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>because</p>

<div class="highlight highlight-source-js"><pre><span class="pl-s"><span class="pl-pds">"</span>about.html<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>about.htm<span class="pl-pds">"</span></span>,</pre></div>

<p>is a shortcut for</p>

<div class="highlight highlight-source-js"><pre><span class="pl-s"><span class="pl-pds">"</span>about.html<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
    <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>about.htm<span class="pl-pds">"</span></span>
}</pre></div>

<p>Obviously this shortcut is used only if <code>template</code> is the only parameter to declare in the route.</p>

<h3>
<a id="host-images-fonts-css-js-etc" class="anchor" href="#host-images-fonts-css-js-etc" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Host images, fonts, CSS, JS, etc.</h3>

<p>You can also host any file on your site in a public folder. For example, with this configuration:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>assetsRelativePath<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>assets<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>and this set of files:</p>

<pre><code>assets/
— stylesheets/
—— common.css
— javascript/
—— common.js
— media/
—— images/
——— logo.png
templates/
— index.htm
webconfig.json
</code></pre>

<p>you will have access to the addresses:</p>

<ul>
<li><em>http://localhost/</em></li>
<li><em>http://localhost/stylesheets/common.css</em></li>
<li><em>http://localhost/javascript/common.js</em></li>
<li><em>http://localhost/media/images/logo.png</em></li>
</ul>

<p><em>Note : If</em> <strong><em>assetsRelativePath</em></strong> <em>is not present in "webconfig.js", default public folder is</em> <strong><em>assets</em></strong>. <strong><em>assetsRelativePath</em></strong> <em>is useful only to change the name/path of directory.</em></p>

<h4>
<a id="maxage-etag-etc" class="anchor" href="#maxage-etag-etc" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>maxAge, Etag, etc.</h4>

<p>It's possible to manage informations provided by NodeAtlas when a ressource is requested (like <code>maxAge</code>, <code>etag</code>, etc.) via the <code>staticOptions</code> property in webconfig. For more informations, see the <a href="http://expressjs.com/api.html#express.static">Express</a> documentation about static files.</p>

<p>For exemple, for a devlopment webconfig, it's interresting to put the <code>maxAge</code> to 0 in order to always get the last modifications into a file and avoid frenetic browser reload.</p>

<pre><code>{
    "staticOptions": {
        "maxAge": 0
    },
    "routes": {
        "/": {
            "template": "index.htm"
        }
    }
}
</code></pre>

<h3>
<a id="manage-inclusions-to-avoid-redundancy-code" class="anchor" href="#manage-inclusions-to-avoid-redundancy-code" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Manage inclusions to avoid redundancy code</h3>

<p>You can segment your HTML codes to not repeat the redundant code such "head" part and "foot" part or any other code fragment:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>componentsRelativePath<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>components<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/list-of-members/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>with the following files:</p>

<pre><code>assets/
— stylesheets/
—— common.css
— javascript/
—— common.js
components/
— head.htm
— foot.htm
templates/
— index.htm
— members.htm
webconfig.json
</code></pre>

<p><em>components/head.htm</em></p>

<div class="highlight highlight-text-html-basic"><pre>&lt;!DOCTYPE html&gt;
&lt;<span class="pl-ent">html</span> <span class="pl-e">lang</span>=<span class="pl-s"><span class="pl-pds">"</span>fr-fr<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">head</span>&gt;
        &lt;<span class="pl-ent">meta</span> <span class="pl-e">charset</span>=<span class="pl-s"><span class="pl-pds">"</span>utf-8<span class="pl-pds">"</span></span> /&gt;
        &lt;<span class="pl-ent">title</span>&gt;Hello world&lt;/<span class="pl-ent">title</span>&gt;

        &lt;<span class="pl-ent">link</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>text/css<span class="pl-pds">"</span></span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>stylesheet<span class="pl-pds">"</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>stylesheets/common.css<span class="pl-pds">"</span></span> <span class="pl-e">media</span>=<span class="pl-s"><span class="pl-pds">"</span>all<span class="pl-pds">"</span></span> /&gt;
    &lt;/<span class="pl-ent">head</span>&gt;
    &lt;<span class="pl-ent">body</span>&gt;</pre></div>

<p><em>components/foot.htm</em></p>

<div class="highlight highlight-text-html-basic"><pre><span class="pl-s1">        &lt;<span class="pl-ent">script</span> <span class="pl-e">async</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>text/javascript<span class="pl-pds">"</span></span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>javascript/common.js<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span>
    &lt;/<span class="pl-ent">body</span>&gt;
&lt;/<span class="pl-ent">html</span>&gt;</pre></div>

<p><em>templates/index.htm</em></p>

<div class="highlight highlight-text-html-basic"><pre>    &lt;%- include('head.htm') %&gt;

    &lt;<span class="pl-ent">div</span>&gt;
        &lt;<span class="pl-ent">h1</span>&gt;Welcome&lt;/<span class="pl-ent">h1</span>&gt;
        &lt;<span class="pl-ent">p</span>&gt;This is the home page.&lt;/<span class="pl-ent">p</span>&gt;
    &lt;/<span class="pl-ent">div</span>&gt;

    &lt;%- include('foot.htm') %&gt;</pre></div>

<p><em>templates/members.htm</em></p>

<div class="highlight highlight-text-html-basic"><pre>    &lt;%- include('head.htm') %&gt;

    &lt;<span class="pl-ent">div</span>&gt;
        &lt;<span class="pl-ent">h1</span>&gt;List of members&lt;/<span class="pl-ent">h1</span>&gt;
        &lt;<span class="pl-ent">p</span>&gt;It is the Members page.&lt;/<span class="pl-ent">p</span>&gt;
    &lt;/<span class="pl-ent">div</span>&gt;

    &lt;%- include('foot.htm') %&gt;</pre></div>

<p>you will have access to the addresses:</p>

<ul>
<li><em>http://localhost/</em></li>
<li><em>http://localhost/list-of-members/</em></li>
</ul>

<p><em>Note : If</em> <strong><em>componentsRelativePath</em></strong> <em>is not present in "webconfig.js", default include folder is</em> <strong><em>components</em></strong>. <strong><em>componentsRelativePath</em></strong> <em>is useful only to change the name/path of directory.</em></p>

<h3>
<a id="manage-variations-within-the-same-template" class="anchor" href="#manage-variations-within-the-same-template" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Manage variations within the same template</h3>

<p>It is possible with the same template and the same includes, generating pages with different content (useful in generation HTML assets mode). Activate the variations with the following configuration:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>commonVariation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>common.json<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>variationsRelativePath<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>variations<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>template.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>variation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.json<span class="pl-pds">"</span></span>,
        },
        <span class="pl-s"><span class="pl-pds">"</span>/list-of-members/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>template.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>variation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.json<span class="pl-pds">"</span></span>,
        }
    }
}</pre></div>

<p>with the following files:</p>

<pre><code>assets/
— stylesheets/
—— common.css
—— home.css
—— members.css
— javascript/
—— common.js
—— home.js
—— members.js
components/
— head.htm
— foot.htm
variations/
— common.json
— index.json
— members.json
templates/
— template.htm
webconfig.json
</code></pre>

<p><em>components/head.htm</em></p>

<div class="highlight highlight-text-html-basic"><pre>&lt;!DOCTYPE html&gt;
&lt;<span class="pl-ent">html</span> <span class="pl-e">lang</span>=<span class="pl-s"><span class="pl-pds">"</span>fr-fr<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">head</span>&gt;
        &lt;<span class="pl-ent">meta</span> <span class="pl-e">charset</span>=<span class="pl-s"><span class="pl-pds">"</span>utf-8<span class="pl-pds">"</span></span> /&gt;
        &lt;<span class="pl-ent">title</span>&gt;&lt;%= specific.titlePage %&gt;&lt;/<span class="pl-ent">title</span>&gt;

        &lt;<span class="pl-ent">link</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>text/css<span class="pl-pds">"</span></span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>stylesheet<span class="pl-pds">"</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>stylesheets/&lt;%= common.classCssCommon %&gt;.css<span class="pl-pds">"</span></span> <span class="pl-e">media</span>=<span class="pl-s"><span class="pl-pds">"</span>all<span class="pl-pds">"</span></span> /&gt;
        &lt;<span class="pl-ent">link</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>text/css<span class="pl-pds">"</span></span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>stylesheet<span class="pl-pds">"</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>stylesheets/&lt;%= specific.classPage %&gt;.css<span class="pl-pds">"</span></span> <span class="pl-e">media</span>=<span class="pl-s"><span class="pl-pds">"</span>all<span class="pl-pds">"</span></span> /&gt;
    &lt;/<span class="pl-ent">head</span>&gt;
    &lt;<span class="pl-ent">body</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">"</span>&lt;%= specific.classPage %&gt;<span class="pl-pds">"</span></span>&gt;</pre></div>

<p><em>components/foot.htm</em></p>

<div class="highlight highlight-text-html-basic"><pre><span class="pl-s1">        &lt;<span class="pl-ent">script</span> <span class="pl-e">async</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>text/javascript<span class="pl-pds">"</span></span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>javascript/&lt;%= common.classJsCommon %&gt;.js<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span>
    &lt;/<span class="pl-ent">body</span>&gt;
&lt;/<span class="pl-ent">html</span>&gt;</pre></div>

<p><em>templates/template.htm</em></p>

<div class="highlight highlight-text-html-basic"><pre>    &lt;%- include('head.htm') %&gt;

    &lt;<span class="pl-ent">div</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>&gt;&lt;%= common.titleWebsite %&gt;&lt;/<span class="pl-ent">div</span>&gt;

    &lt;<span class="pl-ent">div</span>&gt;
        &lt;<span class="pl-ent">h1</span>&gt;&lt;%= specific.titlePage %&gt;&lt;/<span class="pl-ent">h1</span>&gt;
        &lt;%- specific.content %&gt;
    &lt;/<span class="pl-ent">div</span>&gt;

    &lt;%- include('foot.htm') %&gt;</pre></div>

<p><em>variations/common.json</em></p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>titleWebsite<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Website title<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>classCssCommon<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>common<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>classJsCommon<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>common<span class="pl-pds">"</span></span>
}</pre></div>

<p><em>variations/index.json</em></p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>titlePage<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Welcome<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>classPage<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>content<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;p&gt;This is the home page.&lt;/p&gt;<span class="pl-pds">"</span></span>
}</pre></div>

<p><em>variations/members.json</em></p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>titlePage<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>List of members<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>classPage<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>content<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;p&gt;It is the Members page.&lt;/p&gt;<span class="pl-pds">"</span></span>
}</pre></div>

<p>you will have access to the addresses:</p>

<ul>
<li><em>http://localhost/</em></li>
<li><em>http://localhost/list-of-members/</em></li>
</ul>

<p><em>Note : If</em> <strong><em>variationsRelativePath</em></strong> <em>is not present in "webconfig.js", default variations folder is</em> <strong><em>variations</em></strong>. <strong><em>variationsRelativePath</em></strong> <em>is useful only to change the name/path of directory.</em></p>

<h3>
<a id="manage-multilingual" class="anchor" href="#manage-multilingual" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Manage Multilingual</h3>

<h4>
<a id="all-languages-on-the-same-site" class="anchor" href="#all-languages-on-the-same-site" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>All languages on the same site</h4>

<p>On the same principle, the variations can be used to create the same page, but in different languages:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>languageCode<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>en-gb<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>variationsRelativePath<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>languages<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>landing.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>variation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>landing.json<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/home/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>home.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>variation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>home.json<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/accueil/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>home.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>variation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>home.json<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>languageCode<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>fr-fr<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p><em>Note : In this example I decided to do without a common variation file, because I did not specify</em> <strong><em>commonVariation</em></strong>. <em>I also completely arbitrarily decided to rename my folder</em> <strong><em>variations</em></strong> <em>to</em> <strong><em>languages</em></strong>.</p>

<p>with the following files:</p>

<pre><code>components/
— head.htm
— foot.htm
languages/
— landing.json
— en-gb
—— home.json
— fr-fr
—— home.json
templates/
— landing.htm
— home.htm
webconfig.json
</code></pre>

<p><em>components/head.htm</em></p>

<div class="highlight highlight-text-html-basic"><pre>&lt;!DOCTYPE html&gt;
&lt;<span class="pl-ent">html</span> <span class="pl-e">lang</span>=<span class="pl-s"><span class="pl-pds">"</span>&lt;%= languageCode %&gt;<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">head</span>&gt;
        &lt;<span class="pl-ent">meta</span> <span class="pl-e">charset</span>=<span class="pl-s"><span class="pl-pds">"</span>utf-8<span class="pl-pds">"</span></span> /&gt;
        &lt;<span class="pl-ent">title</span>&gt;&lt;%= specific.titlePage %&gt;&lt;/<span class="pl-ent">title</span>&gt;
    &lt;/<span class="pl-ent">head</span>&gt;
    &lt;<span class="pl-ent">body</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">"</span>&lt;%= specific.classPage %&gt;<span class="pl-pds">"</span></span>&gt;</pre></div>

<p><em>components/foot.htm</em></p>

<div class="highlight highlight-text-html-basic"><pre>    &lt;/<span class="pl-ent">body</span>&gt;
&lt;/<span class="pl-ent">html</span>&gt;</pre></div>

<p><em>templates/landing.htm</em></p>

<div class="highlight highlight-text-html-basic"><pre>    &lt;%- include('head.htm') %&gt;

    &lt;<span class="pl-ent">select</span>&gt;
        &lt;% for (var i = 0; i &lt; specific.selectLabel.length; i++) { %&gt;
        &lt;<span class="pl-ent">option</span>&gt;&lt;%= specific.selectLabel[i] %&gt;&lt;/<span class="pl-ent">option</span>&gt;
        &lt;% } %&gt;
    &lt;/<span class="pl-ent">select</span>&gt;

    &lt;%- include('foot.htm') %&gt;</pre></div>

<p><em>templates/home.htm</em></p>

<div class="highlight highlight-text-html-basic"><pre>    &lt;%- include('head.htm') %&gt;

    &lt;<span class="pl-ent">div</span>&gt;
        &lt;<span class="pl-ent">h1</span>&gt;&lt;%= specific.titlePage %&gt;&lt;/<span class="pl-ent">h1</span>&gt;
        &lt;%- specific.content %&gt;
    &lt;/<span class="pl-ent">div</span>&gt;

    &lt;%- include('foot.htm') %&gt;</pre></div>

<p><em>languages/landing.json</em></p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>titlePage<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Landing<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>classPage<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>landing<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>selectLabel<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
        <span class="pl-s"><span class="pl-pds">"</span>English<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>Français<span class="pl-pds">"</span></span>
    ]
}</pre></div>

<p><em>languages/en-gb/home.json</em></p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>titlePage<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Welcome<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>classPage<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>home<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>content<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;p&gt;This is a home page.&lt;/p&gt;<span class="pl-pds">"</span></span>
}</pre></div>

<p><em>languages/fr-fr/home.json</em></p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>titlePage<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Bienvenue<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>classPage<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>home<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>content<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;p&gt;C'est la page d'accueil.&lt;/p&gt;<span class="pl-pds">"</span></span>
}</pre></div>

<p>you will have access to the addresses:</p>

<ul>
<li><em>http://localhost/</em></li>
<li><em>http://localhost/home/</em></li>
<li><em>http://localhost/accueil/</em></li>
</ul>

<p><em>Note : By default is the</em> <strong><em>languageCode</em></strong> <em>root that determines the display language of the wesite. However, specifically by page language, we can be changed also the</em> <strong><em>languageCode</em></strong><em>. *You should also know that once the site or page has a</em> <strong><em>languageCode</em></strong> <em>in the configuration, variations files must be placed in a subdirectory named with the</em> <strong><em>languageCode</em></strong>.</p>

<h4>
<a id="use-only-changes-with-the-active-multilingual" class="anchor" href="#use-only-changes-with-the-active-multilingual" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Use only changes with the active multilingual</h4>

<p>You may have noticed in the previous example that the <code>landing.json</code> file was not in the <code>en-gb/</code> or <code>fr-fr/</code>. This is quite possible and means that will be used in languages that do not have it in their file.</p>

<p>Also, when a <code>languageCode</code> is specified, NodeAtlas seek first hand the value in the corresponding folder file. If it was not there, so he went to fetch the parent folder (the one used as standard for variations without multilingual).</p>

<p>This will allow you, for example, to manage master language directly in the variation folder. So with the following example:</p>

<pre><code>...
variations/
— common.json
— home.json
— fr-fr
—— common.json
—— home.json
...
</code></pre>

<p>you can</p>

<ul>
<li>manage the version <code>en-gb</code> directly to the root of <code>variations/</code> (as NodeAtlas find nothing in<code>en-gb</code> then it uses the values of the root files) and</li>
<li>manage the <code>fr-fr</code> release in the<code>fr-fr /</code>,</li>
</ul>

<p>thus, if a sentence has not yet translated into a file <code>fr-fr</code>, instead of returning an error, NodeAtlas return the root version or the version<code>en-gb</code>.</p>

<h4>
<a id="each-language-has-its-configuration" class="anchor" href="#each-language-has-its-configuration" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Each language has its configuration</h4>

<p>You can also choose to configure each language in a "webconfig.json" different. With the following set of file:</p>

<pre><code>components/
— head.htm
— foot.htm
variations/
— landing.json
— en-gb
—— home.json
—— members.json
— fr-fr
—— home.json
—— members.json
templates/
— landing.htm
— home.htm
— members.htm
webconfig.json
webconfig.en-gb.json
webconfig.fr-fr.json
</code></pre>

<p>you could have "webconfig.json» next:</p>

<p><em>webconfig.json</em></p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>landing.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>variation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>landing.json<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p><em>webconfig.en-gb.json</em></p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>httpPort<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">81</span>,
    <span class="pl-s"><span class="pl-pds">"</span>urlRelativeSubPath<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>english<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>languageCode<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>en-gb<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>home.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>variation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>home.json<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/members-list/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>variation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.json<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p><em>webconfig.fr-fr.json</em></p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>httpPort<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">82</span>,
    <span class="pl-s"><span class="pl-pds">"</span>urlRelativeSubPath<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>francais<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>languageCode<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>fr-fr<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>home.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>variation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>home.json<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/list-of-members/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>variation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.json<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>and have access to addresses:</p>

<ul>
<li><em>http://localhost/</em></li>
<li><em>http://localhost:81/english/</em></li>
<li><em>http://localhost:81/english/</em></li>
<li><em>http://localhost:81/english/members-list/</em></li>
<li><em>http://localhost:82/francais/</em></li>
<li><em>http://localhost:82/francais/list-of-members/</em></li>
</ul>

<p>It is then possible to reverse proxy with <a href="#proxy">Bouncy</a> (for example) to bring all urls on port 80 to obtain:</p>

<ul>
<li><em><a href="http://www.website.ext/">http://www.website.ext/</a></em></li>
<li><em><a href="http://www.website.ext/english/">http://www.website.ext/english/</a></em></li>
<li><em><a href="http://www.website.ext/english/">http://www.website.ext/english/</a></em></li>
<li><em><a href="http://www.website.ext/english/members-list/">http://www.website.ext/english/members-list/</a></em></li>
<li><em><a href="http://www.website.ext/francais/">http://www.website.ext/francais/</a></em></li>
<li><em><a href="http://www.website.ext/francais/list-of-members/">http://www.website.ext/francais/list-of-members/</a></em></li>
</ul>

<h3>
<a id="nodeatlas-use-to-generate-html-assets" class="anchor" href="#nodeatlas-use-to-generate-html-assets" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>NodeAtlas use to generate HTML assets</h3>

<h4>
<a id="generate-html-assets" class="anchor" href="#generate-html-assets" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Generate HTML assets</h4>

<p>With the following configuration it is possible to generate HTML rendering assets of each page in a linked file. The file will be (re)created every display of page in your browser.</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>htmlGenerateBeforeResponse<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">true</span>,
    <span class="pl-s"><span class="pl-pds">"</span>generatesRelativePath<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>generates<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>generate<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>/index.html<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/list-of-members/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>generate<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>/members/list.html<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/list-of-members/?foo=bar<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>generate<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">false</span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/no/generate/property/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>and the following set of files:</p>

<pre><code>{
assets/
— stylesheets/
—— common.css
— javascript/
—— common.js
generates/
templates/
— index.htm
— members.htm
webconfig.json
}
</code></pre>

<p>can physically create assets:</p>

<pre><code>{
generates/
— index.html
— members/
—— list.html
— no/
—— generates/
——— property &lt;== Ceci est un fichier
templates/
— index.htm
— members.htm
webconfig.json
}
</code></pre>

<p>by going to the address:</p>

<ul>
<li><em>http://localhost/</em></li>
<li><em>http://localhost/list-of-members/</em></li>
<li><em>http://localhost/no/generate/property/</em></li>
</ul>

<p><em>Note : No generate page are generated for "/list-of-members/?foo=bar" because <code>generate</code> is set to <code>false</code>. Use this value to ignore a route generation.</em></p>

<p>The generation starts when displaying the page if <strong><em>htmlGenerateBeforeResponse</em></strong> exist and if it is <strong><em>true</em></strong>. If it is passed <strong><em>false</em></strong> (or removed) the only way to generate all the pages of the website will be via the command <code>node &lt;/path/to/&gt;node-atlas/server.js --generate</code> will generate all pages once if <code>generatesRelativePath</code> exist. Of course in all cases this command work and allow you to regenerate all pages after a change into all page (a change in a component called on all pages e.g.).</p>

<p>Also with <code>--generate</code> , the entire <code>assetsRelativePath</code> folder (public folder files) will be copied in the <code>generatesRelativePath</code> if both folder does not have the same path, and if <code>generatesRelativePath</code> exist. It really allows you to get the stand-alone pages you want in output folder with all files which they call (CSS / JS / Images, etc.).</p>

<p>You could desactivate the HTML generation, even if a directory <code>generatesRelativePath</code> exist in the système file, with <code>htmlGenerateEnable</code> à <code>false</code>.</p>

<p><em>Note : If</em> <strong><em>generatesRelativePath</em></strong> <em>is not present in "webconfig.js", default generates folder is</em> <strong><em>generates/</em></strong>. <strong><em>generatesRelativePath</em></strong> <em>is useful only to change the name/path of directory.</em></p>

<h4>
<a id="generate-website-without-server-side" class="anchor" href="#generate-website-without-server-side" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Generate website without server side</h4>

<p>You can also manager a simple HTML website page with the following configuration:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>languageCode<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>fr-fr<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>enableIndex<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">true</span>,
    <span class="pl-s"><span class="pl-pds">"</span>htmlGenerateBeforeResponse<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">true</span>,
    <span class="pl-s"><span class="pl-pds">"</span>generatesRelativePath<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>../HTML/<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>assetsRelativePath<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>../HTML/<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/cv.html<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>variation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.json<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/en/cv.html<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>variation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.json<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>languageCode<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>en<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>and the following set of files:</p>

<pre><code>HTML/
— stylesheets/
—— common.css
— javascript/
—— common.js
engine/
— variations/
—— fr-fr/
——— index.json
—— en/
——— index.json
— templates/
—— index.htm
— webconfig.json
</code></pre>

<p>To address <em>http://localhost/</em> will show a list of pages your site components (with <strong>enableIndex</strong> set to <strong>true</strong>).</p>

<p>It will do more than, once your work is done, enjoy your HTML site in the folder:</p>

<pre><code>HTML/
— stylesheets/
—— common.css
— javascript/
—— common.js
— cv.html
— en/
—— cv.html
</code></pre>

<h3>
<a id="use-nodeatlas-to-run-a-website-back-end-part" class="anchor" href="#use-nodeatlas-to-run-a-website-back-end-part" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Use NodeAtlas to run a website (Back-end Part)</h3>

<p>You can either use a single controller for the whole site and/or also by controllers template and variation.</p>

<p>For the master controller, use this configuration example:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>commonController<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>common.js<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>controllersRelativePath<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>controllers<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>variation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.json<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/categories/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>categories.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>variation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>categories.json<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>with this set of files</p>

<pre><code>variations/
— index.json
— categories.json
controllers/
— common.js
models/
— Article.js
— Category.js
templates/
— index.htm
— categories.htm
webconfig.json
</code></pre>

<p>And "common.js" file containing e.g.:</p>

<ul>
<li>Things for load additional modules NodeAtlas.</li>
<li>Things for configure additional modules.</li>
</ul>

<div class="highlight highlight-source-js"><pre><span class="pl-c">// Creating a global object for file.</span>
<span class="pl-k">var</span> website <span class="pl-k">=</span> {};



<span class="pl-c">/*******************/</span>
<span class="pl-c">/* Loading modules */</span>
<span class="pl-c">/*******************/</span>

(<span class="pl-k">function</span> (<span class="pl-smi">publics</span>) {
    <span class="pl-s"><span class="pl-pds">"</span>use strict<span class="pl-pds">"</span></span>;

    <span class="pl-c">// Load modules for this site in the NodeAtlas object.</span>
    <span class="pl-smi">publics</span>.<span class="pl-en">loadModules</span> <span class="pl-k">=</span> <span class="pl-k">function</span> () {
        <span class="pl-c">// Find instance of « NodeAtlas » engine.</span>
        <span class="pl-k">var</span> <span class="pl-c1">NA</span> <span class="pl-k">=</span> <span class="pl-v">this</span>;

        <span class="pl-c">// Associations of each module to access it anywhere.</span>
        <span class="pl-c1">NA</span>.<span class="pl-smi">modules</span>.<span class="pl-c1">cookie</span> <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>cookie<span class="pl-pds">'</span></span>);
        <span class="pl-c1">NA</span>.<span class="pl-smi">modules</span>.<span class="pl-smi">mongoose</span> <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>mongoose<span class="pl-pds">'</span></span>);
    };

}(website));



<span class="pl-c">/***********************/</span>
<span class="pl-c">/* Configuring Modules */</span>
<span class="pl-c">/***********************/</span>

(<span class="pl-k">function</span> (<span class="pl-smi">publics</span>) {
    <span class="pl-s"><span class="pl-pds">"</span>use strict<span class="pl-pds">"</span></span>;

    <span class="pl-k">var</span> privates <span class="pl-k">=</span> {};

    <span class="pl-c">// Example of using MongoDB and Mongoose.</span>
    <span class="pl-smi">privates</span>.<span class="pl-en">mongooseInitialization</span> <span class="pl-k">=</span> <span class="pl-k">function</span> (<span class="pl-smi">mongoose</span>, <span class="pl-smi">callback</span>) {
        <span class="pl-c">// "blog" database connection.</span>
        <span class="pl-smi">mongoose</span>.<span class="pl-en">connect</span>(<span class="pl-s"><span class="pl-pds">'</span>mongodb://127.0.0.1:27017/blog<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-smi">error</span>) {
            <span class="pl-k">if</span> (error) {
                <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">"</span>Database 'mongodb://127.0.0.1:27017/blog' is not accessible.<span class="pl-pds">"</span></span>);
                <span class="pl-c1">process</span>.<span class="pl-en">kill</span>(<span class="pl-c1">process</span>.<span class="pl-smi">pid</span>);
            }

            <span class="pl-c">// Next.</span>
            <span class="pl-en">callback</span>(mongoose);
        });

        <span class="pl-c">// Connection Management.</span>
        <span class="pl-smi">mongoose</span>.<span class="pl-smi">connection</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>error<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-smi">error</span>) {
            <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>Error to connect by default Mongoose: <span class="pl-pds">'</span></span> <span class="pl-k">+</span> error);
        });

        <span class="pl-c">// Disconnection Management.</span>
        <span class="pl-smi">mongoose</span>.<span class="pl-smi">connection</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>disconnected<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> () {
            <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>Disconnection of Mongoose.<span class="pl-pds">'</span></span>);
        });
        <span class="pl-c1">process</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>SIGINT<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-smi">error</span>) {
            <span class="pl-smi">mongoose</span>.<span class="pl-smi">connection</span>.<span class="pl-c1">close</span>(<span class="pl-k">function</span> () {
                <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>Disconnection of Mongoose because of app termination<span class="pl-pds">'</span></span>);
                <span class="pl-c1">process</span>.<span class="pl-en">exit</span>(<span class="pl-c1">0</span>);
            });
        });
    };

    <span class="pl-c">// Mongoose Schemas Management.</span>
    <span class="pl-smi">privates</span>.<span class="pl-en">mongooseSchemas</span> <span class="pl-k">=</span> <span class="pl-k">function</span> (<span class="pl-smi">mongoose</span>) {
        <span class="pl-smi">publics</span>.<span class="pl-smi">schema</span> <span class="pl-k">=</span> {};

        <span class="pl-c">// Load Schemas.</span>
        <span class="pl-smi">publics</span>.<span class="pl-smi">schema</span>.<span class="pl-smi">article</span> <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>../models/Article<span class="pl-pds">'</span></span>);
        <span class="pl-smi">publics</span>.<span class="pl-smi">schema</span>.<span class="pl-smi">category</span> <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>../models/Category<span class="pl-pds">'</span></span>);

        <span class="pl-c">// Expose Schemas.</span>
        <span class="pl-smi">mongoose</span>.<span class="pl-en">model</span>(<span class="pl-s"><span class="pl-pds">'</span>article<span class="pl-pds">'</span></span>, <span class="pl-smi">website</span>.<span class="pl-smi">schema</span>.<span class="pl-smi">article</span>, <span class="pl-s"><span class="pl-pds">'</span>article<span class="pl-pds">'</span></span>);
        <span class="pl-smi">mongoose</span>.<span class="pl-en">model</span>(<span class="pl-s"><span class="pl-pds">'</span>category<span class="pl-pds">'</span></span>, <span class="pl-smi">website</span>.<span class="pl-smi">schema</span>.<span class="pl-smi">category</span>, <span class="pl-s"><span class="pl-pds">'</span>category<span class="pl-pds">'</span></span>);
    };

    <span class="pl-c">// Example using Socket.IO.</span>
    <span class="pl-smi">privates</span>.<span class="pl-en">socketIoInitialisation</span> <span class="pl-k">=</span> <span class="pl-k">function</span> (<span class="pl-smi">socketio</span>, <span class="pl-c1">NA</span>, <span class="pl-smi">callback</span>) {
        <span class="pl-k">var</span> optionIo <span class="pl-k">=</span> (<span class="pl-c1">NA</span>.<span class="pl-smi">webconfig</span>.<span class="pl-smi">urlRelativeSubPath</span>) <span class="pl-k">?</span> { path<span class="pl-k">:</span> <span class="pl-c1">NA</span>.<span class="pl-smi">webconfig</span>.<span class="pl-smi">urlRelativeSubPath</span> <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">'</span>/socket.io<span class="pl-pds">'</span></span>, secure<span class="pl-k">:</span> ((<span class="pl-c1">NA</span>.<span class="pl-smi">webconfig</span>.<span class="pl-smi">httpSecure</span>) <span class="pl-k">?</span> <span class="pl-c1">true</span> <span class="pl-k">:</span> <span class="pl-c1">false</span>) } <span class="pl-k">:</span> <span class="pl-c1">undefined</span>,
            io <span class="pl-k">=</span> <span class="pl-en">socketio</span>(<span class="pl-c1">NA</span>.<span class="pl-smi">server</span>, optionIo),
            cookie <span class="pl-k">=</span> <span class="pl-c1">NA</span>.<span class="pl-smi">modules</span>.<span class="pl-c1">cookie</span>,
            cookieParser <span class="pl-k">=</span> <span class="pl-c1">NA</span>.<span class="pl-smi">modules</span>.<span class="pl-smi">cookieParser</span>;

        <span class="pl-c">// Synchronizing sessions with Socket.IO.</span>
        <span class="pl-smi">io</span>.<span class="pl-en">use</span>(<span class="pl-k">function</span>(<span class="pl-smi">socket</span>, <span class="pl-smi">next</span>) {
            <span class="pl-k">var</span> handshakeData <span class="pl-k">=</span> <span class="pl-smi">socket</span>.<span class="pl-smi">request</span>;

            <span class="pl-c">// Fallback if cookies are not supported.</span>
            <span class="pl-k">if</span> (<span class="pl-k">!</span><span class="pl-smi">handshakeData</span>.<span class="pl-c1">headers</span>.<span class="pl-c1">cookie</span>) {
                <span class="pl-k">return</span> <span class="pl-en">next</span>(<span class="pl-k">new</span> <span class="pl-en">Error</span>(<span class="pl-s"><span class="pl-pds">'</span>Session cookie required.<span class="pl-pds">'</span></span>));
            }

            <span class="pl-c">// Transformation of the cookie String to JSON object.</span>
            <span class="pl-smi">handshakeData</span>.<span class="pl-c1">cookie</span> <span class="pl-k">=</span> <span class="pl-smi">cookie</span>.<span class="pl-c1">parse</span>(<span class="pl-smi">handshakeData</span>.<span class="pl-c1">headers</span>.<span class="pl-c1">cookie</span>);

            <span class="pl-c">// Verification of the signature of the cookie.</span>
            <span class="pl-smi">handshakeData</span>.<span class="pl-c1">cookie</span> <span class="pl-k">=</span> <span class="pl-smi">cookieParser</span>.<span class="pl-en">signedCookies</span>(<span class="pl-smi">handshakeData</span>.<span class="pl-c1">cookie</span>, <span class="pl-c1">NA</span>.<span class="pl-smi">webconfig</span>.<span class="pl-smi">session</span>.<span class="pl-smi">secret</span>);

            <span class="pl-c">// Keep worn the Session ID.</span>
            <span class="pl-smi">handshakeData</span>.<span class="pl-smi">sessionID</span> <span class="pl-k">=</span> <span class="pl-smi">handshakeData</span>.<span class="pl-c1">cookie</span>[<span class="pl-c1">NA</span>.<span class="pl-smi">webconfig</span>.<span class="pl-smi">session</span>.<span class="pl-smi">key</span>];

            <span class="pl-c">// Accept the cookie.</span>
            <span class="pl-c1">NA</span>.<span class="pl-smi">sessionStore</span>.<span class="pl-c1">load</span>(<span class="pl-smi">handshakeData</span>.<span class="pl-smi">sessionID</span>, <span class="pl-k">function</span> (<span class="pl-smi">error</span>, <span class="pl-smi">session</span>) {
                <span class="pl-k">if</span> (error <span class="pl-k">||</span> <span class="pl-k">!</span>session) {
                    <span class="pl-k">return</span> <span class="pl-en">next</span>(<span class="pl-k">new</span> <span class="pl-en">Error</span>(<span class="pl-s"><span class="pl-pds">'</span>No recovered session.<span class="pl-pds">'</span></span>));
                } <span class="pl-k">else</span> {
                    <span class="pl-smi">handshakeData</span>.<span class="pl-smi">session</span> <span class="pl-k">=</span> session;
                    <span class="pl-en">next</span>();
                }
            });
        });

        <span class="pl-c">// Next.</span>
        <span class="pl-en">callback</span>(io);
    };

    <span class="pl-c">// Adding listener for a specific controller "index.js" (see example in the next file).</span>
    <span class="pl-smi">privates</span>.<span class="pl-en">socketIoEvents</span> <span class="pl-k">=</span> <span class="pl-k">function</span> (<span class="pl-smi">io</span>, <span class="pl-c1">NA</span>) {
        <span class="pl-k">var</span> params <span class="pl-k">=</span> {};

        <span class="pl-smi">params</span>.<span class="pl-smi">io</span> <span class="pl-k">=</span> io;

        <span class="pl-c">// Event for the index page (see example in the next file).</span>
        <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>./index<span class="pl-pds">'</span></span>).<span class="pl-smi">asynchrone</span>.<span class="pl-c1">call</span>(<span class="pl-c1">NA</span>, params);
    };

    <span class="pl-c">// Configuration of all modules.</span>
    <span class="pl-smi">publics</span>.<span class="pl-en">setConfigurations</span> <span class="pl-k">=</span> <span class="pl-k">function</span> (<span class="pl-smi">callback</span>) {
        <span class="pl-k">var</span> <span class="pl-c1">NA</span> <span class="pl-k">=</span> <span class="pl-v">this</span>,
            mongoose <span class="pl-k">=</span> <span class="pl-c1">NA</span>.<span class="pl-smi">modules</span>.<span class="pl-smi">mongoose</span>,
            socketio <span class="pl-k">=</span> <span class="pl-c1">NA</span>.<span class="pl-smi">modules</span>.<span class="pl-smi">socketio</span>;

        <span class="pl-c">// Initialize Mongoose.</span>
        <span class="pl-smi">privates</span>.<span class="pl-en">mongooseInitialization</span>(mongoose, <span class="pl-k">function</span> (<span class="pl-smi">mongoose</span>) {

            <span class="pl-c">// Schemas injection into Mongoose.</span>
            <span class="pl-smi">privates</span>.<span class="pl-en">mongooseSchemas</span>(mongoose);

            <span class="pl-c">// Initialize Socket IO.</span>
            <span class="pl-smi">privates</span>.<span class="pl-en">socketIoInitialisation</span>(socketio, <span class="pl-c1">NA</span>, <span class="pl-k">function</span> (<span class="pl-smi">io</span>) {

                <span class="pl-c">// Socket IO listening.</span>
                <span class="pl-smi">privates</span>.<span class="pl-en">socketIoEvents</span>(io, <span class="pl-c1">NA</span>);

                <span class="pl-c">// Next steps of engine.</span>
                <span class="pl-en">callback</span>();
            });
        });

    };

}(website));



<span class="pl-c">/****************************/</span>
<span class="pl-c">/* Variations interception. */</span>
<span class="pl-c">/****************************/</span>

(<span class="pl-k">function</span> (<span class="pl-smi">publics</span>) {
    <span class="pl-s"><span class="pl-pds">"</span>use strict<span class="pl-pds">"</span></span>;

    <span class="pl-c">// It occurs just before the complete assembly EJS.</span>
    <span class="pl-smi">publics</span>.<span class="pl-en">changeVariation</span> <span class="pl-k">=</span> <span class="pl-k">function</span> (<span class="pl-smi">params</span>, <span class="pl-smi">mainCallback</span>) {
        <span class="pl-k">var</span> variation <span class="pl-k">=</span> <span class="pl-smi">params</span>.<span class="pl-smi">variation</span>;

        <span class="pl-c">// Here variations variables are modified.</span>
        <span class="pl-c">// see example in the file after.</span>

        <span class="pl-c">// We re-injects the changes.</span>
        <span class="pl-en">mainCallback</span>(variation);
    };

}(website));



<span class="pl-c">/**********************************************************/</span>
<span class="pl-c">/* Interception of the HTML output for server-side jQuery */</span>
<span class="pl-c">/**********************************************************/</span>

(<span class="pl-k">function</span> (<span class="pl-smi">publics</span>) {
    <span class="pl-s"><span class="pl-pds">"</span>use strict<span class="pl-pds">"</span></span>;

    <span class="pl-c">// It comes just before the HTML response to the client.</span>
    <span class="pl-smi">publics</span>.<span class="pl-en">changeDom</span> <span class="pl-k">=</span> <span class="pl-k">function</span> (<span class="pl-smi">params</span>, <span class="pl-smi">mainCallback</span>) {
        <span class="pl-k">var</span> dom <span class="pl-k">=</span> <span class="pl-smi">params</span>.<span class="pl-smi">dom</span>;

        <span class="pl-c">// Here one can manipulate the DOM before response to the client.</span>
        <span class="pl-c">// see example in the file after.</span>

        <span class="pl-c">// We re-injects the changes.</span>
        <span class="pl-en">mainCallback</span>(dom);
    };

}(website));



<span class="pl-c">/********************************************/</span>
<span class="pl-c">/* Expose function for the NodeAtlas engine */</span>
<span class="pl-c">/********************************************/</span>

<span class="pl-c1">exports</span>.<span class="pl-smi">loadModules</span> <span class="pl-k">=</span> <span class="pl-smi">website</span>.<span class="pl-smi">loadModules</span>;
<span class="pl-c1">exports</span>.<span class="pl-smi">setConfigurations</span> <span class="pl-k">=</span> <span class="pl-smi">website</span>.<span class="pl-smi">setConfigurations</span>;
<span class="pl-c1">exports</span>.<span class="pl-smi">changeVariation</span> <span class="pl-k">=</span> <span class="pl-smi">website</span>.<span class="pl-smi">changeVariation</span>;
<span class="pl-c1">exports</span>.<span class="pl-smi">changeDom</span> <span class="pl-k">=</span> <span class="pl-smi">website</span>.<span class="pl-smi">changeDom</span>;</pre></div>

<p>Instead of using <code>changeVariation</code> and <code>changeDom</code> in the file <code>common.js</code> effective for the whole website page, you can use specific controllers page. The previous configuration becomes:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>commonController<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>common.js<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>controllersRelativePath<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>controllers/<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>controller<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.js<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>variation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.json<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/categories/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>categories.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>controller<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>categories.js<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>variation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>categories.json<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>with this set of files:</p>

<pre><code>variations/
— index.json
— categories.json
controllers/
— modules/
—— list-of-article.js/
— common.js
- index.js
- categories.js
models/
— Article.js
— Category.js
templates/
— index.htm
— categories.htm
webconfig.json
</code></pre>

<p>with a "index.js" file containing, for example:</p>

<ul>
<li>Things for dynamically change the front display.</li>
<li>Things for changes on the server side with jQuery.</li>
<li>Things for asynchronous exchanges with Socket.IO.</li>
</ul>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> website <span class="pl-k">=</span> {};



<span class="pl-c">/***************************/</span>
<span class="pl-c">/* Variations Interception */</span>
<span class="pl-c">/***************************/</span>

(<span class="pl-k">function</span> (<span class="pl-smi">publics</span>) {
    <span class="pl-s"><span class="pl-pds">"</span>use strict<span class="pl-pds">"</span></span>;

    <span class="pl-k">var</span> privates <span class="pl-k">=</span> {};

    <span class="pl-c">// Charging a function or set of functions.</span>
    <span class="pl-smi">privates</span>.<span class="pl-smi">listOfArticles</span> <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>./modules/list-of-articles<span class="pl-pds">'</span></span>);

    <span class="pl-c">// It occurs just before the complete assembly EJS.</span>
    <span class="pl-smi">publics</span>.<span class="pl-en">changeVariation</span> <span class="pl-k">=</span> <span class="pl-k">function</span> (<span class="pl-smi">params</span>, <span class="pl-smi">mainCallback</span>) {
        <span class="pl-k">var</span> <span class="pl-c1">NA</span> <span class="pl-k">=</span> <span class="pl-v">this</span>,
            variation <span class="pl-k">=</span> <span class="pl-smi">params</span>.<span class="pl-smi">variation</span>,
            mongoose <span class="pl-k">=</span> <span class="pl-smi">params</span>.<span class="pl-c1">NA</span>.<span class="pl-smi">modules</span>.<span class="pl-smi">mongoose</span>,
            Article <span class="pl-k">=</span> <span class="pl-smi">mongoose</span>.<span class="pl-en">model</span>(<span class="pl-s"><span class="pl-pds">'</span>article<span class="pl-pds">'</span></span>);


        <span class="pl-c">// Can intercept all the variables of "variations/common.js".</span>
        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-smi">variation</span>.<span class="pl-smi">common</span>.<span class="pl-c1">title</span>); <span class="pl-c">// Return title stored in « variations/common.js ».</span>
        <span class="pl-smi">variation</span>.<span class="pl-smi">common</span>.<span class="pl-c1">title</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>New Title<span class="pl-pds">"</span></span>; <span class="pl-c">// Set title.</span>
        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-smi">variation</span>.<span class="pl-smi">common</span>.<span class="pl-c1">title</span>); <span class="pl-c">// Return "New Title" and is accessible in template side via `&lt;%= common.title %&gt;`.</span>

        <span class="pl-c">// Can intercept all the variables of "variations/index.js" (because this file correspond to specific "index.js").</span>
        <span class="pl-smi">variation</span>.<span class="pl-smi">specific</span>.<span class="pl-c1">title</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>New Title<span class="pl-pds">"</span></span>; <span class="pl-c">// Return "New Title" and is accessible in template side via `&lt;%= specific.title %&gt;`.</span>
        <span class="pl-smi">variation</span>.<span class="pl-smi">specific</span>.<span class="pl-smi">newProperty</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>New Property<span class="pl-pds">"</span></span>; <span class="pl-c">// Defined a property does not exist in the original variation file that is accessible in template side via « &lt;%= specific.newProperty ».</span>

        <span class="pl-c">// Can intercept the configuration of the current page</span>
        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-smi">variation</span>.<span class="pl-smi">currentRoute</span>); <span class="pl-c">// Return « / » for « index.js », « /categories/ » for categories.js, « /categories/:category/ » for « category-detail.js », etc.</span>

        <span class="pl-c">// A test is made on a variable created in the webconfig.</span>
        <span class="pl-k">if</span> (<span class="pl-smi">variation</span>.<span class="pl-smi">webconfig</span>.<span class="pl-smi">_websiteIsClosed</span>) {
            <span class="pl-c">// The page is a 404.</span>
            <span class="pl-smi">variation</span>.<span class="pl-smi">currentRouteParameters</span>.<span class="pl-smi">statusCode</span> <span class="pl-k">=</span> <span class="pl-c1">404</span>;
        } <span class="pl-k">else</span> {
            <span class="pl-c">// The page is a 200.</span>
            <span class="pl-smi">variation</span>.<span class="pl-smi">currentRouteParameters</span>.<span class="pl-smi">statusCode</span> <span class="pl-k">=</span> <span class="pl-c1">200</span>;
        }

        <span class="pl-c">// Creating a new set of dynamic variation for templates.</span>
        <span class="pl-smi">variation</span>.<span class="pl-smi">backend</span> <span class="pl-k">=</span> {}; <span class="pl-c">// Properties available through « &lt;%= backend.&lt;properties&gt; %&gt; ».</span>

        <span class="pl-smi">privates</span>.<span class="pl-en">listOfArticles</span>(Article, <span class="pl-k">function</span> (<span class="pl-smi">listOfArticles</span>) {

            <span class="pl-c">// Availability of data items for client-side.</span>
            <span class="pl-smi">variation</span>.<span class="pl-smi">backend</span>.<span class="pl-smi">articles</span> <span class="pl-k">=</span> listOfArticles; <span class="pl-c">// « &lt;%= backend.articles.&lt;properties&gt; %&gt; ».</span>

            <span class="pl-c">// We re-injects the changes.</span>
            <span class="pl-en">mainCallback</span>(variation);
        });
    };

}(website));



<span class="pl-c">/**********************************************************/</span>
<span class="pl-c">/* Interception of the HTML output for server-side jQuery */</span>
<span class="pl-c">/**********************************************************/</span>

(<span class="pl-k">function</span> (<span class="pl-smi">publics</span>) {
    <span class="pl-s"><span class="pl-pds">"</span>use strict<span class="pl-pds">"</span></span>;

    <span class="pl-c">// It comes just before the HTML response to the client.</span>
    <span class="pl-smi">publics</span>.<span class="pl-en">changeDom</span> <span class="pl-k">=</span> <span class="pl-k">function</span> (<span class="pl-smi">params</span>, <span class="pl-smi">mainCallback</span>) {
        <span class="pl-k">var</span> <span class="pl-c1">NA</span> <span class="pl-k">=</span> <span class="pl-v">this</span>,
            dom <span class="pl-k">=</span> <span class="pl-smi">params</span>.<span class="pl-smi">dom</span>,
            cheerio <span class="pl-k">=</span> <span class="pl-c1">NA</span>.<span class="pl-smi">modules</span>.<span class="pl-smi">cheerio</span>, <span class="pl-c">// Recovery cheerio to browse the DOM with jQuery.</span>
            $ <span class="pl-k">=</span> <span class="pl-smi">cheerio</span>.<span class="pl-c1">load</span>(dom); <span class="pl-c">// It loads dom to manipulate as a DOM.</span>

        <span class="pl-c">// After all HTML h2 output "dom".</span>
        <span class="pl-en">$</span>(<span class="pl-s"><span class="pl-pds">"</span>h2<span class="pl-pds">"</span></span>).<span class="pl-en">each</span>(<span class="pl-k">function</span> () {
            <span class="pl-k">var</span> $<span class="pl-v">this</span> <span class="pl-k">=</span> <span class="pl-en">$</span>(<span class="pl-v">this</span>);

            <span class="pl-c">// ...we created a div,</span>
            <span class="pl-smi">$this</span>.<span class="pl-en">after</span>(
                <span class="pl-c">// ... on injecte le contenu du h2 dans la div,</span>
                <span class="pl-en">$</span>(<span class="pl-s"><span class="pl-pds">"</span>&lt;div&gt;<span class="pl-pds">"</span></span>).<span class="pl-en">html</span>(<span class="pl-smi">$this</span>.<span class="pl-en">html</span>())
            );
            <span class="pl-c">// ...and deletes the h2.</span>
            <span class="pl-smi">$this</span>.<span class="pl-en">remove</span>();
        });

        <span class="pl-c">// We re-create a new HTML output with our changes.</span>
        dom <span class="pl-k">=</span> <span class="pl-smi">$</span>.<span class="pl-en">html</span>();

        <span class="pl-c">// We re-injects the changes.</span>
        <span class="pl-en">mainCallback</span>(dom);
    };

}(website));



<span class="pl-c">/********************************************/</span>
<span class="pl-c">/* Asynchronous Events Management Socket.IO */</span>
<span class="pl-c">/********************************************/</span>

(<span class="pl-k">function</span> (<span class="pl-smi">publics</span>) {
    <span class="pl-s"><span class="pl-pds">"</span>use strict<span class="pl-pds">"</span></span>;

    <span class="pl-c">// All Websocket action possible for this template.</span>
    <span class="pl-smi">publics</span>.<span class="pl-en">asynchrone</span> <span class="pl-k">=</span> <span class="pl-k">function</span> (<span class="pl-smi">params</span>) {
        <span class="pl-k">var</span> <span class="pl-c1">NA</span> <span class="pl-k">=</span> <span class="pl-v">this</span>,
            io <span class="pl-k">=</span> <span class="pl-smi">params</span>.<span class="pl-smi">io</span>,
            mongoose <span class="pl-k">=</span> <span class="pl-smi">params</span>.<span class="pl-c1">NA</span>.<span class="pl-smi">modules</span>.<span class="pl-smi">mongoose</span>,
            marked <span class="pl-k">=</span> <span class="pl-smi">params</span>.<span class="pl-c1">NA</span>.<span class="pl-smi">modules</span>.<span class="pl-smi">marked</span>,
            Article <span class="pl-k">=</span> <span class="pl-smi">mongoose</span>.<span class="pl-en">model</span>(<span class="pl-s"><span class="pl-pds">'</span>article<span class="pl-pds">'</span></span>);

        <span class="pl-c">// Once we have a valid connection between the client and our back-end...</span>
        <span class="pl-smi">io</span>.<span class="pl-smi">sockets</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>connection<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-smi">socket</span>) {
            <span class="pl-k">var</span> sessionID <span class="pl-k">=</span> <span class="pl-smi">socket</span>.<span class="pl-smi">request</span>.<span class="pl-smi">sessionID</span>,
                session <span class="pl-k">=</span> <span class="pl-smi">socket</span>.<span class="pl-smi">request</span>.<span class="pl-smi">session</span>;

            <span class="pl-c">// ...stay tuned on the "create-item-button" demand...</span>
            <span class="pl-smi">socket</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>create-article-button<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-smi">data</span>) {

                <span class="pl-c">// ...and respond to this demand by creating a new item if it comes</span>
                <span class="pl-c">// with the information sent via "data".</span>
                <span class="pl-k">var</span> article <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Article</span>({
                    _id<span class="pl-k">:</span> <span class="pl-smi">mongoose</span>.<span class="pl-smi">Types</span>.<span class="pl-en">ObjectId</span>(),
                    title<span class="pl-k">:</span> <span class="pl-smi">data</span>.<span class="pl-c1">title</span>,
                    urn<span class="pl-k">:</span> <span class="pl-smi">data</span>.<span class="pl-smi">urn</span>,
                });

                <span class="pl-c">// If the user is connected.</span>
                <span class="pl-k">if</span> (<span class="pl-smi">session</span>.<span class="pl-smi">account</span>) {

                    <span class="pl-c">// ...we save the article into database.</span>
                    <span class="pl-smi">article</span>.<span class="pl-en">save</span>(<span class="pl-k">function</span> (<span class="pl-smi">error</span>) {
                        <span class="pl-k">if</span> (error) {
                            <span class="pl-k">throw</span> error;
                        }

                        <span class="pl-c">// And responds to all customers with a set of data in data.</span>
                        <span class="pl-smi">io</span>.<span class="pl-smi">sockets</span>.<span class="pl-en">emit</span>(<span class="pl-s"><span class="pl-pds">'</span>create-article-button<span class="pl-pds">'</span></span>, data);
                    });
                }
            });
        });
    };

}(website));



<span class="pl-c">/********************************************/</span>
<span class="pl-c">/* Expose function for the NodeAtlas engine */</span>
<span class="pl-c">/********************************************/</span>

<span class="pl-c1">exports</span>.<span class="pl-smi">changeVariation</span> <span class="pl-k">=</span> <span class="pl-smi">website</span>.<span class="pl-smi">changeVariation</span>;
<span class="pl-c1">exports</span>.<span class="pl-smi">changeDom</span> <span class="pl-k">=</span> <span class="pl-smi">website</span>.<span class="pl-smi">changeDom</span>;
<span class="pl-c1">exports</span>.<span class="pl-smi">asynchrone</span> <span class="pl-k">=</span> <span class="pl-smi">website</span>.<span class="pl-smi">asynchrone</span>; <span class="pl-c">// Used not by "NodeAtlas" but with "common.js" (see previous file).</span></pre></div>

<p><em>Note : If</em> <strong><em>controllersRelativePath</em></strong> <em>is not present in "webconfig.js", default controller folder is</em> <strong><em>controllers</em></strong>. <strong><em>controllersRelativePath</em></strong> <em>is useful only to change the name/path of directory.</em></p>

<h3>
<a id="generate-partial-page-with-ajaxwebsocket" class="anchor" href="#generate-partial-page-with-ajaxwebsocket" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Generate partial page with AJAX/Websocket</h3>

<p>When a page is generate and send to client, the server doesn't know, if an AJAX request come, what is the route associated. And so it not capable to response with an HTML that used the correct variations or correct language.</p>

<p>The first step is to set value into client code. For example :</p>

<div class="highlight highlight-text-html-basic"><pre>...
&lt;<span class="pl-ent">html</span> <span class="pl-e">lang</span>=<span class="pl-s"><span class="pl-pds">"</span>&lt;%= languageCode %&gt;<span class="pl-pds">"</span></span>&gt;
...
&lt;<span class="pl-ent">body</span> <span class="pl-e">data-variation</span>=<span class="pl-s"><span class="pl-pds">"</span>&lt;%= currentRouteParameters.variation %&gt;<span class="pl-pds">"</span></span>&gt;
...</pre></div>

<p>and the generate code will be :</p>

<div class="highlight highlight-text-html-basic"><pre>...
&lt;<span class="pl-ent">html</span> <span class="pl-e">lang</span>=<span class="pl-s"><span class="pl-pds">"</span>fr-fr<span class="pl-pds">"</span></span>&gt;
...
&lt;<span class="pl-ent">body</span> <span class="pl-e">data-variation</span>=<span class="pl-s"><span class="pl-pds">"</span>index<span class="pl-pds">"</span></span>&gt;
...</pre></div>

<p>after, the JavaScript part send this value with an AJAX call with jQuery for example or, a socket.io request :</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">...</span>
<span class="pl-smi">publics</span>.<span class="pl-smi">socket</span>.<span class="pl-en">emit</span>(<span class="pl-s"><span class="pl-pds">"</span>load-section-a<span class="pl-pds">"</span></span>, {
    lang<span class="pl-k">:</span> <span class="pl-en">$</span>(<span class="pl-s"><span class="pl-pds">"</span>html<span class="pl-pds">"</span></span>).<span class="pl-en">attr</span>(<span class="pl-s"><span class="pl-pds">'</span>lang<span class="pl-pds">'</span></span>),
    variation<span class="pl-k">:</span> <span class="pl-en">$</span>(<span class="pl-s"><span class="pl-pds">"</span>body<span class="pl-pds">"</span></span>).<span class="pl-c1">data</span>(<span class="pl-s"><span class="pl-pds">'</span>variation<span class="pl-pds">'</span></span>)
});
<span class="pl-k">...</span></pre></div>

<p>and so, the server know this parameters,</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">...</span>
<span class="pl-smi">socket</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>load-section-a<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-smi">data</span>) {
    <span class="pl-k">var</span> result <span class="pl-k">=</span> {},
        currentVariation <span class="pl-k">=</span> {};

    <span class="pl-c">// Specific variations in the good language.</span>
    currentVariation <span class="pl-k">=</span> <span class="pl-c1">NA</span>.<span class="pl-en">addSpecificVariation</span>(<span class="pl-smi">data</span>.<span class="pl-smi">variation</span>, <span class="pl-smi">data</span>.<span class="pl-c1">lang</span>, currentVariation);

    <span class="pl-c">// Common variations in the good language.</span>
    currentVariation <span class="pl-k">=</span> <span class="pl-c1">NA</span>.<span class="pl-en">addCommonVariation</span>(<span class="pl-smi">data</span>.<span class="pl-c1">lang</span>, currentVariation);

    <span class="pl-c">// HTML part from `componentsRelativePath` directory and render with variations.</span>
    result <span class="pl-k">=</span> <span class="pl-c1">NA</span>.<span class="pl-en">newRender</span>(<span class="pl-s"><span class="pl-pds">"</span>section-a.htm<span class="pl-pds">"</span></span>, currentVariation);

    <span class="pl-c">// Send the result to client.</span>
    <span class="pl-smi">socket</span>.<span class="pl-en">emit</span>(<span class="pl-s"><span class="pl-pds">'</span>load-sections<span class="pl-pds">'</span></span>, result);
});
<span class="pl-k">...</span></pre></div>

<p>and this thanks to <code>NA.addSpecificVariation</code>, <code>NA.addCommonVariation</code> and <code>NA.newRender</code>.</p>

<p>If <code>data.lang</code> in this example is type of <code>undefined</code>, files will be search in rood directory. If <code>currentVariation</code> is type of <code>undefined</code> an empty object will be created.</p>

<h3>
<a id="change-the-url-parameters" class="anchor" href="#change-the-url-parameters" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Change the url parameters</h3>

<p>By default, if you use the following configuration:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>This is the same to using it:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>httpHostname<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>httpPort<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">80</span>,
    <span class="pl-s"><span class="pl-pds">"</span>httpSecure<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">false</span>,
    <span class="pl-s"><span class="pl-pds">"</span>urlRelativeSubPath<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>and you will be access to the url: <em>http://localhost/</em>.</p>

<p>Then change the configuration to this:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>httpHostname<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>127.0.0.1<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>httpPort<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">7777</span>,
    <span class="pl-s"><span class="pl-pds">"</span>httpSecure<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">true</span>,
    <span class="pl-s"><span class="pl-pds">"</span>urlRelativeSubPath<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>sub/folder<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>for access to : <em><a href="https://127.0.0.1:7777/sub/folder/">https://127.0.0.1:7777/sub/folder/</a></em></p>

<h3>
<a id="create-your-own-webconfig-variables" class="anchor" href="#create-your-own-webconfig-variables" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Create your own webconfig variables</h3>

<p>Imagine two webconfigs in which we create our own variables as follows:</p>

<ol>
<li>"webconfig.json"</li>
</ol>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    },
    <span class="pl-s"><span class="pl-pds">"</span>_minified<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>
}</pre></div>

<ol>
<li>"webconfig.prod.json"</li>
</ol>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    },
    <span class="pl-s"><span class="pl-pds">"</span>_minified<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>.min<span class="pl-pds">"</span></span>
}</pre></div>

<p>with this set of files</p>

<pre><code>assets/
— stylesheets/
—— common.css
—— common.min.css
— javascript/
—— common.js
—— common.min.js
templates/
— index.htm
webconfig.json
webconfig.prod.json
</code></pre>

<p>and "index.htm" containing:</p>

<div class="highlight highlight-text-html-basic"><pre>&lt;!DOCTYPE html&gt;
&lt;<span class="pl-ent">html</span> <span class="pl-e">lang</span>=<span class="pl-s"><span class="pl-pds">"</span>fr-fr<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">head</span>&gt;
        &lt;<span class="pl-ent">meta</span> <span class="pl-e">charset</span>=<span class="pl-s"><span class="pl-pds">"</span>utf-8<span class="pl-pds">"</span></span> /&gt;
        &lt;<span class="pl-ent">title</span>&gt;Hello world&lt;/<span class="pl-ent">title</span>&gt;
        &lt;<span class="pl-ent">link</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>stylesheet<span class="pl-pds">"</span></span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>text/css<span class="pl-pds">"</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>stylesheets/common&lt;%= webconfig._minified %&gt;.css<span class="pl-pds">"</span></span> /&gt;
    &lt;/<span class="pl-ent">head</span>&gt;
    &lt;<span class="pl-ent">body</span>&gt;
        &lt;<span class="pl-ent">div</span>&gt;This is a test to get a file minify/unminify.&lt;/<span class="pl-ent">div</span>&gt;
<span class="pl-s1">        &lt;<span class="pl-ent">script</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>text/javascript<span class="pl-pds">"</span></span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>javascript/common&lt;%= webconfig._minified %&gt;.js<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span>
    &lt;/<span class="pl-ent">body</span>&gt;
&lt;/<span class="pl-ent">html</span>&gt;</pre></div>

<p>To run (since the site folder) the the command:</p>

<pre><code>\&gt; node &lt;/path/to/&gt;node-atlas/node-atlas.js
</code></pre>

<p>We will have to address "http://localhost/" the following output with non-minified files:</p>

<div class="highlight highlight-text-html-basic"><pre>&lt;!DOCTYPE html&gt;
&lt;<span class="pl-ent">html</span> <span class="pl-e">lang</span>=<span class="pl-s"><span class="pl-pds">"</span>fr-fr<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">head</span>&gt;
        &lt;<span class="pl-ent">meta</span> <span class="pl-e">charset</span>=<span class="pl-s"><span class="pl-pds">"</span>utf-8<span class="pl-pds">"</span></span> /&gt;
        &lt;<span class="pl-ent">title</span>&gt;Hello world&lt;/<span class="pl-ent">title</span>&gt;
        &lt;<span class="pl-ent">link</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>stylesheet<span class="pl-pds">"</span></span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>text/css<span class="pl-pds">"</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>stylesheets/common.css<span class="pl-pds">"</span></span> /&gt;
    &lt;/<span class="pl-ent">head</span>&gt;
    &lt;<span class="pl-ent">body</span>&gt;
        &lt;<span class="pl-ent">div</span>&gt;This is a test to get a file minify/unminify.&lt;/<span class="pl-ent">div</span>&gt;
<span class="pl-s1">        &lt;<span class="pl-ent">script</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>text/javascript<span class="pl-pds">"</span></span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>javascript/common.js<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span>
    &lt;/<span class="pl-ent">body</span>&gt;
&lt;/<span class="pl-ent">html</span>&gt;</pre></div>

<p>However, running the command:</p>

<pre><code>\&gt; node &lt;/path/to/&gt;node-atlas/server.js --webconfig webconfig.prod.json
</code></pre>

<p>We will have to address "http://localhost/" the following output with minified files:</p>

<div class="highlight highlight-text-html-basic"><pre>&lt;!DOCTYPE html&gt;
&lt;<span class="pl-ent">html</span> <span class="pl-e">lang</span>=<span class="pl-s"><span class="pl-pds">"</span>fr-fr<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">head</span>&gt;
        &lt;<span class="pl-ent">meta</span> <span class="pl-e">charset</span>=<span class="pl-s"><span class="pl-pds">"</span>utf-8<span class="pl-pds">"</span></span> /&gt;
        &lt;<span class="pl-ent">title</span>&gt;Hello world&lt;/<span class="pl-ent">title</span>&gt;
        &lt;<span class="pl-ent">link</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>stylesheet<span class="pl-pds">"</span></span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>text/css<span class="pl-pds">"</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>stylesheets/common.min.css<span class="pl-pds">"</span></span> /&gt;
    &lt;/<span class="pl-ent">head</span>&gt;
    &lt;<span class="pl-ent">body</span>&gt;
        &lt;<span class="pl-ent">div</span>&gt;This is a test to get a file minify/unminify.&lt;/<span class="pl-ent">div</span>&gt;
<span class="pl-s1">        &lt;<span class="pl-ent">script</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>text/javascript<span class="pl-pds">"</span></span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>javascript/common.min.js<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span>
    &lt;/<span class="pl-ent">body</span>&gt;
&lt;/<span class="pl-ent">html</span>&gt;</pre></div>

<p><em>Note : It is better to prefix his personal variables with "_" to avoid conflicts with existing or future configuration variables.</em></p>

<h3>
<a id="manage-routing-url-rewriting" class="anchor" href="#manage-routing-url-rewriting" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Manage routing (URL Rewriting)</h3>

<p>Although you can configure static urls, you can also set of dynamic url!</p>

<h4>
<a id="standard" class="anchor" href="#standard" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Standard</h4>

<p>With the following configuration:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/list-of-members/:member/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.htm<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/list-of-members/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.htm<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>you can access:</p>

<ul>
<li><em>http://localhost/</em></li>
<li><em>http://localhost/list-of-members/</em></li>
<li><em>http://localhost/list-of-members/toto/</em></li>
<li><em>http://localhost/list-of-members/bob-eponge99/</em></li>
<li><em>http://localhost/list-of-members/node-atlas/</em></li>
<li><em>http://localhost/list-of-members/etc/</em></li>
</ul>

<p>and retrieve the <code>:member</code> value in<code>changeVariation</code> (common and specific).</p>

<div class="highlight highlight-source-js"><pre><span class="pl-c1">exports</span>.<span class="pl-en">changeVariation</span> <span class="pl-k">=</span> <span class="pl-k">function</span> (<span class="pl-smi">params</span>, <span class="pl-smi">mainCallback</span>) {
    <span class="pl-k">var</span> variation <span class="pl-k">=</span> <span class="pl-smi">params</span>.<span class="pl-smi">variation</span>;

    <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-smi">variation</span>.<span class="pl-smi">params</span>.<span class="pl-smi">member</span>);
    <span class="pl-c">// \&gt; 'toto', 'bob-eponge99', 'node-atlas' or 'etc'.</span>

    <span class="pl-en">mainCallback</span>(variation);
}</pre></div>

<p>Dynamic url creation rules are those of <a href="http://expressjs.com/4x/api.html#req.params">Express.js</a>.</p>

<h4>
<a id="regular-expressions" class="anchor" href="#regular-expressions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Regular Expressions</h4>

<p>You can also enable regular expressions to a specific path with <code>regExp</code>. If it is <code>true</code>, the previous profile no longer works and you pass in Regular Expression mode. If <code>regExp</code> is a string, it acts as a flag (g, i, m or y).</p>

<p>See the following configuration:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/list-of-members/([-a-z0-9]+)/?<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>regExp<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>g<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/list-of-members/?<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>regExp<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">true</span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>you can access:</p>

<ul>
<li><em>http://localhost/</em></li>
<li>
<em>http://localhost/list-of-members/</em> <em>(ou <em>https://localhost/list-of-members</em>)</em>
</li>
<li>
<em>http://localhost/list-of-members/toto/</em> <em>(ou <em>https://localhost/list-of-members/toto</em>)</em>
</li>
<li>
<em>http://localhost/list-of-members/bob-eponge99/</em> <em>(ou <em>https://localhost/list-of-members/bob-eponge99</em>)</em>
</li>
<li>
<em>http://localhost/list-of-members/node-atlas/</em> <em>(ou <em>https://localhost/list-of-members/node-atlas</em>)</em>
</li>
<li>
<em>http://localhost/list-of-members/etc/</em> <em>(ou <em>https://localhost/list-of-members/etc</em>)</em>
</li>
</ul>

<p>and retrieve the <code>([-a-z0-9] +) value in the</code> <code>changeVariation</code> (common and specific).</p>

<div class="highlight highlight-source-js"><pre><span class="pl-c1">exports</span>.<span class="pl-en">changeVariation</span> <span class="pl-k">=</span> <span class="pl-k">function</span> (<span class="pl-smi">params</span>, <span class="pl-smi">mainCallback</span>) {
    <span class="pl-k">var</span> variation <span class="pl-k">=</span> <span class="pl-smi">params</span>.<span class="pl-smi">variation</span>;

    <span class="pl-k">if</span> (<span class="pl-smi">variation</span>.<span class="pl-smi">params</span> <span class="pl-k">&amp;&amp;</span> <span class="pl-smi">variation</span>.<span class="pl-smi">params</span>[<span class="pl-c1">0</span>]) { <span class="pl-smi">variation</span>.<span class="pl-smi">params</span>.<span class="pl-smi">member</span> <span class="pl-k">=</span> <span class="pl-smi">variation</span>.<span class="pl-smi">params</span>[<span class="pl-c1">0</span>]; }
    <span class="pl-c">// variation.params[1] for second match, etc...</span>

    <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-smi">variation</span>.<span class="pl-smi">params</span>.<span class="pl-smi">member</span>);
    <span class="pl-c">// \&gt; 'toto', 'bob-eponge99', 'node-atlas' or 'etc'.</span>

    <span class="pl-en">mainCallback</span>(variation);
}</pre></div>

<p>The rules for creating dynamic url with <code>regExp</code> are those of <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp">RegExpJavaScript</a>.</p>

<h4>
<a id="routing-in-a-shared-file" class="anchor" href="#routing-in-a-shared-file" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Routing in a shared file</h4>

<p>In order to not rewrite a long route list in <code>webconfig.json</code> file to your development environment and<code>webconfig.prod.json</code> to your production environment, you can group route in a file of your choice. By convention, the name is <code>routes.json</code> file.</p>

<p>For example:</p>

<p>The following set of file</p>

<pre><code>templates/
— index.htm
webconfig.json
webconfig.prod.json
</code></pre>

<p>with <code>webconfig.json</code></p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>httpPort<span class="pl-pds">"</span></span>: <span class="pl-c1">7777</span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>and with <code>webconfig.prod.json</code></p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>httpPort<span class="pl-pds">"</span></span>: <span class="pl-c1">7776</span>,
    <span class="pl-s"><span class="pl-pds">"</span>httpHostname<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>blog.lesieur.name<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>urlPort<span class="pl-pds">"</span></span>: <span class="pl-c1">80</span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>could be the following set of file</p>

<pre><code>templates/
— index.htm
routes.json
webconfig.json
webconfig.prod.json
</code></pre>

<p>with <code>webconfig.json</code></p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>httpPort<span class="pl-pds">"</span></span>: <span class="pl-c1">7777</span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>routes.json<span class="pl-pds">"</span></span>
}</pre></div>

<p>with <code>webconfig.prod.json</code></p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>httpPort<span class="pl-pds">"</span></span>: <span class="pl-c1">7776</span>,
    <span class="pl-s"><span class="pl-pds">"</span>httpHostname<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>blog.lesieur.name<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>urlPort<span class="pl-pds">"</span></span>: <span class="pl-c1">80</span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>routes.json<span class="pl-pds">"</span></span>
}</pre></div>

<p>and <code>routes.json</code></p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
    }
}</pre></div>

<p><em>Note : You can create multiple route file as <code>routes.en.json</code> and <code>routes.fr.json</code> and associate each of them in a set of webconfig parameterize to run a website in various languages.</em></p>

<h3>
<a id="manage-a-page-not-found" class="anchor" href="#manage-a-page-not-found" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Manage a page not found</h3>

<h4>
<a id="listen-all-urls-and-also-file-provide-by-assetsrelativepath" class="anchor" href="#listen-all-urls-and-also-file-provide-by-assetsrelativepath" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Listen all urls, and also file provide by <code>assetsRelativePath</code>
</h4>

<p>To display a custom page when a resource is not found you must:</p>

<ol>
<li>Prepare a 404 page.</li>
<li>Fill the parameter with <code>pageNotFound</code> with the following <code>value</code> : <code>key</code> of the prepared 404 page.</li>
</ol>

<p>See the example below:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>pageNotFound<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>/not-found-page/<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/list-of-members/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.htm<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/not-found-page/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>error.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>statusCode<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">404</span>
        }
    }
}</pre></div>

<p>you can access to:</p>

<ul>
<li><em>http://localhost/this-page-do-not-exist.html</em></li>
<li><em>http://localhost/this/page/either/</em></li>
<li><em>http://localhost/etc</em></li>
</ul>

<h4>
<a id="multilingual-error-page" class="anchor" href="#multilingual-error-page" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Multilingual Error Page</h4>

<p>For this, just create a new route with <code>*</code> at the end with the languageCode.</p>

<p>See below :</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>pageNotFound<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>/not-found-page/<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>languageCode<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>en-gb<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/list-of-members/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>variation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.json<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>variation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.json<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/not-found-page/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>error.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>variation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>error.json<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>statusCode<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">404</span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/francais/liste-des-membres/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>languageCode<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>fr-fr<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>variation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.json<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/francais/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>languageCode<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>fr-fr<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>variation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.json<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/francais/*<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>error.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>languageCode<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>fr-fr<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>variation<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>error.json<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>statusCode<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">404</span>
        }
    }
}</pre></div>

<h3>
<a id="manage-redirects" class="anchor" href="#manage-redirects" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Manage redirects</h3>

<p>To go to a different address (redirect 301 or 302) when you get to a url you must use the <code>redirect</code> parameter.</p>

<p><em>Note : if you don't set <code>statusCode</code>, no redirect will be executed. The <code>statusCode</code> is mandatory for redirection.</em></p>

<h4>
<a id="static" class="anchor" href="#static" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Static</h4>

<p>See the example below:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/list-of-members/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.htm<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/list-of-members<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>redirect<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>/list-of-members/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>statusCode<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">301</span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/go-to-node-atlas/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>redirect<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>http://haeresis.github.io/NodeAtlas/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>statusCode<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">302</span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>You will be redirected:</p>

<ul>
<li>to <code>http://localhost/list-of-members/</code> when you access <code>http://localhost/list-of-members</code> with a header <em>permanent redirect</em>.</li>
<li>to <code>http://haeresis.github.io/NodeAtlas/</code> when you access <code>http://localhost/go-to-node-atlas/</code> with a header <em>temporary redirect</em>.</li>
</ul>

<h4>
<a id="dynamic" class="anchor" href="#dynamic" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Dynamic</h4>

<p>See the example below:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/list-of-members/:member/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.htm<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/list-of-members/:member<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>redirect<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>/membres/:member/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>statusCode<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">301</span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>You will be redirected to <code>http://localhost/list-of-members/haeresis/</code> when you access to <code>http://localhost/list-of-members/haeresis</code> with a header <em>permanent redirect</em>.</p>

<h4>
<a id="with-regular-expressions" class="anchor" href="#with-regular-expressions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>With regular expressions</h4>

<p>See the example below:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/membres/([-a-z0-9]+)/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>regExp<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">true</span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/list-of-members/([-a-z0-9]+)/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>redirect<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>/membres/$0/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>statusCode<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">301</span>,
            <span class="pl-s"><span class="pl-pds">"</span>regExp<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">true</span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/list-of-members/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.htm<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>You will be redirected to <code>http://localhost/list-of-members/haeresis/</code> when you access to <code>http://localhost/list-of-members/haeresis</code> with a header <em>permanent redirect</em>.</p>

<p>For the second <em>match</em> use $1, the third $2, etc.</p>

<h3>
<a id="run-website-with-https" class="anchor" href="#run-website-with-https" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Run Website with HTTPs</h3>

<p>It is very simple to run an instance of NodeAtlas with HTTPs protocol. You just have to create such a <code>security</code> folder in which to place your <code>server.key</code> and <code>server.crt</code> file to supply the protocol. </p>

<p>Just use the following configuration:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>httpSecure<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">true</span>,
    <span class="pl-s"><span class="pl-pds">"</span>httpSecureRelativeKeyPath<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>security/server.key<span class="pl-pds">"</span></span>
    <span class="pl-s"><span class="pl-pds">"</span>httpSecureRelativeCertificatePath<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>security/server.crt<span class="pl-pds">"</span></span>
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>Alternatively , if your two Key and Certificate files have the same name, use this configuration:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>httpSecure<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>security/server<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<h3>
<a id="minify-cssjs" class="anchor" href="#minify-cssjs" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Minify CSS/JS</h3>

<p>You can automatically generate CSS and JS files minified and obfuscated by creating Bundles by referencing the file by input and output path. Of course you can do as much as you want. The gereration files is execute every time you start NodeAtlas either as a server or via the <code>--generate</code> command if a Bundle exists in the Webconfig.</p>

<h4>
<a id="creating-bundles" class="anchor" href="#creating-bundles" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Creating Bundles</h4>

<p>With the following configuration:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>bundles<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>javascript<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>javascript/boot.min.js<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
                <span class="pl-s"><span class="pl-pds">"</span>javascript/modernizr.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/yepnot.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/html5Shiv.js<span class="pl-pds">"</span></span>
            ],
            <span class="pl-s"><span class="pl-pds">"</span>javascript/framework.min.js<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
                <span class="pl-s"><span class="pl-pds">"</span>javascript/jquery.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/jquery-ui.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/prettify.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/prettify/run_prettify.js<span class="pl-pds">"</span></span>
            ],
            <span class="pl-s"><span class="pl-pds">"</span>javascript/common.min.js<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
                <span class="pl-s"><span class="pl-pds">"</span>javascript/components/extended-format-date.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/common.js<span class="pl-pds">"</span></span>
            ]
        },
        <span class="pl-s"><span class="pl-pds">"</span>stylesheets<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common.min.css<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
                <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common.css<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common-min780.css<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common-min1160.css<span class="pl-pds">"</span></span>
            ]
        }
    },
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>and the following set of file:</p>

<pre><code>assets/
— stylesheets/
—— common.css
—— common-min780.css
—— common-min1160.css
— javascript/
—— modernizr.js
—— yepnot.js
—— html5Shiv.js
—— jquery.js
—— jquery-ui.js
—— prettify.js
—— prettify/run_prettify.js
—— components/extended-format-date.js
—— common.js
templates/
— index.htm
webconfig.json
</code></pre>

<p>you will get the following new files:</p>

<pre><code>assets/
— stylesheets
—— common.css
—— common-min780.css
—— common-min1160.css
—— common.min.css               &lt;= new file
— javascript
—— modernizr.js
—— yepnot.js
—— html5Shiv.js
—— jquery.js
—— jquery-ui.js
—— prettify.js
—— prettify/run_prettify.js
—— components/extended-format-date.js
—— common.js
—— javascript/boot.min.js       &lt;= new file
—— javascript/framework.min.js  &lt;= new file
—— javascript/common.min.js     &lt;= new file
templates/
— index.htm
webconfig.json
</code></pre>

<h4>
<a id="bundles-in-a-shared-file" class="anchor" href="#bundles-in-a-shared-file" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Bundles in a shared file</h4>

<p>In order to not re-write a long Bundles configuration list in <code>webconfig.json</code> file to your development environment and<code>webconfig.prod.json</code> to your production environment, you can group routes in a file of your choice. By convention, the name is <code>bundles.json</code> file.</p>

<p>For example:</p>

<p>The following set of file</p>

<pre><code>assets/
— stylesheets/
—— common.css
—— common-min780.css
—— common-min1160.css
— javascript/
—— modernizr.js
—— yepnot.js
—— html5Shiv.js
—— jquery.js
—— jquery-ui.js
—— prettify.js
—— prettify/run_prettify.js
—— components/extended-format-date.js
—— common.js
templates/
— index.htm
webconfig.json
webconfig.prod.json
</code></pre>

<p>with <code>webconfig.json</code></p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>httpPort<span class="pl-pds">"</span></span>: <span class="pl-c1">7777</span>,
    <span class="pl-s"><span class="pl-pds">"</span>bundles<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>javascript<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>javascript/boot.min.js<span class="pl-pds">"</span></span>: [
                <span class="pl-s"><span class="pl-pds">"</span>javascript/modernizr.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/yepnot.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/html5Shiv.js<span class="pl-pds">"</span></span>
            ],
            <span class="pl-s"><span class="pl-pds">"</span>javascript/framework.min.js<span class="pl-pds">"</span></span>: [
                <span class="pl-s"><span class="pl-pds">"</span>javascript/jquery.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/jquery-ui.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/prettify.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/prettify/run_prettify.js<span class="pl-pds">"</span></span>
            ],
            <span class="pl-s"><span class="pl-pds">"</span>javascript/common.min.js<span class="pl-pds">"</span></span>: [
                <span class="pl-s"><span class="pl-pds">"</span>javascript/components/extended-format-date.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/common.js<span class="pl-pds">"</span></span>
            ]
        },
        <span class="pl-s"><span class="pl-pds">"</span>stylesheets<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common.min.css<span class="pl-pds">"</span></span>: [
                <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common.css<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common-min780.css<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common-min1160.css<span class="pl-pds">"</span></span>
            ]
        }
    },
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>and with <code>webconfig.prod.json</code></p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>httpPort<span class="pl-pds">"</span></span>: <span class="pl-c1">7776</span>,
    <span class="pl-s"><span class="pl-pds">"</span>httpHostname<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>blog.lesieur.name<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>urlPort<span class="pl-pds">"</span></span>: <span class="pl-c1">80</span>,
    <span class="pl-s"><span class="pl-pds">"</span>bundles<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>javascript<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>javascript/boot.min.js<span class="pl-pds">"</span></span>: [
                <span class="pl-s"><span class="pl-pds">"</span>javascript/modernizr.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/yepnot.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/html5Shiv.js<span class="pl-pds">"</span></span>
            ],
            <span class="pl-s"><span class="pl-pds">"</span>javascript/framework.min.js<span class="pl-pds">"</span></span>: [
                <span class="pl-s"><span class="pl-pds">"</span>javascript/jquery.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/jquery-ui.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/prettify.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/prettify/run_prettify.js<span class="pl-pds">"</span></span>
            ],
            <span class="pl-s"><span class="pl-pds">"</span>javascript/common.min.js<span class="pl-pds">"</span></span>: [
                <span class="pl-s"><span class="pl-pds">"</span>javascript/components/extended-format-date.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/common.js<span class="pl-pds">"</span></span>
            ]
        },
        <span class="pl-s"><span class="pl-pds">"</span>stylesheets<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common.min.css<span class="pl-pds">"</span></span>: [
                <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common.css<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common-min780.css<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common-min1160.css<span class="pl-pds">"</span></span>
            ]
        }
    },
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>could be the following set of file</p>

<pre><code>assets/
— stylesheets/
—— common.css
—— common-min780.css
—— common-min1160.css
— javascript/
—— modernizr.js
—— yepnot.js
—— html5Shiv.js
—— jquery.js
—— jquery-ui.js
—— prettify.js
—— prettify/run_prettify.js
—— components/extended-format-date.js
—— common.js
templates/
— index.htm
bundles.json
webconfig.json
webconfig.prod.json
</code></pre>

<p>with <code>webconfig.json</code></p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>httpPort<span class="pl-pds">"</span></span>: <span class="pl-c1">7777</span>,
    <span class="pl-s"><span class="pl-pds">"</span>bundles<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>bundles.json<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>with <code>webconfig.prod.json</code></p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>httpPort<span class="pl-pds">"</span></span>: <span class="pl-c1">7776</span>,
    <span class="pl-s"><span class="pl-pds">"</span>httpHostname<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>blog.lesieur.name<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>urlPort<span class="pl-pds">"</span></span>: <span class="pl-c1">80</span>,
    <span class="pl-s"><span class="pl-pds">"</span>bundles<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>bundles.json<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>and <code>bundles.json</code></p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>javascript<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>javascript/boot.min.js<span class="pl-pds">"</span></span>: [
            <span class="pl-s"><span class="pl-pds">"</span>javascript/modernizr.js<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>javascript/yepnot.js<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>javascript/html5Shiv.js<span class="pl-pds">"</span></span>
        ],
        <span class="pl-s"><span class="pl-pds">"</span>javascript/framework.min.js<span class="pl-pds">"</span></span>: [
            <span class="pl-s"><span class="pl-pds">"</span>javascript/jquery.js<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>javascript/jquery-ui.js<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>javascript/prettify.js<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>javascript/prettify/run_prettify.js<span class="pl-pds">"</span></span>
        ],
        <span class="pl-s"><span class="pl-pds">"</span>javascript/common.min.js<span class="pl-pds">"</span></span>: [
            <span class="pl-s"><span class="pl-pds">"</span>javascript/components/extended-format-date.js<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>javascript/common.js<span class="pl-pds">"</span></span>
        ]
    },
    <span class="pl-s"><span class="pl-pds">"</span>stylesheets<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common.min.css<span class="pl-pds">"</span></span>: [
            <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common.css<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common-min780.css<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common-min1160.css<span class="pl-pds">"</span></span>
        ]
    }
}</pre></div>

<p><em>Note : it is possible to disable Bundles by not including them in the <code>webconfig</code>.</em></p>

<h4>
<a id="disable-bundles" class="anchor" href="#disable-bundles" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Disable Bundles</h4>

<p>It is also possible to not execute the minification when run a website with NodeAtlas with <code>"stylesheetsBundlesEnable": false</code> et <code>"javascriptBundlesEnable": false</code>` for each type of Bundle.</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>stylesheetsBundlesEnable<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">false</span>,
    <span class="pl-s"><span class="pl-pds">"</span>javascriptBundlesEnable<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">false</span>,
    <span class="pl-s"><span class="pl-pds">"</span>bundles<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>javascript<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>javascript/boot.min.js<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
                <span class="pl-s"><span class="pl-pds">"</span>javascript/modernizr.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/yepnot.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/html5Shiv.js<span class="pl-pds">"</span></span>
            ],
            <span class="pl-s"><span class="pl-pds">"</span>javascript/framework.min.js<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
                <span class="pl-s"><span class="pl-pds">"</span>javascript/jquery.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/jquery-ui.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/prettify.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/prettify/run_prettify.js<span class="pl-pds">"</span></span>
            ],
            <span class="pl-s"><span class="pl-pds">"</span>javascript/common.min.js<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
                <span class="pl-s"><span class="pl-pds">"</span>javascript/components/extended-format-date.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/common.js<span class="pl-pds">"</span></span>
            ]
        },
        <span class="pl-s"><span class="pl-pds">"</span>stylesheets<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common.min.css<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
                <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common.css<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common-min780.css<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common-min1160.css<span class="pl-pds">"</span></span>
            ]
        }
    },
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p><em>Note : if your bundle is in shared file, you could desactivated it also without the <code>"bundles": "bundles.json"</code>. Just remove it.</em></p>

<h4>
<a id="re-generate-bundles-before-each-page-response" class="anchor" href="#re-generate-bundles-before-each-page-response" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Re-generate Bundles before each Page Response</h4>

<p>For test your page with minified files, you can ask it to be regenerated before each page response with <code>"stylesheetsBundlesBeforeResponse": false</code> et <code>"javascriptBundlesBeforeResponse": false</code>` for each type of Bundle.</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>stylesheetsBundlesBeforeResponse<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">false</span>,
    <span class="pl-s"><span class="pl-pds">"</span>javascriptBundlesBeforeResponse<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">false</span>,
    <span class="pl-s"><span class="pl-pds">"</span>bundles<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>javascript<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>javascript/boot.min.js<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
                <span class="pl-s"><span class="pl-pds">"</span>javascript/modernizr.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/yepnot.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/html5Shiv.js<span class="pl-pds">"</span></span>
            ],
            <span class="pl-s"><span class="pl-pds">"</span>javascript/framework.min.js<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
                <span class="pl-s"><span class="pl-pds">"</span>javascript/jquery.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/jquery-ui.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/prettify.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/prettify/run_prettify.js<span class="pl-pds">"</span></span>
            ],
            <span class="pl-s"><span class="pl-pds">"</span>javascript/common.min.js<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
                <span class="pl-s"><span class="pl-pds">"</span>javascript/components/extended-format-date.js<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>javascript/common.js<span class="pl-pds">"</span></span>
            ]
        },
        <span class="pl-s"><span class="pl-pds">"</span>stylesheets<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common.min.css<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
                <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common.css<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common-min780.css<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common-min1160.css<span class="pl-pds">"</span></span>
            ]
        }
    },
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p><em>Note : this is not recommanded for production environment because it's slowed responses pages.</em></p>

<h3>
<a id="css-generation-with-less" class="anchor" href="#css-generation-with-less" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>CSS generation with Less</h3>

<p>You can use the preprocessor Less to create your CSS. The operation is as follows: whenever a CSS request is made, if a Less equivalent exists it is read and it generates the CSS. Once done, the new CSS is responded.</p>

<p>With the following structure:</p>

<pre><code>assets/
— stylesheets
—— common.less
templates/
— index.htm
webconfig.json
</code></pre>

<p>and the following webconfig:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>enableLess<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">true</span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
    }
}</pre></div>

<p>and the following content in:</p>

<p><em>templates/index.htm</em></p>

<div class="highlight highlight-text-html-basic"><pre>&lt;!DOCTYPE html&gt;
&lt;<span class="pl-ent">html</span> <span class="pl-e">lang</span>=<span class="pl-s"><span class="pl-pds">"</span>en<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">head</span>&gt;
        &lt;<span class="pl-ent">meta</span> <span class="pl-e">charset</span>=<span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span>&gt;
        &lt;<span class="pl-ent">title</span>&gt;Less Test&lt;/<span class="pl-ent">title</span>&gt;
        &lt;<span class="pl-ent">link</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>stylesheet<span class="pl-pds">"</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>stylesheets/common.css<span class="pl-pds">"</span></span>&gt;
    &lt;/<span class="pl-ent">head</span>&gt;
    &lt;<span class="pl-ent">body</span>&gt;
        &lt;<span class="pl-ent">p</span>&gt;Test&lt;/<span class="pl-ent">p</span>&gt;
    &lt;/<span class="pl-ent">body</span>&gt;
&lt;/<span class="pl-ent">html</span>&gt;</pre></div>

<p><em>assets/stylesheets/common.less</em></p>

<div class="highlight highlight-source-css"><pre><span class="pl-ent">p</span> {
    <span class="pl-c1"><span class="pl-c1">color</span></span>: <span class="pl-c1">#f00</span>;
}</pre></div>

<p>you will build the <code>assets/stylesheets/common.css</code> by calling the url <code>http://localhost/</code> or <code>http://localhost/stylesheets/common.css</code>.</p>

<h4>
<a id="source-map-and-minification" class="anchor" href="#source-map-and-minification" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Source Map and Minification</h4>

<p>By default, in the above example, a <code>common.css.map</code> file will be generated. This allows your browser to indicated you that line in <code>.less</code>  file has generated the CSS property of the item you have selected in your debugger.</p>

<p>Disable this with <code>enableLess.sourceMap</code> to <code>false</code>:</p>

<pre><code>    "enableLess": {
        "sourceMap": false
    },
    "routes": {
        "/": "index.htm"
    }
</code></pre>

<p>You can also generate CSS files already minify with:</p>

<pre><code>    "enableLess": {
        "compress": true
    },
    "routes": {
        "/": "index.htm"
    }
</code></pre>

<h4>
<a id="compile-less-files-with---generate" class="anchor" href="#compile-less-files-with---generate" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Compile Less files with <code>--generate</code>
</h4>

<p>Because of Less are compilated on the fly, when a file is requested in http(s), modification needed running website for generate CSS output. Then you can use CSS. It's possible to skip running step and directly complated Less before minify CSS with <code>enableLess.less</code>.</p>

<p>With the following <code>webconfig.json</code>:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>enableLess<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>less<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
            <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common.less<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>stylesheets/component-1.less<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>stylesheets/component-2.less<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>stylesheets/component-3.less<span class="pl-pds">"</span></span>
        ]
    },
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
    }
}</pre></div>

<p>or with the following <code>webconfig.json</code>:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>enableLess<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>less<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>less.json<span class="pl-pds">"</span></span>
    },
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
    }
}</pre></div>

<p>with <code>less.json</code> containing :</p>

<div class="highlight highlight-source-js"><pre>[
    <span class="pl-s"><span class="pl-pds">"</span>stylesheets/common.less<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>stylesheets/component-1.less<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>stylesheets/component-2.less<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>stylesheets/component-3.less<span class="pl-pds">"</span></span>
]</pre></div>

<p>The <code>@import</code> used by Less will be capable to walk into subdirectories : <code>styles</code>, <code>stylesheets</code> or <code>css</code>. It's possible to change that with :</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>enableLess<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>paths<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
            <span class="pl-s"><span class="pl-pds">"</span>subdirectory/styles-files<span class="pl-pds">"</span></span>,
        ],
        <span class="pl-s"><span class="pl-pds">"</span>less<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>less.json<span class="pl-pds">"</span></span>
    },
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
    }
}</pre></div>

<h3>
<a id="optimize-images-files" class="anchor" href="#optimize-images-files" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Optimize Images files</h3>

<p>You can automatically generate optimized images files by creating Optimizations by referencing the file by input and output path. Of course you can do as much as you want. The optimization files is execute every time you start NodeAtlas either as a server or via the <code>--generate</code> command if an Optimization exists in the Webconfig.</p>

<h4>
<a id="creating-optimizations" class="anchor" href="#creating-optimizations" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Creating Optimizations</h4>

<p>With the following configuration:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>optimizations<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>images<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>media/images/example.png<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>media/images/example.jpg<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>media/images/example.gif<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>media/images/example.svg<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>
        }
    },
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>and the following set of file:</p>

<pre><code>assets/
— media/
—— images/
——— example.png
——— example.jpg
——— example.gif
——— example.svg
templates/
— index.htm
webconfig.json
</code></pre>

<p>you will get the following new files:</p>

<pre><code>assets/
— media/
—— images/
——— example.png
——— example.jpg
——— example.gif
——— example.svg
——— optimized/      &lt;= new folder
———— example.png    &lt;= new file
———— example.jpg    &lt;= new file
———— example.gif    &lt;= new file
———— example.svg    &lt;= new file
templates/
— index.htm
webconfig.json
</code></pre>

<h4>
<a id="create-optimizations-by-group-of-file" class="anchor" href="#create-optimizations-by-group-of-file" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Create Optimizations by group of file</h4>

<p>For example, not define file one by one, but in group:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>optimizations<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>images<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>media/images/*.{gif,jpg,png,svg}<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>
        }
    },
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<h4>
<a id="add-more-options-to-optimizations" class="anchor" href="#add-more-options-to-optimizations" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Add more options to Optimizations</h4>

<p>It is possible to redefine default options used for optimizations via this 4 objects:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>optimizations<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>jpg<span class="pl-pds">"</span></span><span class="pl-k">:</span> { <span class="pl-s"><span class="pl-pds">"</span>progressive<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">false</span> },
        <span class="pl-s"><span class="pl-pds">"</span>gif<span class="pl-pds">"</span></span><span class="pl-k">:</span> { <span class="pl-s"><span class="pl-pds">"</span>interlaced<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">false</span> },
        <span class="pl-s"><span class="pl-pds">"</span>png<span class="pl-pds">"</span></span><span class="pl-k">:</span> { <span class="pl-s"><span class="pl-pds">"</span>optimizationLevel<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">1</span> },
        <span class="pl-s"><span class="pl-pds">"</span>svg<span class="pl-pds">"</span></span><span class="pl-k">:</span> { <span class="pl-s"><span class="pl-pds">"</span>multipass<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">false</span> },
        <span class="pl-s"><span class="pl-pds">"</span>images<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>media/images/*.{gif,jpg,png,svg}<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>
        }
    },
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>To know all options it is here:</p>

<ul>
<li><a href="https://www.npmjs.com/package/imagemin-jpegtran">Jpeg Options</a></li>
<li><a href="https://www.npmjs.com/package/imagemin-gifsicle">Gif Options</a></li>
<li><a href="https://www.npmjs.com/package/imagemin-optipng">Png Options</a></li>
<li><a href="https://www.npmjs.com/package/imagemin-svgo">Svg Options</a></li>
</ul>

<h4>
<a id="optimizations-in-a-shared-file" class="anchor" href="#optimizations-in-a-shared-file" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Optimizations in a shared file</h4>

<p>In order to not re-write a long Bundles configuration list in <code>webconfig.json</code> file to your development environment and<code>webconfig.prod.json</code> to your production environment, you can group files in a file of your choice. By convention, the name is <code>optimizations.json</code> file.</p>

<p>For example:</p>

<p>The following set of file</p>

<pre><code>assets/
— media/
—— images/
——— example.png
——— example.jpg
——— example.gif
templates/
— index.htm
webconfig.json
webconfig.prod.json
</code></pre>

<p>with <code>webconfig.json</code></p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>httpPort<span class="pl-pds">"</span></span>: <span class="pl-c1">7777</span>,
    <span class="pl-s"><span class="pl-pds">"</span>optimizations<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>images<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>media/images/example.png<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>media/images/example.jpg<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>media/images/example.gif<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>media/images/example.svg<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>
        }
    },
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>and with <code>webconfig.prod.json</code></p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>httpPort<span class="pl-pds">"</span></span>: <span class="pl-c1">7776</span>,
    <span class="pl-s"><span class="pl-pds">"</span>httpHostname<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>blog.lesieur.name<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>urlPort<span class="pl-pds">"</span></span>: <span class="pl-c1">80</span>,
    <span class="pl-s"><span class="pl-pds">"</span>optimizations<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>images<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>media/images/example.png<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>media/images/example.jpg<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>media/images/example.gif<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>media/images/example.svg<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>
        }
    },
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>could be the following set of file</p>

<pre><code>assets/
— media/
—— images/
——— example.png
——— example.jpg
——— example.gif
——— example.svg
templates/
— index.htm
bundles.json
webconfig.json
webconfig.prod.json
</code></pre>

<p>with <code>webconfig.json</code></p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>httpPort<span class="pl-pds">"</span></span>: <span class="pl-c1">7777</span>,
    <span class="pl-s"><span class="pl-pds">"</span>optimizations<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>optimizations.json<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>with <code>webconfig.prod.json</code></p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>httpPort<span class="pl-pds">"</span></span>: <span class="pl-c1">7776</span>,
    <span class="pl-s"><span class="pl-pds">"</span>httpHostname<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>blog.lesieur.name<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>urlPort<span class="pl-pds">"</span></span>: <span class="pl-c1">80</span>,
    <span class="pl-s"><span class="pl-pds">"</span>optimizations<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>optimizations.json<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>and <code>optimizations.json</code></p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>images<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>media/images/example.png<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>media/images/example.jpg<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>media/images/example.gif<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>media/images/example.svg<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>
    }
}</pre></div>

<p><em>Note : it is possible to disable Optimizations by not including them in the <code>webconfig</code>.</em></p>

<h4>
<a id="disable-optimizations" class="anchor" href="#disable-optimizations" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Disable Optimizations</h4>

<p>It is also possible to not execute the optimization when run a website with NodeAtlas with <code>"imagesOptimizationsEnable": false</code>.</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>imagesOptimizationsEnable<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">false</span>,
    <span class="pl-s"><span class="pl-pds">"</span>optimizations<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>images<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>media/images/example.png<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>media/images/example.jpg<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>media/images/example.gif<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>media/images/example.svg<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>
        }
    },
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p><em>Note : if your optimizations is in shared file, you could desactivated it also without the <code>"optimizations": "optimizations.json"</code>. Just remove it.</em></p>

<h4>
<a id="re-generate-optimizations-before-each-page-response" class="anchor" href="#re-generate-optimizations-before-each-page-response" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Re-generate Optimizations before each Page Response</h4>

<p>You can ask files to be regenerated before each page response with <code>"stylesheetsBundlesBeforeResponse": false</code> et <code>"javascriptBundlesBeforeResponse": false</code>` for each type of Bundle.</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>imagesOptimizationsBeforeResponse<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">false</span>,
    <span class="pl-s"><span class="pl-pds">"</span>optimizations<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>images<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>media/images/example.png<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>media/images/example.jpg<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>media/images/example.gif<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>media/images/example.svg<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>media/images/optimized/<span class="pl-pds">"</span></span>
        }
    },
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p><em>Note : this is not recommanded for production environment because it's slowed responses pages.</em></p>

<h3>
<a id="css-inline-injection-for-manage-email-assets" class="anchor" href="#css-inline-injection-for-manage-email-assets" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>CSS Inline Injection for Manage Email Assets</h3>

<p>When you create templates for sending email newsletters, or even simple message, you can not attach stylesheet. The only way is to write the CSS instructions in the template within the <code>style</code> markup attribute.</p>

<h4>
<a id="specific-injection" class="anchor" href="#specific-injection" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Specific Injection</h4>

<p>With <code>injectCss</code>, simply design your template as usual via a stylesheet and NodeAtlas inject each rendering styles in the attribute <code>style</code>. It will do more than generate templates.</p>

<p>With for example the following configuration:</p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>email.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>generate<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>welcome.html<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>injectCss<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>stylesheets/email.css<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>and the following set of files:</p>

<pre><code>generates/
assets/
— stylesheets/
—— email.css
templates/
— email.htm
</code></pre>

<p>whose contents are :</p>

<p><strong>stylesheets/common.css</strong></p>

<div class="highlight highlight-source-css"><pre><span class="pl-ent">body</span> {
    <span class="pl-c1"><span class="pl-c1">color</span></span>: <span class="pl-c1">#f00</span>;
}</pre></div>

<p><strong>templates/email.htm</strong>*</p>

<div class="highlight highlight-text-html-basic"><pre>&lt;!DOCTYPE html&gt;
&lt;<span class="pl-ent">html</span> <span class="pl-e">lang</span>=<span class="pl-s"><span class="pl-pds">"</span>en<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">head</span>&gt;
        &lt;<span class="pl-ent">meta</span> <span class="pl-e">charset</span>=<span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span>&gt;
        &lt;<span class="pl-ent">title</span>&gt;Email&lt;/<span class="pl-ent">title</span>&gt;
    &lt;/<span class="pl-ent">head</span>&gt;
    &lt;<span class="pl-ent">body</span>&gt;
        &lt;<span class="pl-ent">p</span>&gt;This is a template email.&lt;/<span class="pl-ent">p</span>&gt;
    &lt;/<span class="pl-ent">body</span>&gt;
&lt;/<span class="pl-ent">html</span>&gt;</pre></div>

<p>output will be, with the command <code>node &lt;/path/to/&gt;node-atlas/node-atlas.js --generate</code>, all following file:</p>

<pre><code>generates/
— welcome.html    &lt;= template email generate !
assets/
— stylesheets/
—— email.css
templates/
— email.htm
</code></pre>

<p>with as content for <code>generates/welcome.html</code></p>

<div class="highlight highlight-text-html-basic"><pre>&lt;!DOCTYPE html&gt;
&lt;<span class="pl-ent">html</span> <span class="pl-e">lang</span>=<span class="pl-s"><span class="pl-pds">"</span>en<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">head</span>&gt;
        &lt;<span class="pl-ent">meta</span> <span class="pl-e">charset</span>=<span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span>&gt;
        &lt;<span class="pl-ent">title</span>&gt;Email&lt;/<span class="pl-ent">title</span>&gt;
    &lt;/<span class="pl-ent">head</span>&gt;
    &lt;<span class="pl-ent">body</span> <span class="pl-e">style</span>=<span class="pl-s"><span class="pl-pds">"</span>color: #f00;<span class="pl-pds">"</span></span>&gt;
        &lt;<span class="pl-ent">p</span>&gt;This is a template email.&lt;/<span class="pl-ent">p</span>&gt;
    &lt;/<span class="pl-ent">body</span>&gt;
&lt;/<span class="pl-ent">html</span>&gt;</pre></div>

<p>This mechanism also works if you do not intend to generate anything but a site that is running. Convenient to change your live models before generating.</p>

<blockquote>
<p>Test : From <code>./tests/examples/css-injection</code> run <code>node "../../../node-atlas.js" --generate</code>. Result are into <code>generates</code>.</p>
</blockquote>

<h4>
<a id="global-injection" class="anchor" href="#global-injection" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Global Injection</h4>

<p>It is possible to use <code>injectCss</code> as global mechanism for all pages.</p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>injectCss<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>stylesheets/email.css<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>/welcome/<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>email-a.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>generate<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>welcome.html<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/good-bye/<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>email-b.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>generate<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>good-bye.html<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>ainsi les deux pages <code>welcome</code> et <code>good-bye</code> contiendront chacune <code>&lt;body style="color: #f00;"&gt;</code>.</p>

<h4>
<a id="multiple-injection" class="anchor" href="#multiple-injection" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Multiple Injection</h4>

<p>It's possible to :</p>

<ul>
<li>Attach global and specific files in same time.</li>
<li>Attach more one CSS file by <code>injectCss</code> property.</li>
</ul>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>injectCss<span class="pl-pds">"</span></span>: [<span class="pl-s"><span class="pl-pds">"</span>stylesheets/reset.css<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>stylesheets/email.css<span class="pl-pds">"</span></span>],
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>/welcome/<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>email-a.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>generate<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>welcome.html<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>injectCss<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>/stylesheets/welcome.css<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/good-bye/<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>email-b.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>generate<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>good-bye.html<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>injectCss<span class="pl-pds">"</span></span>: [<span class="pl-s"><span class="pl-pds">"</span>stylesheets/good-bye.css<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>/stylesheets/others.css<span class="pl-pds">"</span></span>]
        }
    }
}</pre></div>

<blockquote>
<p>Test : From <code>./tests/examples/css-injection</code> run <code>node "../../../node-atlas.js" --generate --webconfig webconfig.multiple.json</code>. Result are into <code>generates</code>.</p>
</blockquote>

<h3>
<a id="allowdisallow-getpost-requests" class="anchor" href="#allowdisallow-getpost-requests" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Allow/Disallow GET/POST requests</h3>

<p>You can also manager how the server will respond to requests GET/POST to a given page. For example, we will allow access to pages only GET for the whole site and allow a POST to one page only (and prohibited him GET).</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>getSupport<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">true</span>,
    <span class="pl-s"><span class="pl-pds">"</span>postSupport<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">false</span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/list-of-members/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>members.htm<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/write-comment/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>write-com.htm<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/save-comment/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>save-com.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>getSupport<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">false</span>,
            <span class="pl-s"><span class="pl-pds">"</span>postSupport<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">true</span>
        }
    }
}</pre></div>

<p><em>Note : If nothing is set,</em> <strong><em>getSupport</em></strong> <em>and</em> <strong><em>postSupport</em></strong> <em>are set to</em> <strong><em>true</em></strong> <em>in  global webconfig and by route.</em></p>

<h3>
<a id="change-settings-of-sessions" class="anchor" href="#change-settings-of-sessions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Change settings of Sessions</h3>

<h4>
<a id="key-and-secret" class="anchor" href="#key-and-secret" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Key and Secret</h4>

<p>NodeAtlas itself manages sessions stored on the server as initial settings:</p>

<ul>
<li>Key : <code>nodeatlas.sid</code>
</li>
<li>Secret : <code>1234567890bépo</code>
</li>
</ul>

<p>that allow customers to stay connected through the pages to a single set of personal server side variable.</p>

<p>It is possible to change the default settings (and even compulsory for productions sites) with the parameters of <code>webconfig.json</code> following:</p>

<div class="highlight highlight-source-js"><pre>{
    sessionKey<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>personal key<span class="pl-pds">"</span></span>,
    sessionSecret<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>personal secret<span class="pl-pds">"</span></span>
}</pre></div>

<p>NodeAtlas also employs a memory storage object (MemoryStore) stoques that the information in the RAM of the server.</p>

<h4>
<a id="other-parameters" class="anchor" href="#other-parameters" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Other Parameters</h4>

<p>It is possible to change all the parameters of the sessions (except MemoryStore) using the configuration of next <code>webconfig.json</code>:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>session<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>personal key<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>secret<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>personal secret<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>cookie<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>path<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>/<span class="pl-pds">'</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>httpOnly<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">true</span>,
            <span class="pl-s"><span class="pl-pds">"</span>secure<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">false</span>,
            <span class="pl-s"><span class="pl-pds">"</span>maxAge<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">null</span>
        },
        <span class="pl-k">...</span>,
        <span class="pl-k">...</span>,
        <span class="pl-k">...</span>
    }
}</pre></div>

<p>The entirety of the possible configuration is located on the module documentation <a href="https://github.com/expressjs/session">express-session</a>.</p>

<h3>
<a id="external-storage-sessions" class="anchor" href="#external-storage-sessions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>External Storage Sessions</h3>

<p>By default, this is NodeAtlas server that stores sessions in the RAM of the server application. This does not allow users to share sessions across multiple applications NodeAtlas (or other) and erases all current sessions for an application if you restart it.</p>

<p>To address this concern, it should support the recording sessions via a base No SQL such as <code>Redis</code> or <code>MongoBD</code>.</p>

<p>You just have to use the <code>setSessions</code> function in<code>controllers/common.js</code> of <a href="#use-nodeatlas-to-run-a-website-back-end-part">partie Back-end</a>.</p>

<h4>
<a id="session-managed-with-redis" class="anchor" href="#session-managed-with-redis" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Session managed with Redis</h4>

<p>Implement the following code in <code>controllers/common.js</code> to store your sessions in a local Redis.</p>

<pre><code>var website = {};

(function (publics) {
    "use strict";

    publics.loadModules = function (NA) {
        var NA = this;

        NA.modules.RedisStore = require('connect-redis');
    };

    publics.setSessions = function (callback) {
        var NA = this,
            session = NA.modules.session,
            RedisStore = NA.modules.RedisStore(session);

        NA.sessionStore = new RedisStore();

        callback();
    };

}(website));

exports.loadModules = website.loadModules;
exports.setSessions = website.setSessions;
</code></pre>

<p>More information to <a href="https://www.npmjs.org/package/connect-redis">connect-redis</a> page.</p>

<h4>
<a id="session-managed-with-mongodb" class="anchor" href="#session-managed-with-mongodb" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Session managed with MongoDB</h4>

<p>Implement the following code in <code>controllers/common.js</code> to store sessions in the database <code>sessions</code> of a local MongoDB.</p>

<pre><code>var website = {};

(function (publics) {
    "use strict";

    publics.loadModules = function () {
        var NA = this;

        NA.modules.MongoStore = require('connect-mongo');
    };

    publics.setSessions = function (callback) {
        var NA = this,
            session = NA.modules.session,
            MongoStore = NA.modules.MongoStore(session);

        NA.sessionStore = new MongoStore({
            db: 'sessions'
        });

        callback();
    };

}(website));

exports.loadModules = website.loadModules;
exports.setSessions = website.setSessions;
</code></pre>

<p>More information to <a href="https://www.npmjs.org/package/connect-mongo">connect-redis</a> page.</p>

<h3>
<a id="changing-the-template-engine-brackets--" class="anchor" href="#changing-the-template-engine-brackets--" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Changing the template engine brackets &lt;% %&gt;</h3>

<p>For example, to include part of a file instruction is used <strong><em>&lt;%- include('head.htm') %&gt;</em></strong>. It would be possible to do it with <strong><em>&lt;?- include('head.htm') ?&gt;</em></strong> with the configuration below:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>templateEngineDelimiter<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>?<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>See the exemple in files below:</p>

<p><em>components/head.htm</em></p>

<div class="highlight highlight-text-html-basic"><pre>&lt;!DOCTYPE html&gt;
&lt;<span class="pl-ent">html</span> <span class="pl-e">lang</span>=<span class="pl-s"><span class="pl-pds">"</span>fr-fr<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">head</span>&gt;
        &lt;<span class="pl-ent">meta</span> <span class="pl-e">charset</span>=<span class="pl-s"><span class="pl-pds">"</span>utf-8<span class="pl-pds">"</span></span> /&gt;
        &lt;<span class="pl-ent">title</span>&gt;&lt;?= specific.titlePage ?&gt;&lt;/<span class="pl-ent">title</span>&gt;

        &lt;<span class="pl-ent">link</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>text/css<span class="pl-pds">"</span></span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>stylesheet<span class="pl-pds">"</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>stylesheets/&lt;?= common.classCssCommon ?&gt;.css<span class="pl-pds">"</span></span> <span class="pl-e">media</span>=<span class="pl-s"><span class="pl-pds">"</span>all<span class="pl-pds">"</span></span> /&gt;
        &lt;<span class="pl-ent">link</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>text/css<span class="pl-pds">"</span></span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>stylesheet<span class="pl-pds">"</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>stylesheets/&lt;?= specific.classPage ?&gt;.css<span class="pl-pds">"</span></span> <span class="pl-e">media</span>=<span class="pl-s"><span class="pl-pds">"</span>all<span class="pl-pds">"</span></span> /&gt;
    &lt;/<span class="pl-ent">head</span>&gt;
    &lt;<span class="pl-ent">body</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">"</span>&lt;?= specific.classPage ?&gt;<span class="pl-pds">"</span></span>&gt;</pre></div>

<p><em>components/foot.htm</em></p>

<div class="highlight highlight-text-html-basic"><pre><span class="pl-s1">        &lt;<span class="pl-ent">script</span> <span class="pl-e">async</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>text/javascript<span class="pl-pds">"</span></span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>javascript/&lt;?= common.classJsCommon ?&gt;.js<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span>
    &lt;/<span class="pl-ent">body</span>&gt;
&lt;/<span class="pl-ent">html</span>&gt;</pre></div>

<p><em>templates/template.htm</em></p>

<div class="highlight highlight-text-html-basic"><pre>    &lt;? include('head.htm') ?&gt;

    &lt;<span class="pl-ent">div</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>&gt;&lt;?= common.titleWebsite ?&gt;&lt;/<span class="pl-ent">div</span>&gt;

    &lt;<span class="pl-ent">div</span>&gt;
        &lt;<span class="pl-ent">h1</span>&gt;&lt;?= specific.titlePage ?&gt;&lt;/<span class="pl-ent">h1</span>&gt;
        &lt;?- specific.content ?&gt;
    &lt;/<span class="pl-ent">div</span>&gt;

    &lt;? include('foot.htm') ?&gt;</pre></div>

<p>Learn all about the possibilities of the template engine consult the documentation <a href="https://github.com/mde/ejs">ejs</a></p>

<p><em>Note : If nothing is set,</em> <strong><em>templateEngineDelimiter</em></strong> <em>is set to</em> <strong><em>%</em></strong>.</p>

<h3>
<a id="change-the-url-hostname-and-listening-port" class="anchor" href="#change-the-url-hostname-and-listening-port" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Change the url hostname and listening port</h3>

<p>It is possible to generate a different url listening other port with <strong><em>urlHostname</em></strong> *** and <strong><em>urlPort</em></strong>. For example, the local loop listens on port 80 for a script makes the Reverse Proxy from the port 7777 on the 80 with the "http-proxy" module as below:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>httpPort<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">7777</span>,
    <span class="pl-s"><span class="pl-pds">"</span>httpHostname<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>127.0.0.1<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>urlPort<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">80</span>,
    <span class="pl-s"><span class="pl-pds">"</span>urlHostname<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>It's also possible to avoid other enter url. Also if <code>www.localhost</code> or <code>localhost:7777</code> are enter into url area, it's <code>localhost</code> for the user :</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>enableForceDomain<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">true</span>,
    <span class="pl-s"><span class="pl-pds">"</span>httpPort<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">7777</span>,
    <span class="pl-s"><span class="pl-pds">"</span>httpHostname<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>127.0.0.1<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>urlPort<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">80</span>,
    <span class="pl-s"><span class="pl-pds">"</span>urlHostname<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<h3>
<a id="generate-urls-dynamically" class="anchor" href="#generate-urls-dynamically" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Generate urls dynamically</h3>

<h4>
<a id="relative-paths-in-absolute" class="anchor" href="#relative-paths-in-absolute" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Relative paths in absolute</h4>

<p>It is possible that the paths created from your url to be interpreted as subfolders that have actually no real existence. This has the effect the address <code>media/images/example.jpg</code> initially accessible from template displayed to address <strong>http://localhost</strong><code>impossible to reach when the template is displayed to address **http://localhost/sub-directory/** (because the path should be</code>../media/images/example.jpg`).</p>

<p>To no longer have to worry about access to resources regardless of the URL that is requested, simply turn on all the urls such as:</p>

<pre><code>&lt;link rel="stylesheet" type="text/css" href="stylesheets/common.css" /&gt;
&lt;!-- ... --&gt;
&lt;img src="media/images/example.jpg" /&gt;
&lt;!-- ... --&gt;
&lt;script type="text/javascript" src="javascript/common.js"&gt;&lt;/script&gt;
</code></pre>

<p>in absolute urls with variable <code>urlBasePath</code> as below:</p>

<pre><code>&lt;link rel="stylesheet" type="text/css" href="&lt;%= urlBasePath %&gt;stylesheets/common.css" /&gt;
&lt;!-- ... --&gt;
&lt;img src="&lt;%= urlBasePath %&gt;media/images/example.jpg" /&gt;
&lt;!-- ... --&gt;
&lt;script type="text/javascript" src="&lt;%= urlBasePath %&gt;javascript/common.js"&gt;&lt;/script&gt;
</code></pre>

<p>Note that in the case of the following configuration:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p><code>urlBasePath</code> return <code>http://localhost/</code> while in this configuration:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>httpPort<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">7777</span>,
    <span class="pl-s"><span class="pl-pds">"</span>urlRelativeSubPath<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>sub/folder<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p><code>urlBasePath</code> return <code>http://localhost:7777/sub/folder/</code>.</p>

<h4>
<a id="the-paths-of-templates" class="anchor" href="#the-paths-of-templates" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The paths of templates</h4>

<p>Using the following webconfig:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/index.html<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/contact.html<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>contact.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>and the corresponding template</p>

<div class="highlight highlight-text-html-basic"><pre><span class="pl-c">&lt;!-- ... --&gt;</span>
&lt;<span class="pl-ent">a</span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>http://localhost/index.html<span class="pl-pds">"</span></span>&gt;Link to home&lt;/<span class="pl-ent">a</span>&gt;
&lt;<span class="pl-ent">a</span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>http://localhost/contact.html<span class="pl-pds">"</span></span>&gt;Link to contact&lt;/<span class="pl-ent">a</span>&gt;
<span class="pl-c">&lt;!-- ... --&gt;</span></pre></div>

<p>I'd have to change my link in the template if I change the listening port or if I change the path of the url. The following configuration changes:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>httpPort<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">7777</span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>/home.html<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>/contact-us.html<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>contact.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>me contraindrait à modifier le template précédent comme suit :</p>

<div class="highlight highlight-text-html-basic"><pre><span class="pl-c">&lt;!-- ... --&gt;</span>
&lt;<span class="pl-ent">a</span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>http://localhost:7777/home.html<span class="pl-pds">"</span></span>&gt;Link to home&lt;/<span class="pl-ent">a</span>&gt;
&lt;<span class="pl-ent">a</span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>http://localhost:7777/contact-us.html<span class="pl-pds">"</span></span>&gt;Link to contact&lt;/<span class="pl-ent">a</span>&gt;
<span class="pl-c">&lt;!-- ... --&gt;</span></pre></div>

<p>You can solve this problem by giving a key to a specific path and deporting are way in the <code>url</code> property.</p>

<p>With the followinh webconfig:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>index<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>url<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>/index.html<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>contact<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>url<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>/contact.html<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>contact.htm<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>I can now write the link in the dynamic template:</p>

<ol>
<li>
<p>as follows</p>

<div class="highlight highlight-text-html-basic"><pre><span class="pl-c">&lt;!-- ... --&gt;</span>
&lt;<span class="pl-ent">a</span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>&lt;%= urlBasePath %&gt;&lt;%= webconfig.routes.home.url.slice(1) %&gt;<span class="pl-pds">"</span></span>&gt;Link to home&lt;/<span class="pl-ent">a</span>&gt;
&lt;<span class="pl-ent">a</span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>&lt;%= urlBasePath %&gt;&lt;%= webconfig.routes.contact.url.slice(1) %&gt;<span class="pl-pds">"</span></span>&gt;Link to contact&lt;/<span class="pl-ent">a</span>&gt;
<span class="pl-c">&lt;!-- ... --&gt;</span></pre></div>

<p><em>Note : <code>.slice(1)</code> makes it easy to remove the dual <code>/</code> for standard url.</em></p>
</li>
<li>
<p>or as follows</p>

<div class="highlight highlight-text-html-basic"><pre><span class="pl-c">&lt;!-- ... --&gt;</span>
&lt;<span class="pl-ent">a</span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>&lt;%= urlBasePath %&gt;.&lt;%= webconfig.routes.home.url %&gt;<span class="pl-pds">"</span></span>&gt;Link to home&lt;/<span class="pl-ent">a</span>&gt;
&lt;<span class="pl-ent">a</span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>&lt;%= urlBasePath %&gt;.&lt;%= webconfig.routes.contact.url %&gt;<span class="pl-pds">"</span></span>&gt;Link to contact&lt;/<span class="pl-ent">a</span>&gt;
<span class="pl-c">&lt;!-- ... --&gt;</span></pre></div>

<p><em>Note : This would, for example <code>http://localhost/./home.html</code>, which is a standard url.</em></p>
</li>
<li>
<p>ou comme suit</p>

<div class="highlight highlight-text-html-basic"><pre><span class="pl-c">&lt;!-- ... --&gt;</span>
&lt;<span class="pl-ent">a</span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>&lt;%= urlBasePathSlice + webconfig.routes.home.url %&gt;<span class="pl-pds">"</span></span>&gt;Link to home&lt;/<span class="pl-ent">a</span>&gt;
&lt;<span class="pl-ent">a</span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>&lt;%= urlBasePathSlice + webconfig.routes.contact.url %&gt;<span class="pl-pds">"</span></span>&gt;Link to contact&lt;/<span class="pl-ent">a</span>&gt;
<span class="pl-c">&lt;!-- ... --&gt;</span></pre></div>

<p><em>Note : <code>urlBasePathSlice</code> return <code>http://localhost</code> in place of <code>http://localhost/</code> or <code>http://localhost:7777/sub/folder</code> in place of <code>http://localhost:7777/sub/folder/</code>.</em></p>
</li>
</ol>

<h4>
<a id="utilisation-de-la-clé-pour-mapper-les-pages" class="anchor" href="#utilisation-de-la-cl%C3%A9-pour-mapper-les-pages" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Utilisation de la clé pour mapper les pages</h4>

<p>It's maybe useful to know the key used for the current page displayed for find the equivalent page in an other language.</p>

<p>With the following webconfig :</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>languageCode<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>en-us<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>index_en-us<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>url<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>/index.htm<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>index_fr-fr<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>url<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>/francais/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>languageCode<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>fr-fr<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>cv_en-us<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>url<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>/resume/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>cv.htm<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>cv_fr-fr<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>url<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>/francais/cv/<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>template<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>index.htm<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>languageCode<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>fr-fr<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>and the common variation following :</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>language<span class="pl-pds">"</span></span><span class="pl-k">:</span> [{
        <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>English<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>code<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>en-us<span class="pl-pds">"</span></span>
    }, {
        <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>French<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>code<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>fr-fr<span class="pl-pds">"</span></span>
    }]
}</pre></div>

<p>in fr :</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>language<span class="pl-pds">"</span></span><span class="pl-k">:</span> [{
        <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Anglais<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>code<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>en-us<span class="pl-pds">"</span></span>
    }, {
        <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Français<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>code<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>fr-fr<span class="pl-pds">"</span></span>
    }]
}</pre></div>

<p>we could create link between each page as following :</p>

<div class="highlight highlight-text-html-basic"><pre>&lt;<span class="pl-ent">ul</span>&gt;
    &lt;% for (var i = 0; i &lt; common.language.length; i++) { %&gt;
    &lt;<span class="pl-ent">li</span>&gt;&lt;<span class="pl-ent">a</span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>&lt;%= urlBasePathSlice + webconfig.routes[currentRouteName.split('_')[0] + '_' + common.language[i].code].url %&gt;<span class="pl-pds">"</span></span>&gt;&lt;%- common.language[i].name %&gt;&lt;/<span class="pl-ent">a</span>&gt;&lt;/<span class="pl-ent">li</span>&gt;
    &lt;% } %&gt;
&lt;/<span class="pl-ent">ul</span>&gt;</pre></div>

<h2>
<a id="cli--running-commands" class="anchor" href="#cli--running-commands" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>CLI / Running commands</h2>

<p>The easiest way to start is to position NodeAtlas in the directory hosting your site and run the command <code>\&gt; node &lt;/path/to/&gt;node-atlas/node-atlas.js</code>. However there are options to launch more than launch the site.</p>

<p>Each of the commands that follow can be coupled with other like this:</p>

<pre><code>\&gt; node &lt;/path/to/&gt;node-atlas/node-atlas.js --directory /hello-world/ --webconfig config.fr-fr.js --httpPort 80 --browse
</code></pre>

<h3>
<a id="--directory" class="anchor" href="#--directory" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>--directory</h3>

<p>It is possible to launch NodeAtlas from another location where the website folder is placed. The <code>--directory</code> command will be very useful.</p>

<pre><code>\&gt; node &lt;/path/to/&gt;node-atlas/node-atlas.js --directory &lt;/path/to/your/website/directory/&gt;
</code></pre>

<h3>
<a id="--webconfig" class="anchor" href="#--webconfig" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>--webconfig</h3>

<p>By default, NodeAtlas will read your <code>webconfig.json</code> file. It is possible that in addition to the file you created another <code>webconfig.prod.json</code> file whose domain name is different. Or a <code>webconfig.fr-fr.json</code> with urls changes for another language. Instead of renaming your files in <code>webconfig.json</code> before launching the site, simply enter your other configuration name. In the following example, this file will be <code>webconfig.alternatif.json</code>.</p>

<pre><code>\&gt; node &lt;/path/to/&gt;node-atlas/node-atlas.js --webconfig webconfig.alternatif.json
</code></pre>

<h3>
<a id="--browse" class="anchor" href="#--browse" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>--browse</h3>

<p>This command opens your browser to the address on which the site will run. Very handy when you do not remember the port for your development version. This command is useless if it is coupled with <code>--generate</code> (see below).</p>

<pre><code>\&gt; node &lt;/path/to/&gt;node-atlas/node-atlas.js --browse
</code></pre>

<p>You could also targeted a specific page with the end of url.</p>

<pre><code>\&gt; node &lt;/path/to/&gt;node-atlas/node-atlas.js --browse index.html
</code></pre>

<h3>
<a id="--httpport" class="anchor" href="#--httpport" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>--httpPort</h3>

<p>You will not be bored to change your listening port on your projects and sometimes you'll have to work on two different websites simultaneously. With this command you will not need to cut your sites turn to release the listener, simply pick one at launch.</p>

<pre><code>\&gt; node &lt;/path/to/&gt;node-atlas/node-atlas.js --httpPort 7778
</code></pre>

<h3>
<a id="--generate" class="anchor" href="#--generate" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>--generate</h3>

<p>If you change an item in your common variation file or even your template components called in multiple pages, you will not reload each page to update your output files. If so, simply use <code>--generate</code>. This command will copy the entire contents of the folder <code>assetsRelativePath</code> into <code>generatesRelativePath</code> if their path is different.</p>

<pre><code>\&gt; node &lt;/path/to/&gt;node-atlas/node-atlas.js --generate
</code></pre>

<h2>
<a id="api--nodeatlas-as-npm-module" class="anchor" href="#api--nodeatlas-as-npm-module" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>API / NodeAtlas as npm module</h2>

<p>If you start NodeAtlas via JavaScript code, you can also configure the launch:</p>

<p><em>server.js</em></p>

<div class="highlight highlight-source-js"><pre><span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">"</span>node-atlas<span class="pl-pds">"</span></span>)().<span class="pl-en">run</span>({
    directory<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;/path/to/your/website/directory/&gt;<span class="pl-pds">"</span></span>,
    webconfig<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>webconfig.alternatif.json<span class="pl-pds">"</span></span>,
    browse<span class="pl-k">:</span> <span class="pl-c1">true</span>,
    httpPort<span class="pl-k">:</span> <span class="pl-c1">7778</span>,
    generate<span class="pl-k">:</span> <span class="pl-c1">true</span>
});</pre></div>

<pre><code>\&gt; server server.js
</code></pre>

<p>You can run multiple website in same time. Each webconfig must listen a different port.</p>

<p><em>servers.js</em></p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> nodeAtlas <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">"</span>node-atlas<span class="pl-pds">"</span></span>),
    websiteEn <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">nodeAtlas</span>(),
    websiteFr <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">nodeAtlas</span>();

<span class="pl-smi">websiteEn</span>.<span class="pl-en">run</span>({
    <span class="pl-s"><span class="pl-pds">"</span>browse<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">true</span>,
    <span class="pl-s"><span class="pl-pds">"</span>webconfig<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>webconfig.english.json<span class="pl-pds">"</span></span>
});
<span class="pl-smi">websiteFr</span>.<span class="pl-en">run</span>({
    <span class="pl-s"><span class="pl-pds">"</span>browse<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">true</span>,
    <span class="pl-s"><span class="pl-pds">"</span>webconfig<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>webconfig.french.json<span class="pl-pds">"</span></span>
});</pre></div>

<pre><code>
You could also execute other tasks after assets generation:

*servers.js*

```javascript
require("node-atlas")().afterGeneration(function() {
    require('child_process').exec(__dirname + "/documentation.bat", function (err, stdout, stderr) {
        console.log("Documentation generation...");
        console.log(stdout);
        console.log("Documentation generation done !");
    });
}).run({
    generate: true
});
</code></pre>

<h2>
<a id="nodeatlas-as-a-simple-web-server" class="anchor" href="#nodeatlas-as-a-simple-web-server" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>NodeAtlas as a simple web server</h2>

<p>If NodeAtlas can not find the "webconfig.json" or <code>--webconfig</code> you have specify, it will run in either "Simple Web Server" or "Public" mode.</p>

<p><strong>This mode is useful for testing very quickly that NodeAtlas is installed properly or to create small HTML examples that need to run a web server (AJAX returns, embedded iframe, etc.).</strong></p>

<p>To understand what this means: if there is any file in the directory where NodeAtlas was launched, it will be returned by HTTP request so have the demands via its path.</p>

<p>For example, by launching NodeAtlas in the <code>site-hello-world</code> folder</p>

<pre><code>site-hello-world/
— templates/
—— index.htm
— webconfig.json
</code></pre>

<p>by running the command</p>

<pre><code>\&gt; node &lt;/path/to/&gt;node-atlas/node-atlas.js
</code></pre>

<p>or even the command</p>

<pre><code>\&gt; node &lt;/path/to/&gt;node-atlas/node-atlas.js --webconfig webconfig.not-exist.json
</code></pre>

<p>the server will run in "Simple Web Server" mode and file "http://localhost/webconfig.json" or "http://localhost/templates/webconfig.htm" will be available as the browser could refer as a simple web server.</p>

<p><em>Note : only commands <code>--webconfig</code>, <code>--browse</code>, <code>--directory</code> and <code>--httpPort</code> work in this mode.</em></p>

<h2>
<a id="running-nodeatlas-on-online-server" class="anchor" href="#running-nodeatlas-on-online-server" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Running NodeAtlas on online server</h2>

<h3>
<a id="in-a-windows-server-environment-with-iisnode" class="anchor" href="#in-a-windows-server-environment-with-iisnode" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>In a Windows Server environment with iisnode</h3>

<p>In a Windows Server 2013 environment with IIS8 the requirements are:</p>

<ol>
<li>Install <a href="http://nodejs.org/download/">the node.exe executable</a> able to run JavaScript code.</li>
<li>Install <a href="http://www.iis.net/downloads/microsoft/url-rewrite">the IIS8 UrlRewrite module</a> to map pages executed to an output URL.</li>
<li>Install <a href="https://github.com/tjanczuk/iisnode/downloads">the IIS8 issnode module</a> to read web.config and to manage the website (IIS Application Pool Management, start/stop website, etc...).</li>
</ol>

<h4>
<a id="create-application" class="anchor" href="#create-application" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Create application</h4>

<p>In IIS8, create a web site and create an Application.</p>

<p>The content of your application will be the site mixed with that of NodeAtlas. So that means this:</p>

<pre><code>node-atlas/
— node_modules/
— languages/
—— default.json
— node-atlas.js
site-hello-world/
— assets/
— templates/
—— index.htm
— webconfig.json
</code></pre>

<p>becomes this:</p>

<pre><code>site-hello-world/
— node_modules/
— languages/
—— default.json
— assets/
— templates/
—— index.htm
— node-atlas.js
— webconfig.json
</code></pre>

<p>You will add to this set of files, additional file named <code>web.config</code> whose content is:</p>

<div class="highlight highlight-text-xml"><pre>&lt;<span class="pl-ent">configuration</span>&gt;
    &lt;<span class="pl-ent">system</span>.webServer&gt;
        &lt;<span class="pl-ent">handlers</span>&gt;
            &lt;<span class="pl-ent">add</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>iisnode<span class="pl-pds">"</span></span> <span class="pl-e">path</span>=<span class="pl-s"><span class="pl-pds">"</span>node-atlas.js<span class="pl-pds">"</span></span> <span class="pl-e">verb</span>=<span class="pl-s"><span class="pl-pds">"</span>*<span class="pl-pds">"</span></span> <span class="pl-e">modules</span>=<span class="pl-s"><span class="pl-pds">"</span>iisnode<span class="pl-pds">"</span></span> /&gt;
        &lt;/<span class="pl-ent">handlers</span>&gt;
        &lt;<span class="pl-ent">rewrite</span>&gt;
            &lt;<span class="pl-ent">rules</span>&gt;
                &lt;<span class="pl-ent">rule</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>LogFile<span class="pl-pds">"</span></span> <span class="pl-e">patternSyntax</span>=<span class="pl-s"><span class="pl-pds">"</span>ECMAScript<span class="pl-pds">"</span></span> <span class="pl-e">stopProcessing</span>=<span class="pl-s"><span class="pl-pds">"</span>true<span class="pl-pds">"</span></span>&gt;
                     &lt;<span class="pl-ent">match</span> <span class="pl-e">url</span>=<span class="pl-s"><span class="pl-pds">"</span>^[a-zA-Z0-9_\-]+\.js\.logs\/\d+\.txt$<span class="pl-pds">"</span></span>/&gt;
                &lt;/<span class="pl-ent">rule</span>&gt;
                &lt;<span class="pl-ent">rule</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>NodeInspector<span class="pl-pds">"</span></span> <span class="pl-e">patternSyntax</span>=<span class="pl-s"><span class="pl-pds">"</span>ECMAScript<span class="pl-pds">"</span></span> <span class="pl-e">stopProcessing</span>=<span class="pl-s"><span class="pl-pds">"</span>true<span class="pl-pds">"</span></span>&gt;
                    &lt;<span class="pl-ent">match</span> <span class="pl-e">url</span>=<span class="pl-s"><span class="pl-pds">"</span>^node-atlas.js\/debug[\/]?<span class="pl-pds">"</span></span> /&gt;
                &lt;/<span class="pl-ent">rule</span>&gt;
                &lt;<span class="pl-ent">rule</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>StaticContent<span class="pl-pds">"</span></span>&gt;
                     &lt;<span class="pl-ent">action</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>Rewrite<span class="pl-pds">"</span></span> <span class="pl-e">url</span>=<span class="pl-s"><span class="pl-pds">"</span>assets{REQUEST_URI}<span class="pl-pds">"</span></span>/&gt;
                &lt;/<span class="pl-ent">rule</span>&gt;
                &lt;<span class="pl-ent">rule</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>DynamicContent<span class="pl-pds">"</span></span>&gt;
                     &lt;<span class="pl-ent">conditions</span>&gt;
                          &lt;<span class="pl-ent">add</span> <span class="pl-e">input</span>=<span class="pl-s"><span class="pl-pds">"</span>{REQUEST_FILENAME}<span class="pl-pds">"</span></span> <span class="pl-e">matchType</span>=<span class="pl-s"><span class="pl-pds">"</span>IsFile<span class="pl-pds">"</span></span> <span class="pl-e">negate</span>=<span class="pl-s"><span class="pl-pds">"</span>true<span class="pl-pds">"</span></span>/&gt;
                     &lt;/<span class="pl-ent">conditions</span>&gt;
                     &lt;<span class="pl-ent">action</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>Rewrite<span class="pl-pds">"</span></span> <span class="pl-e">url</span>=<span class="pl-s"><span class="pl-pds">"</span>node-atlas.js<span class="pl-pds">"</span></span>/&gt;
                &lt;/<span class="pl-ent">rule</span>&gt;
            &lt;/<span class="pl-ent">rules</span>&gt;
        &lt;/<span class="pl-ent">rewrite</span>&gt;
    &lt;/<span class="pl-ent">system</span>.webServer&gt;
&lt;/<span class="pl-ent">configuration</span>&gt;</pre></div>

<p>to obtain:</p>

<pre><code>site-hello-world/
— node_modules/
— languages/
—— default.json
— assets/
— templates/
—— index.htm
— node-atlas.js
— webconfig.json
— web.config
</code></pre>

<p>It will just have to click on "Browse " in your IIS8 action panel. You can now manage your website (start / stop / Pool Recycling) like any other IIS8 application.</p>

<h4>
<a id="webconfig-example" class="anchor" href="#webconfig-example" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>webconfig example</h4>

<p>An example for a production webconfig:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>urlPort<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">80</span>,
    <span class="pl-s"><span class="pl-pds">"</span>httpPort<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">7777</span>,
    <span class="pl-s"><span class="pl-pds">"</span>httpHostname<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>www.example.com<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-k">...</span>
    }
}</pre></div>

<h3>
<a id="in-a-unix-environment-with-forever" class="anchor" href="#in-a-unix-environment-with-forever" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>In a Unix environment with forever</h3>

<p>This requires:</p>

<ol>
<li>Install <a href="http://nodejs.org/download/">the node.exe executable</a> able to run JavaScript code.</li>
<li>Install <a href="https://github.com/nodejitsu/forever">the CLI tool forever</a> manager for your websites continuously (start, stop, restart, etc.).</li>
<li>Running in addition of your websites a reverse-proxy running on port 80 for all applications.</li>
</ol>

<h4>
<a id="some-forever-commands" class="anchor" href="#some-forever-commands" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Some forever commands</h4>

<p>To manage a new website in continues to be used the command:</p>

<pre><code>\&gt; forever start &lt;/path/to/&gt;node-atlas/node-atlas.js --directory &lt;/path/to/your/website/directory/&gt;
</code></pre>

<p>To stop it, localise the <strong>uid</strong> with the <code>list</code> forever command</p>

<pre><code>\&gt; forever list
</code></pre>

<p>and then use the command:</p>

<pre><code>\&gt; forever stop &lt;uid&gt;
</code></pre>

<p>or <code>&lt;uid&gt;</code> is the <strong>uid</strong> of running website.</p>

<h4>
<a id="webconfig-example-1" class="anchor" href="#webconfig-example-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>webconfig example</h4>

<p>An example for a production webconfig:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>urlPort<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">80</span>,
    <span class="pl-s"><span class="pl-pds">"</span>httpPort<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">7777</span>,
    <span class="pl-s"><span class="pl-pds">"</span>httpHostname<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>www.example.com<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>routes<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-k">...</span>
    }
}
</pre></div>

<p>You will then use a reverse proxy to make your site accessible on port 80.</p>

<h4>
<a id="in-a-unix-environment-with-nginx" class="anchor" href="#in-a-unix-environment-with-nginx" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>In a Unix environment with Nginx</h4>

<p>This is an example of Nginx's configuration:</p>

<div class="highlight highlight-source-js"><pre>## Server <span class="pl-smi">an</span>.<span class="pl-smi">example</span>.<span class="pl-smi">fr</span>

upstream websocket {
    server Ip_backend<span class="pl-k">:</span><span class="pl-c1">7777</span>;
}

server {

    listen   <span class="pl-c1">80</span>;
    server_name <span class="pl-smi">an</span>.<span class="pl-smi">example</span>.<span class="pl-smi">fr</span>;

        keepalive_timeout    <span class="pl-c1">60</span>;

    access_log on;

        access_log <span class="pl-k">/</span><span class="pl-k">var</span><span class="pl-k">/</span>log<span class="pl-k">/</span>nginx<span class="pl-k">/</span><span class="pl-smi">access</span>.<span class="pl-smi">log</span> logstash;
    error_log <span class="pl-k">/</span><span class="pl-k">var</span><span class="pl-k">/</span>log<span class="pl-k">/</span>nginx<span class="pl-k">/</span>error<span class="pl-k">-</span><span class="pl-smi">an</span>.<span class="pl-smi">example</span>.<span class="pl-smi">fr</span>.<span class="pl-smi">log</span>;

    location <span class="pl-k">/</span><span class="pl-smi">socket</span>.<span class="pl-smi">io</span><span class="pl-k">/</span> {
            proxy_pass http<span class="pl-k">:</span><span class="pl-c">//websocket;</span>
            proxy_http_version <span class="pl-c1">1.1</span>;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection <span class="pl-s"><span class="pl-pds">"</span>upgrade<span class="pl-pds">"</span></span>;
    }

    location <span class="pl-k">/</span> {
        proxy_set_header X<span class="pl-k">-</span>Real<span class="pl-k">-</span><span class="pl-c1">IP</span> $remote_addr;
            proxy_set_header X<span class="pl-k">-</span>Forwarded<span class="pl-k">-</span>For $proxy_add_x_forwarded_for;
            proxy_set_header Host $http_host;
            proxy_set_header X<span class="pl-k">-</span>NginX<span class="pl-k">-</span>Proxy <span class="pl-c1">true</span>;

            proxy_pass http<span class="pl-k">:</span><span class="pl-c">//websocket;</span>
        proxy_read_timeout <span class="pl-c1">300</span>;
        proxy_connect_timeout <span class="pl-c1">300</span>;
        proxy_redirect off;

    }

    error_page <span class="pl-c1">400</span> <span class="pl-c1">401</span> <span class="pl-c1">402</span> <span class="pl-c1">403</span> <span class="pl-c1">405</span> <span class="pl-c1">406</span> <span class="pl-c1">407</span> <span class="pl-c1">408</span> <span class="pl-c1">409</span> <span class="pl-c1">410</span> <span class="pl-c1">411</span> <span class="pl-c1">412</span> <span class="pl-c1">413</span> <span class="pl-c1">414</span> <span class="pl-c1">415</span> <span class="pl-c1">416</span> <span class="pl-c1">417</span> <span class="pl-c1">500</span> <span class="pl-c1">501</span> <span class="pl-c1">502</span> <span class="pl-c1">503</span> <span class="pl-c1">504</span> <span class="pl-c1">505</span> <span class="pl-c1">506</span> <span class="pl-c1">507</span> <span class="pl-k">/</span><span class="pl-smi">error</span>.<span class="pl-smi">html</span>;

    location <span class="pl-k">=</span> <span class="pl-k">/</span><span class="pl-smi">error</span>.<span class="pl-smi">html</span> {
            root <span class="pl-k">/</span><span class="pl-k">var</span><span class="pl-k">/</span>www<span class="pl-k">/</span>nginx<span class="pl-k">-</span><span class="pl-k">default</span>;
    }
}</pre></div>

<p><code>Ip_backend</code> must be replaced by your private subnetwork IP. That can be <code>127.0.0.1</code> if node run in same server as Nginx.</p>

<p><code>websocket</code> should be replaced by any word, it will be also moddify the <code>proxy_pass</code>. It must be unique to each node.</p>

<h3>
<a id="proxy" class="anchor" href="#proxy" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Proxy</h3>

<h4>
<a id="bouncy" class="anchor" href="#bouncy" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Bouncy</h4>

<p>Bouncy is an example of reverse-proxy that you can use to run various NodeAtlas websites (with other types of websites) together on the same port (80).</p>

<p>You can for example:</p>

<ul>
<li>run 3 Node.js apps on ports 7777, 7778 and 7779 with forever,</li>
<li>and besides launching a apache server on port 81</li>
</ul>

<p>and make all your websites accessible behind domain names on port 80 with Bouncy example.</p>

<p>Here is a sample configuration with Bouncy:</p>

<p><strong>global-server.js</strong></p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> bouncy <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>bouncy<span class="pl-pds">'</span></span>);

<span class="pl-k">var</span> server <span class="pl-k">=</span> <span class="pl-en">bouncy</span>(<span class="pl-k">function</span> (<span class="pl-smi">request</span>, <span class="pl-smi">response</span>, <span class="pl-smi">bounce</span>) {
    <span class="pl-k">if</span> (<span class="pl-smi">request</span>.<span class="pl-c1">headers</span>.<span class="pl-c1">host</span> <span class="pl-k">===</span> <span class="pl-s"><span class="pl-pds">'</span>beep.example.com<span class="pl-pds">'</span></span>) {
        <span class="pl-en">bounce</span>(<span class="pl-c1">7777</span>);
    }
    <span class="pl-k">else</span> <span class="pl-k">if</span> (<span class="pl-smi">request</span>.<span class="pl-c1">headers</span>.<span class="pl-c1">host</span> <span class="pl-k">===</span> <span class="pl-s"><span class="pl-pds">'</span>blup.example.com<span class="pl-pds">'</span></span>) {
        <span class="pl-en">bounce</span>(<span class="pl-c1">7776</span>);
    }
    <span class="pl-k">else</span> <span class="pl-k">if</span> (<span class="pl-smi">request</span>.<span class="pl-c1">headers</span>.<span class="pl-c1">host</span> <span class="pl-k">===</span> <span class="pl-s"><span class="pl-pds">'</span>boop.example.com<span class="pl-pds">'</span></span>) {
        <span class="pl-en">bounce</span>(<span class="pl-c1">81</span>);
    }
    <span class="pl-k">else</span> {
        <span class="pl-smi">response</span>.<span class="pl-smi">statusCode</span> <span class="pl-k">=</span> <span class="pl-c1">404</span>;
        <span class="pl-smi">response</span>.<span class="pl-en">end</span>(<span class="pl-s"><span class="pl-pds">'</span>no such host<span class="pl-pds">'</span></span>);
    }
});

<span class="pl-smi">server</span>.<span class="pl-en">listen</span>(<span class="pl-c1">80</span>);</pre></div>

<p>and you can start with:</p>

<pre><code>\&gt; forever start &lt;/path/to/&gt;global-server.js
</code></pre>

<p><a href="https://github.com/substack/bouncy">More information about Bouncy</a></p>

<h2>
<a id="about-nodeatlas-api" class="anchor" href="#about-nodeatlas-api" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>About NodeAtlas API</h2>

<p>NodeAtlas is made of such a way that the instanciate object contains all the functions allowing it to function. NodeAtlas delivers itself it's object into controllers via the methods used in the Back-end mode with Node.js for you to occasionally change his behavior.</p>

<p>All error messages are in <code>/languages/default.json</code>. If you want to change language, simply replace content of <code>default.json</code> file (currently the same of <code>en-gb</code>) with the content of <code>fr-fr.json</code> or others file translated by you.</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/Haeresis">Haeresis</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-50163044-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
